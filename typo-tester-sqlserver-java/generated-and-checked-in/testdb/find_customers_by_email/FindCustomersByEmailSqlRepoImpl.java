/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.find_customers_by_email;

import static typo.runtime.Fragment.interpolate;

import java.sql.Connection;
import java.util.List;
import typo.runtime.Fragment;
import typo.runtime.SqlServerTypes;

public class FindCustomersByEmailSqlRepoImpl implements FindCustomersByEmailSqlRepo {
  @Override
  public List<FindCustomersByEmailSqlRow> apply(String emailPattern, Connection c) {
    return interpolate(
            Fragment.lit(
                "-- Find customers by email pattern\n"
                    + "SELECT\n"
                    + "    customer_id,\n"
                    + "    name as customer_name,\n"
                    + "    email as customer_email,\n"
                    + "    created_at\n"
                    + "FROM customers\n"
                    + "WHERE email LIKE "),
            Fragment.encode(SqlServerTypes.nvarchar, emailPattern),
            Fragment.lit("\nORDER BY created_at DESC\n"))
        .query(FindCustomersByEmailSqlRow._rowParser.all())
        .runUnchecked(c);
  }
  ;
}

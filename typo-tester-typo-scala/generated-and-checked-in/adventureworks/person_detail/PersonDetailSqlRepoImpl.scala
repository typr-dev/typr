/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.person_detail

import adventureworks.customtypes.TypoLocalDateTime
import adventureworks.person.businessentity.BusinessentityId
import java.sql.Connection
import typo.runtime.FragmentInterpolator.interpolate

class PersonDetailSqlRepoImpl extends PersonDetailSqlRepo {
  override def apply(
    businessentityid: /* user-picked */ BusinessentityId,
    modifiedAfter: TypoLocalDateTime
  )(using c: Connection): java.util.List[PersonDetailSqlRow] = {
    interpolate"""SELECT s.businessentityid,
           p.title,
           p.firstname,
           p.middlename,
           p.lastname,
           e.jobtitle,
           a.addressline1,
           a.city,
           a.postalcode,
           a.rowguid
    FROM sales.salesperson s
             JOIN humanresources.employee e ON e.businessentityid = s.businessentityid
             JOIN person.person p ON p.businessentityid = s.businessentityid
             JOIN person.businessentityaddress bea ON bea.businessentityid = s.businessentityid
             LEFT JOIN person.address a ON a.addressid = bea.addressid
    where s.businessentityid = ${/* user-picked */ BusinessentityId.pgType.encode(businessentityid)}::int4
      and p.modifieddate > ${TypoLocalDateTime.pgType.encode(modifiedAfter)}::timestamp""".query(PersonDetailSqlRow.`_rowParser`.all()).runUnchecked(c)
  }
}
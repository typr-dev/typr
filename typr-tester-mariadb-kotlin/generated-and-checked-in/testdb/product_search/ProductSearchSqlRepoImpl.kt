/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.product_search

import java.math.BigDecimal
import java.sql.Connection
import kotlin.collections.List
import typr.kotlindsl.Fragment
import typr.kotlindsl.KotlinDbTypes
import typr.kotlindsl.nullable
import typr.runtime.MariaTypes

class ProductSearchSqlRepoImpl() : ProductSearchSqlRepo {
  override fun apply(
    brandId: Int?,
    minPrice: BigDecimal?,
    maxPrice: BigDecimal?,
    status: String?,
    limit: Long,
    c: Connection
  ): List<ProductSearchSqlRow> = Fragment.interpolate(Fragment.lit("-- Search products with optional filters\nSELECT p.product_id,\n       p.sku,\n       p.name,\n       p.short_description,\n       p.base_price,\n       p.status,\n       b.name AS brand_name\nFROM products p\nLEFT JOIN brands b ON p.brand_id = b.brand_id\nWHERE ("), Fragment.encode(KotlinDbTypes.MariaTypes.smallintUnsigned.nullable(), brandId), Fragment.lit(" IS NULL OR p.brand_id = "), Fragment.encode(KotlinDbTypes.MariaTypes.smallintUnsigned.nullable(), brandId), Fragment.lit(")\n  AND ("), Fragment.encode(KotlinDbTypes.MariaTypes.numeric.nullable(), minPrice), Fragment.lit(" IS NULL OR p.base_price >= "), Fragment.encode(KotlinDbTypes.MariaTypes.numeric.nullable(), minPrice), Fragment.lit(")\n  AND ("), Fragment.encode(KotlinDbTypes.MariaTypes.numeric.nullable(), maxPrice), Fragment.lit(" IS NULL OR p.base_price <= "), Fragment.encode(KotlinDbTypes.MariaTypes.numeric.nullable(), maxPrice), Fragment.lit(")\n  AND ("), Fragment.encode(MariaTypes.text.nullable(), status), Fragment.lit(" IS NULL OR p.status = "), Fragment.encode(MariaTypes.text.nullable(), status), Fragment.lit(")\nORDER BY p.name\nLIMIT "), Fragment.encode(KotlinDbTypes.MariaTypes.bigint, limit), Fragment.lit("\n")).query(ProductSearchSqlRow._rowParser.all()).runUnchecked(c)
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.customtypes;

import org.postgresql.geometric.PGlseg;
import org.postgresql.geometric.PGpoint;
import typo.runtime.PgRead;
import typo.runtime.PgText;
import typo.runtime.PgType;
import typo.runtime.PgWrite;
import typo.runtime.internal.arrayMap;
import static typo.runtime.internal.stringInterpolator.str;

/** Line segment datatype in PostgreSQL */
public record TypoLineSegment(
  TypoPoint p1,
  TypoPoint p2
) {
  public TypoLineSegment withP1(TypoPoint p1) {
    return new TypoLineSegment(p1, p2);
  };

  public TypoLineSegment withP2(TypoPoint p2) {
    return new TypoLineSegment(p1, p2);
  };

  static public PgText<TypoLineSegment> pgText =
    PgText.textString.contramap(v -> str("((", java.lang.String.valueOf(v.p1().x()), ",", java.lang.String.valueOf(v.p1().y()), "),(", java.lang.String.valueOf(v.p2().x()), ",", java.lang.String.valueOf(v.p2().y()), "))"));

  static public PgType<TypoLineSegment> pgType =
    PgType.of(
      "lseg",
      PgRead.castJdbcObjectTo(PGlseg.class).map((PGlseg v) -> new TypoLineSegment(new TypoPoint(v.point[0].x, v.point[0].y), new TypoPoint(v.point[1].x, v.point[1].y))),
      PgWrite.<PGlseg>passObjectToJdbc().contramap((TypoLineSegment v) -> new PGlseg(new PGpoint(v.p1().x(), v.p1().y()), new PGpoint(v.p2().x(), v.p2().y()))),
      TypoLineSegment.pgText
    );

  static public PgType<TypoLineSegment[]> pgTypeArray =
    TypoLineSegment.pgType.array(PgRead.castJdbcArrayTo(PGlseg.class).map((PGlseg[] xs) -> arrayMap.map(xs, (PGlseg v) -> new TypoLineSegment(new TypoPoint(v.point[0].x, v.point[0].y), new TypoPoint(v.point[1].x, v.point[1].y)), TypoLineSegment.class)), PgWrite.<PGlseg>passObjectToJdbc().array(TypoLineSegment.pgType.typename().<PGlseg>as()).contramap((TypoLineSegment[] xs) -> arrayMap.map(xs, (TypoLineSegment v) -> new PGlseg(new PGpoint(v.p1().x(), v.p1().y()), new PGpoint(v.p2().x(), v.p2().y())), PGlseg.class)));
}
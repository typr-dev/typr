/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.public_.pgtestnull;

import adventureworks.customtypes.TypoBox;
import adventureworks.customtypes.TypoBytea;
import adventureworks.customtypes.TypoCircle;
import adventureworks.customtypes.TypoHStore;
import adventureworks.customtypes.TypoInet;
import adventureworks.customtypes.TypoInstant;
import adventureworks.customtypes.TypoInt2Vector;
import adventureworks.customtypes.TypoInterval;
import adventureworks.customtypes.TypoJson;
import adventureworks.customtypes.TypoJsonb;
import adventureworks.customtypes.TypoLine;
import adventureworks.customtypes.TypoLineSegment;
import adventureworks.customtypes.TypoLocalDate;
import adventureworks.customtypes.TypoLocalDateTime;
import adventureworks.customtypes.TypoLocalTime;
import adventureworks.customtypes.TypoMoney;
import adventureworks.customtypes.TypoOffsetTime;
import adventureworks.customtypes.TypoPath;
import adventureworks.customtypes.TypoPoint;
import adventureworks.customtypes.TypoPolygon;
import adventureworks.customtypes.TypoShort;
import adventureworks.customtypes.TypoUUID;
import adventureworks.customtypes.TypoVector;
import adventureworks.customtypes.TypoXml;
import adventureworks.public_.Mydomain;
import adventureworks.public_.Myenum;
import java.sql.Connection;
import java.util.Iterator;
import java.util.List;
import typo.dsl.DeleteBuilder;
import typo.dsl.Dialect;
import typo.dsl.SelectBuilder;
import typo.dsl.UpdateBuilder;
import typo.runtime.PgTypes;
import typo.runtime.streamingInsert;
import static typo.runtime.Fragment.interpolate;
import static typo.runtime.internal.stringInterpolator.str;

public class PgtestnullRepoImpl implements PgtestnullRepo {
  @Override
  public DeleteBuilder<PgtestnullFields, PgtestnullRow> delete() {
    return DeleteBuilder.of("\"public\".\"pgtestnull\"", PgtestnullFields.structure(), Dialect.POSTGRESQL);
  };

  @Override
  public PgtestnullRow insert(
    PgtestnullRow unsaved,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         insert into "public"."pgtestnull"("bool", "box", "bpchar", "bytea", "char", "circle", "date", "float4", "float8", "hstore", "inet", "int2", "int2vector", "int4", "int8", "interval", "json", "jsonb", "line", "lseg", "money", "mydomain", "myenum", "name", "numeric", "path", "point", "polygon", "text", "time", "timestamp", "timestampz", "timez", "uuid", "varchar", "vector", "xml", "boxes", "bpchares", "chares", "circlees", "datees", "float4es", "float8es", "inetes", "int2es", "int2vectores", "int4es", "int8es", "intervales", "jsones", "jsonbes", "linees", "lseges", "moneyes", "mydomaines", "myenumes", "namees", "numerices", "pathes", "pointes", "polygones", "textes", "timees", "timestampes", "timestampzes", "timezes", "uuides", "varchares", "xmles")
         values ("""),
      PgTypes.bool.opt().encode(unsaved.bool()),
      typo.runtime.Fragment.lit(", "),
      TypoBox.pgType.opt().encode(unsaved.box()),
      typo.runtime.Fragment.lit("::box, "),
      PgTypes.text.opt().encode(unsaved.bpchar()),
      typo.runtime.Fragment.lit("::bpchar, "),
      TypoBytea.pgType.opt().encode(unsaved.bytea()),
      typo.runtime.Fragment.lit("::bytea, "),
      PgTypes.text.opt().encode(unsaved.char_()),
      typo.runtime.Fragment.lit("::bpchar, "),
      TypoCircle.pgType.opt().encode(unsaved.circle()),
      typo.runtime.Fragment.lit("::circle, "),
      TypoLocalDate.pgType.opt().encode(unsaved.date()),
      typo.runtime.Fragment.lit("::date, "),
      PgTypes.float4.opt().encode(unsaved.float4()),
      typo.runtime.Fragment.lit("::float4, "),
      PgTypes.float8.opt().encode(unsaved.float8()),
      typo.runtime.Fragment.lit("::float8, "),
      TypoHStore.pgType.opt().encode(unsaved.hstore()),
      typo.runtime.Fragment.lit("::hstore, "),
      TypoInet.pgType.opt().encode(unsaved.inet()),
      typo.runtime.Fragment.lit("::inet, "),
      TypoShort.pgType.opt().encode(unsaved.int2()),
      typo.runtime.Fragment.lit("::int2, "),
      TypoInt2Vector.pgType.opt().encode(unsaved.int2vector()),
      typo.runtime.Fragment.lit("::int2vector, "),
      PgTypes.int4.opt().encode(unsaved.int4()),
      typo.runtime.Fragment.lit("::int4, "),
      PgTypes.int8.opt().encode(unsaved.int8()),
      typo.runtime.Fragment.lit("::int8, "),
      TypoInterval.pgType.opt().encode(unsaved.interval()),
      typo.runtime.Fragment.lit("::interval, "),
      TypoJson.pgType.opt().encode(unsaved.json()),
      typo.runtime.Fragment.lit("::json, "),
      TypoJsonb.pgType.opt().encode(unsaved.jsonb()),
      typo.runtime.Fragment.lit("::jsonb, "),
      TypoLine.pgType.opt().encode(unsaved.line()),
      typo.runtime.Fragment.lit("::line, "),
      TypoLineSegment.pgType.opt().encode(unsaved.lseg()),
      typo.runtime.Fragment.lit("::lseg, "),
      TypoMoney.pgType.opt().encode(unsaved.money()),
      typo.runtime.Fragment.lit("::money, "),
      Mydomain.pgType.opt().encode(unsaved.mydomain()),
      typo.runtime.Fragment.lit("::text, "),
      Myenum.pgType.opt().encode(unsaved.myenum()),
      typo.runtime.Fragment.lit("::public.myenum, "),
      PgTypes.text.opt().encode(unsaved.name()),
      typo.runtime.Fragment.lit("::name, "),
      PgTypes.numeric.opt().encode(unsaved.numeric()),
      typo.runtime.Fragment.lit("::numeric, "),
      TypoPath.pgType.opt().encode(unsaved.path()),
      typo.runtime.Fragment.lit("::path, "),
      TypoPoint.pgType.opt().encode(unsaved.point()),
      typo.runtime.Fragment.lit("::point, "),
      TypoPolygon.pgType.opt().encode(unsaved.polygon()),
      typo.runtime.Fragment.lit("::polygon, "),
      PgTypes.text.opt().encode(unsaved.text()),
      typo.runtime.Fragment.lit(", "),
      TypoLocalTime.pgType.opt().encode(unsaved.time()),
      typo.runtime.Fragment.lit("::time, "),
      TypoLocalDateTime.pgType.opt().encode(unsaved.timestamp()),
      typo.runtime.Fragment.lit("::timestamp, "),
      TypoInstant.pgType.opt().encode(unsaved.timestampz()),
      typo.runtime.Fragment.lit("::timestamptz, "),
      TypoOffsetTime.pgType.opt().encode(unsaved.timez()),
      typo.runtime.Fragment.lit("::timetz, "),
      TypoUUID.pgType.opt().encode(unsaved.uuid()),
      typo.runtime.Fragment.lit("::uuid, "),
      PgTypes.text.opt().encode(unsaved.varchar()),
      typo.runtime.Fragment.lit(", "),
      TypoVector.pgType.opt().encode(unsaved.vector()),
      typo.runtime.Fragment.lit("::vector, "),
      TypoXml.pgType.opt().encode(unsaved.xml()),
      typo.runtime.Fragment.lit("::xml, "),
      TypoBox.pgTypeArray.opt().encode(unsaved.boxes()),
      typo.runtime.Fragment.lit("::box[], "),
      PgTypes.textArray.opt().encode(unsaved.bpchares()),
      typo.runtime.Fragment.lit("::bpchar[], "),
      PgTypes.textArray.opt().encode(unsaved.chares()),
      typo.runtime.Fragment.lit("::bpchar[], "),
      TypoCircle.pgTypeArray.opt().encode(unsaved.circlees()),
      typo.runtime.Fragment.lit("::circle[], "),
      TypoLocalDate.pgTypeArray.opt().encode(unsaved.datees()),
      typo.runtime.Fragment.lit("::date[], "),
      PgTypes.float4Array.opt().encode(unsaved.float4es()),
      typo.runtime.Fragment.lit("::float4[], "),
      PgTypes.float8Array.opt().encode(unsaved.float8es()),
      typo.runtime.Fragment.lit("::float8[], "),
      TypoInet.pgTypeArray.opt().encode(unsaved.inetes()),
      typo.runtime.Fragment.lit("::inet[], "),
      TypoShort.pgTypeArray.opt().encode(unsaved.int2es()),
      typo.runtime.Fragment.lit("::int2[], "),
      TypoInt2Vector.pgTypeArray.opt().encode(unsaved.int2vectores()),
      typo.runtime.Fragment.lit("::int2vector[], "),
      PgTypes.int4Array.opt().encode(unsaved.int4es()),
      typo.runtime.Fragment.lit("::int4[], "),
      PgTypes.int8Array.opt().encode(unsaved.int8es()),
      typo.runtime.Fragment.lit("::int8[], "),
      TypoInterval.pgTypeArray.opt().encode(unsaved.intervales()),
      typo.runtime.Fragment.lit("::interval[], "),
      TypoJson.pgTypeArray.opt().encode(unsaved.jsones()),
      typo.runtime.Fragment.lit("::json[], "),
      TypoJsonb.pgTypeArray.opt().encode(unsaved.jsonbes()),
      typo.runtime.Fragment.lit("::jsonb[], "),
      TypoLine.pgTypeArray.opt().encode(unsaved.linees()),
      typo.runtime.Fragment.lit("::line[], "),
      TypoLineSegment.pgTypeArray.opt().encode(unsaved.lseges()),
      typo.runtime.Fragment.lit("::lseg[], "),
      TypoMoney.pgTypeArray.opt().encode(unsaved.moneyes()),
      typo.runtime.Fragment.lit("::money[], "),
      Mydomain.pgTypeArray.opt().encode(unsaved.mydomaines()),
      typo.runtime.Fragment.lit("::mydomain[], "),
      Myenum.pgTypeArray.opt().encode(unsaved.myenumes()),
      typo.runtime.Fragment.lit("::myenum[], "),
      PgTypes.textArray.opt().encode(unsaved.namees()),
      typo.runtime.Fragment.lit("::name[], "),
      PgTypes.numericArray.opt().encode(unsaved.numerices()),
      typo.runtime.Fragment.lit("::numeric[], "),
      TypoPath.pgTypeArray.opt().encode(unsaved.pathes()),
      typo.runtime.Fragment.lit("::path[], "),
      TypoPoint.pgTypeArray.opt().encode(unsaved.pointes()),
      typo.runtime.Fragment.lit("::point[], "),
      TypoPolygon.pgTypeArray.opt().encode(unsaved.polygones()),
      typo.runtime.Fragment.lit("::polygon[], "),
      PgTypes.textArray.opt().encode(unsaved.textes()),
      typo.runtime.Fragment.lit("::text[], "),
      TypoLocalTime.pgTypeArray.opt().encode(unsaved.timees()),
      typo.runtime.Fragment.lit("::time[], "),
      TypoLocalDateTime.pgTypeArray.opt().encode(unsaved.timestampes()),
      typo.runtime.Fragment.lit("::timestamp[], "),
      TypoInstant.pgTypeArray.opt().encode(unsaved.timestampzes()),
      typo.runtime.Fragment.lit("::timestamptz[], "),
      TypoOffsetTime.pgTypeArray.opt().encode(unsaved.timezes()),
      typo.runtime.Fragment.lit("::timetz[], "),
      TypoUUID.pgTypeArray.opt().encode(unsaved.uuides()),
      typo.runtime.Fragment.lit("::uuid[], "),
      PgTypes.textArray.opt().encode(unsaved.varchares()),
      typo.runtime.Fragment.lit("::varchar[], "),
      TypoXml.pgTypeArray.opt().encode(unsaved.xmles()),
      typo.runtime.Fragment.lit("""
         ::xml[])
         returning "bool", "box", "bpchar", "bytea", "char", "circle", "date"::text, "float4", "float8", "hstore", "inet", "int2", "int2vector", "int4", "int8", "interval", "json", "jsonb", "line", "lseg", "money"::numeric, "mydomain", "myenum", "name", "numeric", "path", "point", "polygon", "text", "time"::text, "timestamp"::text, "timestampz"::text, "timez"::text, "uuid", "varchar", "vector"::float4[], "xml", "boxes", "bpchares", "chares", "circlees", "datees"::text[], "float4es", "float8es", "inetes", "int2es", "int2vectores", "int4es", "int8es", "intervales", "jsones", "jsonbes", "linees", "lseges", "moneyes"::numeric[], "mydomaines"::text[], "myenumes", "namees", "numerices", "pathes", "pointes", "polygones", "textes", "timees"::text[], "timestampes"::text[], "timestampzes"::text[], "timezes"::text[], "uuides", "varchares", "xmles"
      """)
    )
      .updateReturning(PgtestnullRow._rowParser.exactlyOne()).runUnchecked(c);
  };

  @Override
  public Long insertStreaming(
    Iterator<PgtestnullRow> unsaved,
    Integer batchSize,
    Connection c
  ) {
    return streamingInsert.insertUnchecked(str("""
    COPY "public"."pgtestnull"("bool", "box", "bpchar", "bytea", "char", "circle", "date", "float4", "float8", "hstore", "inet", "int2", "int2vector", "int4", "int8", "interval", "json", "jsonb", "line", "lseg", "money", "mydomain", "myenum", "name", "numeric", "path", "point", "polygon", "text", "time", "timestamp", "timestampz", "timez", "uuid", "varchar", "vector", "xml", "boxes", "bpchares", "chares", "circlees", "datees", "float4es", "float8es", "inetes", "int2es", "int2vectores", "int4es", "int8es", "intervales", "jsones", "jsonbes", "linees", "lseges", "moneyes", "mydomaines", "myenumes", "namees", "numerices", "pathes", "pointes", "polygones", "textes", "timees", "timestampes", "timestampzes", "timezes", "uuides", "varchares", "xmles") FROM STDIN
    """), batchSize, unsaved, c, PgtestnullRow.pgText);
  };

  @Override
  public SelectBuilder<PgtestnullFields, PgtestnullRow> select() {
    return SelectBuilder.of("\"public\".\"pgtestnull\"", PgtestnullFields.structure(), PgtestnullRow._rowParser, Dialect.POSTGRESQL);
  };

  @Override
  public List<PgtestnullRow> selectAll(Connection c) {
    return interpolate(typo.runtime.Fragment.lit("""
       select "bool", "box", "bpchar", "bytea", "char", "circle", "date"::text, "float4", "float8", "hstore", "inet", "int2", "int2vector", "int4", "int8", "interval", "json", "jsonb", "line", "lseg", "money"::numeric, "mydomain", "myenum", "name", "numeric", "path", "point", "polygon", "text", "time"::text, "timestamp"::text, "timestampz"::text, "timez"::text, "uuid", "varchar", "vector"::float4[], "xml", "boxes", "bpchares", "chares", "circlees", "datees"::text[], "float4es", "float8es", "inetes", "int2es", "int2vectores", "int4es", "int8es", "intervales", "jsones", "jsonbes", "linees", "lseges", "moneyes"::numeric[], "mydomaines"::text[], "myenumes", "namees", "numerices", "pathes", "pointes", "polygones", "textes", "timees"::text[], "timestampes"::text[], "timestampzes"::text[], "timezes"::text[], "uuides", "varchares", "xmles"
       from "public"."pgtestnull"
    """)).query(PgtestnullRow._rowParser.all()).runUnchecked(c);
  };

  @Override
  public UpdateBuilder<PgtestnullFields, PgtestnullRow> update() {
    return UpdateBuilder.of("\"public\".\"pgtestnull\"", PgtestnullFields.structure(), PgtestnullRow._rowParser.all(), Dialect.POSTGRESQL);
  };
}
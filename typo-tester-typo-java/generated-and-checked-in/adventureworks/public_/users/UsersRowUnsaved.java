/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.public_.users;

import adventureworks.customtypes.Defaulted;
import adventureworks.customtypes.Defaulted.UseDefault;
import com.fasterxml.jackson.annotation.JsonProperty;
import java.time.Instant;
import java.util.Optional;
import typo.data.Unknown;
import typo.runtime.PgText;
import typo.runtime.PgTypes;

/** This class corresponds to a row in table `public.users` which has not been persisted yet */
public record UsersRowUnsaved(
  @JsonProperty("user_id") UsersId userId,
  String name,
  @JsonProperty("last_name") Optional<String> lastName,
  Unknown email,
  String password,
  @JsonProperty("verified_on") Optional<Instant> verifiedOn,
  /** Default: now() */
  @JsonProperty("created_at") Defaulted<Instant> createdAt
) {
  public UsersRowUnsaved(
    @JsonProperty("user_id") UsersId userId,
    String name,
    Unknown email,
    String password
  ) {
    this(userId, name, Optional.empty(), email, password, Optional.empty(), new UseDefault<>());
  };

  public UsersRowUnsaved withUserId(UsersId userId) {
    return new UsersRowUnsaved(userId, name, lastName, email, password, verifiedOn, createdAt);
  };

  public UsersRowUnsaved withName(String name) {
    return new UsersRowUnsaved(userId, name, lastName, email, password, verifiedOn, createdAt);
  };

  public UsersRowUnsaved withLastName(Optional<String> lastName) {
    return new UsersRowUnsaved(userId, name, lastName, email, password, verifiedOn, createdAt);
  };

  public UsersRowUnsaved withEmail(Unknown email) {
    return new UsersRowUnsaved(userId, name, lastName, email, password, verifiedOn, createdAt);
  };

  public UsersRowUnsaved withPassword(String password) {
    return new UsersRowUnsaved(userId, name, lastName, email, password, verifiedOn, createdAt);
  };

  public UsersRowUnsaved withVerifiedOn(Optional<Instant> verifiedOn) {
    return new UsersRowUnsaved(userId, name, lastName, email, password, verifiedOn, createdAt);
  };

  /** Default: now() */
  public UsersRowUnsaved withCreatedAt(Defaulted<Instant> createdAt) {
    return new UsersRowUnsaved(userId, name, lastName, email, password, verifiedOn, createdAt);
  };

  static public PgText<UsersRowUnsaved> pgText =
    PgText.instance((row, sb) -> {
      UsersId.pgType.pgText().unsafeEncode(row.userId, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.text.pgText().unsafeEncode(row.name, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.text.opt().pgText().unsafeEncode(row.lastName, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.unknown.pgText().unsafeEncode(row.email, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.text.pgText().unsafeEncode(row.password, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.timestamptz.opt().pgText().unsafeEncode(row.verifiedOn, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(PgTypes.timestamptz.pgText()).unsafeEncode(row.createdAt, sb);
    });

  public UsersRow toRow(java.util.function.Supplier<Instant> createdAtDefault) {
    return new UsersRow(userId, name, lastName, email, password, createdAt.getOrElse(createdAtDefault), verifiedOn);
  };
}
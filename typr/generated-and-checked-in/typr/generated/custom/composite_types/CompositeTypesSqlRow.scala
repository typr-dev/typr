/**
 * File has been automatically generated by `typo` for internal use.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 *
 * (If you're developing `typo` and want to change it: run `bleep generate-sources`)
 */
package typr.generated.custom.composite_types

import anorm.Column
import anorm.RowParser
import anorm.Success
import play.api.libs.json.JsObject
import play.api.libs.json.JsResult
import play.api.libs.json.JsValue
import play.api.libs.json.OWrites
import play.api.libs.json.Reads
import play.api.libs.json.Writes
import scala.collection.immutable.ListMap
import scala.util.Try
import typr.generated.customtypes.TypoShort

/** SQL file: custom/composite_types.sql */
case class CompositeTypesSqlRow(
  /** Points to [[typr.generated.pg_catalog.pg_namespace.PgNamespaceRow.nspname]]
   * debug: {"baseColumnName":"nspname","baseRelationName":"pg_catalog.pg_namespace","columnClassName":"java.lang.String","columnDisplaySize":2147483647,"parsedColumnName":{"name":"typeSchema","originalName":"typeSchema?","nullability":"Nullable"},"columnName":"typeSchema?","columnType":"VarChar","columnTypeName":"name","format":0,"isAutoIncrement":false,"isCaseSensitive":true,"isCurrency":false,"isDefinitelyWritable":false,"isNullable":"NoNulls","isReadOnly":false,"isSearchable":true,"isSigned":false,"isWritable":true,"precision":2147483647,"scale":0,"tableName":"pg_namespace"}
   */
  typeSchema: Option[String],
  /** Points to [[typr.generated.pg_catalog.pg_type.PgTypeRow.typname]]
   * debug: {"baseColumnName":"typname","baseRelationName":"pg_catalog.pg_type","columnClassName":"java.lang.String","columnDisplaySize":2147483647,"parsedColumnName":{"name":"typeName","originalName":"typeName"},"columnName":"typeName","columnType":"VarChar","columnTypeName":"name","format":0,"isAutoIncrement":false,"isCaseSensitive":true,"isCurrency":false,"isDefinitelyWritable":false,"isNullable":"NoNulls","isReadOnly":false,"isSearchable":true,"isSigned":false,"isWritable":true,"precision":2147483647,"scale":0,"tableName":"pg_type"}
   */
  typeName: String,
  /** Points to [[typr.generated.pg_catalog.pg_attribute.PgAttributeRow.attname]]
   * debug: {"baseColumnName":"attname","baseRelationName":"pg_catalog.pg_attribute","columnClassName":"java.lang.String","columnDisplaySize":2147483647,"parsedColumnName":{"name":"attrName","originalName":"attrName"},"columnName":"attrName","columnType":"VarChar","columnTypeName":"name","format":0,"isAutoIncrement":false,"isCaseSensitive":true,"isCurrency":false,"isDefinitelyWritable":false,"isNullable":"NoNulls","isReadOnly":false,"isSearchable":true,"isSigned":false,"isWritable":true,"precision":2147483647,"scale":0,"tableName":"pg_attribute"}
   */
  attrName: String,
  /** Points to [[typr.generated.pg_catalog.pg_attribute.PgAttributeRow.attnum]]
   * debug: {"baseColumnName":"attnum","baseRelationName":"pg_catalog.pg_attribute","columnClassName":"java.lang.Integer","columnDisplaySize":6,"parsedColumnName":{"name":"attrNum","originalName":"attrNum"},"columnName":"attrNum","columnType":"SmallInt","columnTypeName":"int2","format":0,"isAutoIncrement":false,"isCaseSensitive":false,"isCurrency":false,"isDefinitelyWritable":false,"isNullable":"NoNulls","isReadOnly":false,"isSearchable":true,"isSigned":true,"isWritable":true,"precision":5,"scale":0,"tableName":"pg_attribute"}
   */
  attrNum: TypoShort,
  /** Points to [[typr.generated.pg_catalog.pg_type.PgTypeRow.typname]]
   * debug: {"baseColumnName":"typname","baseRelationName":"pg_catalog.pg_type","columnClassName":"java.lang.String","columnDisplaySize":2147483647,"parsedColumnName":{"name":"attrType","originalName":"attrType"},"columnName":"attrType","columnType":"VarChar","columnTypeName":"name","format":0,"isAutoIncrement":false,"isCaseSensitive":true,"isCurrency":false,"isDefinitelyWritable":false,"isNullable":"NoNulls","isReadOnly":false,"isSearchable":true,"isSigned":false,"isWritable":true,"precision":2147483647,"scale":0,"tableName":"pg_type"}
   */
  attrType: String,
  /** Points to [[typr.generated.pg_catalog.pg_attribute.PgAttributeRow.attnotnull]]
   * debug: {"baseColumnName":"attnotnull","baseRelationName":"pg_catalog.pg_attribute","columnClassName":"java.lang.Boolean","columnDisplaySize":1,"parsedColumnName":{"name":"attrNotNull","originalName":"attrNotNull"},"columnName":"attrNotNull","columnType":"Bit","columnTypeName":"bool","format":0,"isAutoIncrement":false,"isCaseSensitive":false,"isCurrency":false,"isDefinitelyWritable":false,"isNullable":"NoNulls","isReadOnly":false,"isSearchable":true,"isSigned":false,"isWritable":true,"precision":1,"scale":0,"tableName":"pg_attribute"}
   */
  attrNotNull: Boolean
)

object CompositeTypesSqlRow {
  implicit lazy val reads: Reads[CompositeTypesSqlRow] = {
    Reads[CompositeTypesSqlRow](json => JsResult.fromTry(
        Try(
          CompositeTypesSqlRow(
            typeSchema = json.\("typeSchema").toOption.map(_.as(Reads.StringReads)),
            typeName = json.\("typeName").as(Reads.StringReads),
            attrName = json.\("attrName").as(Reads.StringReads),
            attrNum = json.\("attrNum").as(TypoShort.reads),
            attrType = json.\("attrType").as(Reads.StringReads),
            attrNotNull = json.\("attrNotNull").as(Reads.BooleanReads)
          )
        )
      ),
    )
  }

  def rowParser(idx: Int): RowParser[CompositeTypesSqlRow] = {
    RowParser[CompositeTypesSqlRow] { row =>
      Success(
        CompositeTypesSqlRow(
          typeSchema = row(idx + 0)(Column.columnToOption(Column.columnToString)),
          typeName = row(idx + 1)(Column.columnToString),
          attrName = row(idx + 2)(Column.columnToString),
          attrNum = row(idx + 3)(TypoShort.column),
          attrType = row(idx + 4)(Column.columnToString),
          attrNotNull = row(idx + 5)(Column.columnToBoolean)
        )
      )
    }
  }

  implicit lazy val writes: OWrites[CompositeTypesSqlRow] = {
    OWrites[CompositeTypesSqlRow](o =>
      new JsObject(ListMap[String, JsValue](
        "typeSchema" -> Writes.OptionWrites(Writes.StringWrites).writes(o.typeSchema),
        "typeName" -> Writes.StringWrites.writes(o.typeName),
        "attrName" -> Writes.StringWrites.writes(o.attrName),
        "attrNum" -> TypoShort.writes.writes(o.attrNum),
        "attrType" -> Writes.StringWrites.writes(o.attrType),
        "attrNotNull" -> Writes.BooleanWrites.writes(o.attrNotNull)
      ))
    )
  }
}
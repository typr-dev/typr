/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.order_history

import com.fasterxml.jackson.annotation.JsonProperty
import java.time.LocalDateTime
import java.util.Optional
import testdb.customtypes.Defaulted
import testdb.orders.OrdersId
import typo.runtime.MariaText
import typo.runtime.MariaTypes
import typo.runtime.RowParser
import typo.runtime.RowParsers

/** Table: order_history
 * Primary key: history_id
 */
case class OrderHistoryRow(
  /** 
   * AUTO_INCREMENT
   */
  @JsonProperty("history_id") historyId: OrderHistoryId,
  /** 
   * Points to [[testdb.orders.OrdersRow.orderId]]
   */
  @JsonProperty("order_id") orderId: OrdersId,
  /** 
   * Default: NULL
   */
  @JsonProperty("previous_status") previousStatus: Optional[String],
  /**  */
  @JsonProperty("new_status") newStatus: String,
  /** 
   * Default: NULL
   */
  @JsonProperty("changed_by") changedBy: Optional[String],
  /** 
   * Default: NULL
   */
  @JsonProperty("change_reason") changeReason: Optional[String],
  /** 
   * Default: NULL
   */
  metadata: Optional[String],
  /** 
   * Default: current_timestamp(6)
   */
  @JsonProperty("created_at") createdAt: LocalDateTime
) {
  def id: OrderHistoryId = historyId

  def toUnsavedRow(
    previousStatus: Defaulted[Optional[String]] = Defaulted.Provided(this.previousStatus),
    changedBy: Defaulted[Optional[String]] = Defaulted.Provided(this.changedBy),
    changeReason: Defaulted[Optional[String]] = Defaulted.Provided(this.changeReason),
    metadata: Defaulted[Optional[String]] = Defaulted.Provided(this.metadata),
    createdAt: Defaulted[LocalDateTime] = Defaulted.Provided(this.createdAt)
  ): OrderHistoryRowUnsaved = {
    new OrderHistoryRowUnsaved(
      orderId,
      newStatus,
      previousStatus,
      changedBy,
      changeReason,
      metadata,
      createdAt
    )
  }
}

object OrderHistoryRow {
  val `_rowParser`: RowParser[OrderHistoryRow] = RowParsers.of(OrderHistoryId.pgType, OrdersId.pgType, MariaTypes.text.opt(), MariaTypes.text, MariaTypes.varchar.opt(), MariaTypes.varchar.opt(), MariaTypes.longtext.opt(), MariaTypes.datetime, OrderHistoryRow.apply, row => Array[Object](row.historyId.asInstanceOf[Object], row.orderId.asInstanceOf[Object], row.previousStatus.asInstanceOf[Object], row.newStatus.asInstanceOf[Object], row.changedBy.asInstanceOf[Object], row.changeReason.asInstanceOf[Object], row.metadata.asInstanceOf[Object], row.createdAt.asInstanceOf[Object]))

  given mariaText: MariaText[OrderHistoryRow] = MariaText.from(`_rowParser`)
}
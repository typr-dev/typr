/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.audit_log

import com.fasterxml.jackson.annotation.JsonProperty
import java.time.LocalDateTime
import java.util.Optional
import testdb.customtypes.Defaulted
import typo.data.maria.Inet6
import typo.runtime.MariaText
import typo.runtime.MariaTypes
import typo.runtime.RowParser
import typo.runtime.RowParsers

/** Table: audit_log
 * Primary key: log_id
 */
case class AuditLogRow(
  /** 
   * AUTO_INCREMENT
   */
  @JsonProperty("log_id") logId: AuditLogId,
  /**  */
  @JsonProperty("table_name") tableName: String,
  /**  */
  @JsonProperty("record_id") recordId: String,
  /**  */
  action: String,
  /** 
   * Default: NULL
   */
  @JsonProperty("old_values") oldValues: Optional[String],
  /** 
   * Default: NULL
   */
  @JsonProperty("new_values") newValues: Optional[String],
  /** 
   * Default: NULL
   */
  @JsonProperty("changed_by") changedBy: Optional[String],
  /** 
   * Default: current_timestamp(6)
   */
  @JsonProperty("changed_at") changedAt: LocalDateTime,
  /** 
   * Default: NULL
   */
  @JsonProperty("client_ip") clientIp: Optional[Inet6],
  /** 
   * Default: NULL
   */
  @JsonProperty("session_id") sessionId: Optional[Array[Byte]]
) {
  def id: AuditLogId = logId

  def toUnsavedRow(
    oldValues: Defaulted[Optional[String]] = Defaulted.Provided(this.oldValues),
    newValues: Defaulted[Optional[String]] = Defaulted.Provided(this.newValues),
    changedBy: Defaulted[Optional[String]] = Defaulted.Provided(this.changedBy),
    changedAt: Defaulted[LocalDateTime] = Defaulted.Provided(this.changedAt),
    clientIp: Defaulted[Optional[Inet6]] = Defaulted.Provided(this.clientIp),
    sessionId: Defaulted[Optional[Array[Byte]]] = Defaulted.Provided(this.sessionId)
  ): AuditLogRowUnsaved = {
    new AuditLogRowUnsaved(
      tableName,
      recordId,
      action,
      oldValues,
      newValues,
      changedBy,
      changedAt,
      clientIp,
      sessionId
    )
  }
}

object AuditLogRow {
  val `_rowParser`: RowParser[AuditLogRow] = RowParsers.of(AuditLogId.pgType, MariaTypes.varchar, MariaTypes.varchar, MariaTypes.text, MariaTypes.longtext.opt(), MariaTypes.longtext.opt(), MariaTypes.varchar.opt(), MariaTypes.datetime, MariaTypes.inet6.opt(), MariaTypes.varbinary.opt(), AuditLogRow.apply, row => Array(row.logId, row.tableName, row.recordId, row.action, row.oldValues, row.newValues, row.changedBy, row.changedAt, row.clientIp, row.sessionId))

  given mariaText: MariaText[AuditLogRow] = MariaText.from(`_rowParser`)
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.simple_customer_lookup

import java.sql.Connection
import typr.runtime.MariaTypes
import typr.scaladsl.Fragment
import typr.scaladsl.Fragment.sql

class SimpleCustomerLookupSqlRepoImpl extends SimpleCustomerLookupSqlRepo {
  override def apply(email: String)(using c: Connection): List[SimpleCustomerLookupSqlRow] = {
    sql"""-- Simple customer lookup by email
    SELECT customer_id,
           email,
           first_name,
           last_name,
           tier,
           status,
           created_at
    FROM customers
    WHERE email = ${Fragment.encode(MariaTypes.varchar, email)}
    """.query(SimpleCustomerLookupSqlRow.`_rowParser`.all()).runUnchecked(c)
  }
}
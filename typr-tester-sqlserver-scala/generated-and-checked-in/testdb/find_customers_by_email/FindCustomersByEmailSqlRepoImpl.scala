/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.find_customers_by_email

import java.sql.Connection
import typr.runtime.SqlServerTypes
import typr.scaladsl.Fragment
import typr.scaladsl.Fragment.sql

class FindCustomersByEmailSqlRepoImpl extends FindCustomersByEmailSqlRepo {
  override def apply(emailPattern: String)(using c: Connection): List[FindCustomersByEmailSqlRow] = {
    sql"""-- Find customers by email pattern
    SELECT
        customer_id,
        name as customer_name,
        email as customer_email,
        created_at
    FROM customers
    WHERE email LIKE ${Fragment.encode(SqlServerTypes.nvarchar, emailPattern)}
    ORDER BY created_at DESC
    """.query(FindCustomersByEmailSqlRow.`_rowParser`.all()).runUnchecked(c)
  }
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.sales.salesorderheadersalesreason

import adventureworks.customtypes.Defaulted
import adventureworks.customtypes.TypoLocalDateTime
import adventureworks.sales.salesorderheader.SalesorderheaderId
import adventureworks.sales.salesreason.SalesreasonId
import doobie.postgres.Text
import doobie.util.Read
import doobie.util.Write
import io.circe.Decoder
import io.circe.Encoder

/** Table: sales.salesorderheadersalesreason
 * Cross-reference table mapping sales orders to sales reason codes.
 * Composite primary key: salesorderid, salesreasonid
 */
case class SalesorderheadersalesreasonRow(
  /** Primary key. Foreign key to SalesOrderHeader.SalesOrderID.
   * Points to [[adventureworks.sales.salesorderheader.SalesorderheaderRow.salesorderid]]
   */
  salesorderid: SalesorderheaderId,
  /** Primary key. Foreign key to SalesReason.SalesReasonID.
   * Points to [[adventureworks.sales.salesreason.SalesreasonRow.salesreasonid]]
   */
  salesreasonid: SalesreasonId,
  /** Default: now() */
  modifieddate: TypoLocalDateTime
) {
  def compositeId: SalesorderheadersalesreasonId = new SalesorderheadersalesreasonId(salesorderid, salesreasonid)

  def id: SalesorderheadersalesreasonId = this.compositeId

  def toUnsavedRow(modifieddate: Defaulted[TypoLocalDateTime] = Defaulted.Provided(this.modifieddate)): SalesorderheadersalesreasonRowUnsaved = new SalesorderheadersalesreasonRowUnsaved(salesorderid, salesreasonid, modifieddate)
}

object SalesorderheadersalesreasonRow {
  def apply(
    compositeId: SalesorderheadersalesreasonId,
    modifieddate: TypoLocalDateTime
  ): SalesorderheadersalesreasonRow = new SalesorderheadersalesreasonRow(compositeId.salesorderid, compositeId.salesreasonid, modifieddate)

  given decoder: Decoder[SalesorderheadersalesreasonRow] = Decoder.forProduct3[SalesorderheadersalesreasonRow, SalesorderheaderId, SalesreasonId, TypoLocalDateTime]("salesorderid", "salesreasonid", "modifieddate")(SalesorderheadersalesreasonRow.apply)(using SalesorderheaderId.decoder, SalesreasonId.decoder, TypoLocalDateTime.decoder)

  given encoder: Encoder[SalesorderheadersalesreasonRow] = Encoder.forProduct3[SalesorderheadersalesreasonRow, SalesorderheaderId, SalesreasonId, TypoLocalDateTime]("salesorderid", "salesreasonid", "modifieddate")(x => (x.salesorderid, x.salesreasonid, x.modifieddate))(using SalesorderheaderId.encoder, SalesreasonId.encoder, TypoLocalDateTime.encoder)

  given pgText: Text[SalesorderheadersalesreasonRow] = {
    Text.instance[SalesorderheadersalesreasonRow]{ (row, sb) =>
      SalesorderheaderId.pgText.unsafeEncode(row.salesorderid, sb)
      sb.append(Text.DELIMETER)
      SalesreasonId.pgText.unsafeEncode(row.salesreasonid, sb)
      sb.append(Text.DELIMETER)
      TypoLocalDateTime.pgText.unsafeEncode(row.modifieddate, sb)
    }
  }

  given read: Read[SalesorderheadersalesreasonRow] = {
    new Read.CompositeOfInstances(Array(
      new Read.Single(SalesorderheaderId.get).asInstanceOf[Read[Any]],
        new Read.Single(SalesreasonId.get).asInstanceOf[Read[Any]],
        new Read.Single(TypoLocalDateTime.get).asInstanceOf[Read[Any]]
    ))(using scala.reflect.ClassTag.Any).map { arr =>
      SalesorderheadersalesreasonRow(
        salesorderid = arr(0).asInstanceOf[SalesorderheaderId],
            salesreasonid = arr(1).asInstanceOf[SalesreasonId],
            modifieddate = arr(2).asInstanceOf[TypoLocalDateTime]
      )
    }
  }

  given write: Write[SalesorderheadersalesreasonRow] = {
    new Write.Composite[SalesorderheadersalesreasonRow](
      List(new Write.Single(SalesorderheaderId.put),
           new Write.Single(SalesreasonId.put),
           new Write.Single(TypoLocalDateTime.put)),
      a => List(a.salesorderid, a.salesreasonid, a.modifieddate)
    )
  }
}
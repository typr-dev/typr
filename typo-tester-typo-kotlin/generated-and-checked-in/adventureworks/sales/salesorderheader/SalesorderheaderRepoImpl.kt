/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.sales.salesorderheader

import adventureworks.person.address.AddressId
import adventureworks.person.businessentity.BusinessentityId
import adventureworks.public.AccountNumber
import adventureworks.public.Flag
import adventureworks.public.OrderNumber
import adventureworks.purchasing.shipmethod.ShipmethodId
import adventureworks.sales.currencyrate.CurrencyrateId
import adventureworks.sales.customer.CustomerId
import adventureworks.sales.salesterritory.SalesterritoryId
import adventureworks.userdefined.CustomCreditcardId
import java.sql.Connection
import java.util.ArrayList
import kotlin.collections.Iterator
import kotlin.collections.List
import kotlin.collections.Map
import kotlin.collections.MutableMap
import typo.kotlindsl.DeleteBuilder
import typo.kotlindsl.Dialect
import typo.kotlindsl.Fragment
import typo.kotlindsl.KotlinDbTypes
import typo.kotlindsl.SelectBuilder
import typo.kotlindsl.UpdateBuilder
import typo.kotlindsl.nullable
import typo.runtime.PgTypes
import typo.runtime.streamingInsert

class SalesorderheaderRepoImpl() : SalesorderheaderRepo {
  override fun delete(): DeleteBuilder<SalesorderheaderFields, SalesorderheaderRow> = DeleteBuilder.of("\"sales\".\"salesorderheader\"", SalesorderheaderFields.structure, Dialect.POSTGRESQL)

  override fun deleteById(
    salesorderid: SalesorderheaderId,
    c: Connection
  ): Boolean = Fragment.interpolate(Fragment.lit("delete from \"sales\".\"salesorderheader\" where \"salesorderid\" = "), Fragment.encode(SalesorderheaderId.pgType, salesorderid), Fragment.lit("")).update().runUnchecked(c) > 0

  override fun deleteByIds(
    salesorderids: Array<SalesorderheaderId>,
    c: Connection
  ): Int = Fragment.interpolate(Fragment.lit("delete\nfrom \"sales\".\"salesorderheader\"\nwhere \"salesorderid\" = ANY("), Fragment.encode(SalesorderheaderId.pgTypeArray, salesorderids), Fragment.lit(")"))
    .update()
    .runUnchecked(c)

  override fun insert(
    unsaved: SalesorderheaderRow,
    c: Connection
  ): SalesorderheaderRow = Fragment.interpolate(Fragment.lit("insert into \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")\nvalues ("), Fragment.encode(SalesorderheaderId.pgType, unsaved.salesorderid), Fragment.lit("::int4, "), Fragment.encode(KotlinDbTypes.PgTypes.int2, unsaved.revisionnumber), Fragment.lit("::int2, "), Fragment.encode(PgTypes.timestamp, unsaved.orderdate), Fragment.lit("::timestamp, "), Fragment.encode(PgTypes.timestamp, unsaved.duedate), Fragment.lit("::timestamp, "), Fragment.encode(PgTypes.timestamp.nullable(), unsaved.shipdate), Fragment.lit("::timestamp, "), Fragment.encode(KotlinDbTypes.PgTypes.int2, unsaved.status), Fragment.lit("::int2, "), Fragment.encode(Flag.pgType, unsaved.onlineorderflag), Fragment.lit("::bool, "), Fragment.encode(OrderNumber.pgType.nullable(), unsaved.purchaseordernumber), Fragment.lit("::varchar, "), Fragment.encode(AccountNumber.pgType.nullable(), unsaved.accountnumber), Fragment.lit("::varchar, "), Fragment.encode(CustomerId.pgType, unsaved.customerid), Fragment.lit("::int4, "), Fragment.encode(BusinessentityId.pgType.nullable(), unsaved.salespersonid), Fragment.lit("::int4, "), Fragment.encode(SalesterritoryId.pgType.nullable(), unsaved.territoryid), Fragment.lit("::int4, "), Fragment.encode(AddressId.pgType, unsaved.billtoaddressid), Fragment.lit("::int4, "), Fragment.encode(AddressId.pgType, unsaved.shiptoaddressid), Fragment.lit("::int4, "), Fragment.encode(ShipmethodId.pgType, unsaved.shipmethodid), Fragment.lit("::int4, "), Fragment.encode(CustomCreditcardId.pgType.nullable(), unsaved.creditcardid), Fragment.lit("::int4, "), Fragment.encode(PgTypes.text.nullable(), unsaved.creditcardapprovalcode), Fragment.lit(", "), Fragment.encode(CurrencyrateId.pgType.nullable(), unsaved.currencyrateid), Fragment.lit("::int4, "), Fragment.encode(PgTypes.numeric, unsaved.subtotal), Fragment.lit("::numeric, "), Fragment.encode(PgTypes.numeric, unsaved.taxamt), Fragment.lit("::numeric, "), Fragment.encode(PgTypes.numeric, unsaved.freight), Fragment.lit("::numeric, "), Fragment.encode(PgTypes.numeric.nullable(), unsaved.totaldue), Fragment.lit("::numeric, "), Fragment.encode(PgTypes.text.nullable(), unsaved.comment), Fragment.lit(", "), Fragment.encode(PgTypes.uuid, unsaved.rowguid), Fragment.lit("::uuid, "), Fragment.encode(PgTypes.timestamp, unsaved.modifieddate), Fragment.lit("::timestamp)\nreturning \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\"\n"))
    .updateReturning(SalesorderheaderRow._rowParser.exactlyOne()).runUnchecked(c)

  override fun insert(
    unsaved: SalesorderheaderRowUnsaved,
    c: Connection
  ): SalesorderheaderRow {
    val columns: ArrayList<Fragment> = ArrayList()
    val values: ArrayList<Fragment> = ArrayList()
    columns.add(Fragment.lit("\"duedate\""))
    values.add(Fragment.interpolate(Fragment.encode(PgTypes.timestamp, unsaved.duedate), Fragment.lit("::timestamp")))
    columns.add(Fragment.lit("\"shipdate\""))
    values.add(Fragment.interpolate(Fragment.encode(PgTypes.timestamp.nullable(), unsaved.shipdate), Fragment.lit("::timestamp")))
    columns.add(Fragment.lit("\"purchaseordernumber\""))
    values.add(Fragment.interpolate(Fragment.encode(OrderNumber.pgType.nullable(), unsaved.purchaseordernumber), Fragment.lit("::varchar")))
    columns.add(Fragment.lit("\"accountnumber\""))
    values.add(Fragment.interpolate(Fragment.encode(AccountNumber.pgType.nullable(), unsaved.accountnumber), Fragment.lit("::varchar")))
    columns.add(Fragment.lit("\"customerid\""))
    values.add(Fragment.interpolate(Fragment.encode(CustomerId.pgType, unsaved.customerid), Fragment.lit("::int4")))
    columns.add(Fragment.lit("\"salespersonid\""))
    values.add(Fragment.interpolate(Fragment.encode(BusinessentityId.pgType.nullable(), unsaved.salespersonid), Fragment.lit("::int4")))
    columns.add(Fragment.lit("\"territoryid\""))
    values.add(Fragment.interpolate(Fragment.encode(SalesterritoryId.pgType.nullable(), unsaved.territoryid), Fragment.lit("::int4")))
    columns.add(Fragment.lit("\"billtoaddressid\""))
    values.add(Fragment.interpolate(Fragment.encode(AddressId.pgType, unsaved.billtoaddressid), Fragment.lit("::int4")))
    columns.add(Fragment.lit("\"shiptoaddressid\""))
    values.add(Fragment.interpolate(Fragment.encode(AddressId.pgType, unsaved.shiptoaddressid), Fragment.lit("::int4")))
    columns.add(Fragment.lit("\"shipmethodid\""))
    values.add(Fragment.interpolate(Fragment.encode(ShipmethodId.pgType, unsaved.shipmethodid), Fragment.lit("::int4")))
    columns.add(Fragment.lit("\"creditcardid\""))
    values.add(Fragment.interpolate(Fragment.encode(CustomCreditcardId.pgType.nullable(), unsaved.creditcardid), Fragment.lit("::int4")))
    columns.add(Fragment.lit("\"creditcardapprovalcode\""))
    values.add(Fragment.interpolate(Fragment.encode(PgTypes.text.nullable(), unsaved.creditcardapprovalcode), Fragment.lit("")))
    columns.add(Fragment.lit("\"currencyrateid\""))
    values.add(Fragment.interpolate(Fragment.encode(CurrencyrateId.pgType.nullable(), unsaved.currencyrateid), Fragment.lit("::int4")))
    columns.add(Fragment.lit("\"totaldue\""))
    values.add(Fragment.interpolate(Fragment.encode(PgTypes.numeric.nullable(), unsaved.totaldue), Fragment.lit("::numeric")))
    columns.add(Fragment.lit("\"comment\""))
    values.add(Fragment.interpolate(Fragment.encode(PgTypes.text.nullable(), unsaved.comment), Fragment.lit("")))
    unsaved.salesorderid.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"salesorderid\""))
      values.add(Fragment.interpolate(Fragment.encode(SalesorderheaderId.pgType, value), Fragment.lit("::int4"))) }
    );
    unsaved.revisionnumber.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"revisionnumber\""))
      values.add(Fragment.interpolate(Fragment.encode(KotlinDbTypes.PgTypes.int2, value), Fragment.lit("::int2"))) }
    );
    unsaved.orderdate.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"orderdate\""))
      values.add(Fragment.interpolate(Fragment.encode(PgTypes.timestamp, value), Fragment.lit("::timestamp"))) }
    );
    unsaved.status.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"status\""))
      values.add(Fragment.interpolate(Fragment.encode(KotlinDbTypes.PgTypes.int2, value), Fragment.lit("::int2"))) }
    );
    unsaved.onlineorderflag.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"onlineorderflag\""))
      values.add(Fragment.interpolate(Fragment.encode(Flag.pgType, value), Fragment.lit("::bool"))) }
    );
    unsaved.subtotal.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"subtotal\""))
      values.add(Fragment.interpolate(Fragment.encode(PgTypes.numeric, value), Fragment.lit("::numeric"))) }
    );
    unsaved.taxamt.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"taxamt\""))
      values.add(Fragment.interpolate(Fragment.encode(PgTypes.numeric, value), Fragment.lit("::numeric"))) }
    );
    unsaved.freight.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"freight\""))
      values.add(Fragment.interpolate(Fragment.encode(PgTypes.numeric, value), Fragment.lit("::numeric"))) }
    );
    unsaved.rowguid.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"rowguid\""))
      values.add(Fragment.interpolate(Fragment.encode(PgTypes.uuid, value), Fragment.lit("::uuid"))) }
    );
    unsaved.modifieddate.visit(
      {  },
      { value -> columns.add(Fragment.lit("\"modifieddate\""))
      values.add(Fragment.interpolate(Fragment.encode(PgTypes.timestamp, value), Fragment.lit("::timestamp"))) }
    );
    val q: Fragment = Fragment.interpolate(Fragment.lit("insert into \"sales\".\"salesorderheader\"("), Fragment.comma(columns.toMutableList()), Fragment.lit(")\nvalues ("), Fragment.comma(values.toMutableList()), Fragment.lit(")\nreturning \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\"\n"))
    return q.updateReturning(SalesorderheaderRow._rowParser.exactlyOne()).runUnchecked(c)
  }

  override fun insertStreaming(
    unsaved: Iterator<SalesorderheaderRow>,
    batchSize: Int,
    c: Connection
  ): Long = streamingInsert.insertUnchecked("COPY \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\") FROM STDIN", batchSize, unsaved, c, SalesorderheaderRow.pgText)

  /** NOTE: this functionality requires PostgreSQL 16 or later! */
  override fun insertUnsavedStreaming(
    unsaved: Iterator<SalesorderheaderRowUnsaved>,
    batchSize: Int,
    c: Connection
  ): Long = streamingInsert.insertUnchecked("COPY \"sales\".\"salesorderheader\"(\"duedate\", \"shipdate\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"totaldue\", \"comment\", \"salesorderid\", \"revisionnumber\", \"orderdate\", \"status\", \"onlineorderflag\", \"subtotal\", \"taxamt\", \"freight\", \"rowguid\", \"modifieddate\") FROM STDIN (DEFAULT '__DEFAULT_VALUE__')", batchSize, unsaved, c, SalesorderheaderRowUnsaved.pgText)

  override fun select(): SelectBuilder<SalesorderheaderFields, SalesorderheaderRow> = SelectBuilder.of("\"sales\".\"salesorderheader\"", SalesorderheaderFields.structure, SalesorderheaderRow._rowParser, Dialect.POSTGRESQL)

  override fun selectAll(c: Connection): List<SalesorderheaderRow> = Fragment.interpolate(Fragment.lit("select \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\"\nfrom \"sales\".\"salesorderheader\"\n")).query(SalesorderheaderRow._rowParser.all()).runUnchecked(c)

  override fun selectById(
    salesorderid: SalesorderheaderId,
    c: Connection
  ): SalesorderheaderRow? = Fragment.interpolate(Fragment.lit("select \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\"\nfrom \"sales\".\"salesorderheader\"\nwhere \"salesorderid\" = "), Fragment.encode(SalesorderheaderId.pgType, salesorderid), Fragment.lit("")).query(SalesorderheaderRow._rowParser.first()).runUnchecked(c)

  override fun selectByIds(
    salesorderids: Array<SalesorderheaderId>,
    c: Connection
  ): List<SalesorderheaderRow> = Fragment.interpolate(Fragment.lit("select \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\"\nfrom \"sales\".\"salesorderheader\"\nwhere \"salesorderid\" = ANY("), Fragment.encode(SalesorderheaderId.pgTypeArray, salesorderids), Fragment.lit(")")).query(SalesorderheaderRow._rowParser.all()).runUnchecked(c)

  override fun selectByIdsTracked(
    salesorderids: Array<SalesorderheaderId>,
    c: Connection
  ): Map<SalesorderheaderId, SalesorderheaderRow> {
    val ret: MutableMap<SalesorderheaderId, SalesorderheaderRow> = mutableMapOf<SalesorderheaderId, SalesorderheaderRow>()
    selectByIds(salesorderids, c).forEach({ row -> ret.put(row.salesorderid, row) })
    return ret.toMap()
  }

  override fun update(): UpdateBuilder<SalesorderheaderFields, SalesorderheaderRow> = UpdateBuilder.of("\"sales\".\"salesorderheader\"", SalesorderheaderFields.structure, SalesorderheaderRow._rowParser, Dialect.POSTGRESQL)

  override fun update(
    row: SalesorderheaderRow,
    c: Connection
  ): Boolean {
    val salesorderid: SalesorderheaderId = row.salesorderid
    return Fragment.interpolate(Fragment.lit("update \"sales\".\"salesorderheader\"\nset \"revisionnumber\" = "), Fragment.encode(KotlinDbTypes.PgTypes.int2, row.revisionnumber), Fragment.lit("::int2,\n\"orderdate\" = "), Fragment.encode(PgTypes.timestamp, row.orderdate), Fragment.lit("::timestamp,\n\"duedate\" = "), Fragment.encode(PgTypes.timestamp, row.duedate), Fragment.lit("::timestamp,\n\"shipdate\" = "), Fragment.encode(PgTypes.timestamp.nullable(), row.shipdate), Fragment.lit("::timestamp,\n\"status\" = "), Fragment.encode(KotlinDbTypes.PgTypes.int2, row.status), Fragment.lit("::int2,\n\"onlineorderflag\" = "), Fragment.encode(Flag.pgType, row.onlineorderflag), Fragment.lit("::bool,\n\"purchaseordernumber\" = "), Fragment.encode(OrderNumber.pgType.nullable(), row.purchaseordernumber), Fragment.lit("::varchar,\n\"accountnumber\" = "), Fragment.encode(AccountNumber.pgType.nullable(), row.accountnumber), Fragment.lit("::varchar,\n\"customerid\" = "), Fragment.encode(CustomerId.pgType, row.customerid), Fragment.lit("::int4,\n\"salespersonid\" = "), Fragment.encode(BusinessentityId.pgType.nullable(), row.salespersonid), Fragment.lit("::int4,\n\"territoryid\" = "), Fragment.encode(SalesterritoryId.pgType.nullable(), row.territoryid), Fragment.lit("::int4,\n\"billtoaddressid\" = "), Fragment.encode(AddressId.pgType, row.billtoaddressid), Fragment.lit("::int4,\n\"shiptoaddressid\" = "), Fragment.encode(AddressId.pgType, row.shiptoaddressid), Fragment.lit("::int4,\n\"shipmethodid\" = "), Fragment.encode(ShipmethodId.pgType, row.shipmethodid), Fragment.lit("::int4,\n\"creditcardid\" = "), Fragment.encode(CustomCreditcardId.pgType.nullable(), row.creditcardid), Fragment.lit("::int4,\n\"creditcardapprovalcode\" = "), Fragment.encode(PgTypes.text.nullable(), row.creditcardapprovalcode), Fragment.lit(",\n\"currencyrateid\" = "), Fragment.encode(CurrencyrateId.pgType.nullable(), row.currencyrateid), Fragment.lit("::int4,\n\"subtotal\" = "), Fragment.encode(PgTypes.numeric, row.subtotal), Fragment.lit("::numeric,\n\"taxamt\" = "), Fragment.encode(PgTypes.numeric, row.taxamt), Fragment.lit("::numeric,\n\"freight\" = "), Fragment.encode(PgTypes.numeric, row.freight), Fragment.lit("::numeric,\n\"totaldue\" = "), Fragment.encode(PgTypes.numeric.nullable(), row.totaldue), Fragment.lit("::numeric,\n\"comment\" = "), Fragment.encode(PgTypes.text.nullable(), row.comment), Fragment.lit(",\n\"rowguid\" = "), Fragment.encode(PgTypes.uuid, row.rowguid), Fragment.lit("::uuid,\n\"modifieddate\" = "), Fragment.encode(PgTypes.timestamp, row.modifieddate), Fragment.lit("::timestamp\nwhere \"salesorderid\" = "), Fragment.encode(SalesorderheaderId.pgType, salesorderid), Fragment.lit("")).update().runUnchecked(c) > 0
  }

  override fun upsert(
    unsaved: SalesorderheaderRow,
    c: Connection
  ): SalesorderheaderRow = Fragment.interpolate(Fragment.lit("insert into \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")\nvalues ("), Fragment.encode(SalesorderheaderId.pgType, unsaved.salesorderid), Fragment.lit("::int4, "), Fragment.encode(KotlinDbTypes.PgTypes.int2, unsaved.revisionnumber), Fragment.lit("::int2, "), Fragment.encode(PgTypes.timestamp, unsaved.orderdate), Fragment.lit("::timestamp, "), Fragment.encode(PgTypes.timestamp, unsaved.duedate), Fragment.lit("::timestamp, "), Fragment.encode(PgTypes.timestamp.nullable(), unsaved.shipdate), Fragment.lit("::timestamp, "), Fragment.encode(KotlinDbTypes.PgTypes.int2, unsaved.status), Fragment.lit("::int2, "), Fragment.encode(Flag.pgType, unsaved.onlineorderflag), Fragment.lit("::bool, "), Fragment.encode(OrderNumber.pgType.nullable(), unsaved.purchaseordernumber), Fragment.lit("::varchar, "), Fragment.encode(AccountNumber.pgType.nullable(), unsaved.accountnumber), Fragment.lit("::varchar, "), Fragment.encode(CustomerId.pgType, unsaved.customerid), Fragment.lit("::int4, "), Fragment.encode(BusinessentityId.pgType.nullable(), unsaved.salespersonid), Fragment.lit("::int4, "), Fragment.encode(SalesterritoryId.pgType.nullable(), unsaved.territoryid), Fragment.lit("::int4, "), Fragment.encode(AddressId.pgType, unsaved.billtoaddressid), Fragment.lit("::int4, "), Fragment.encode(AddressId.pgType, unsaved.shiptoaddressid), Fragment.lit("::int4, "), Fragment.encode(ShipmethodId.pgType, unsaved.shipmethodid), Fragment.lit("::int4, "), Fragment.encode(CustomCreditcardId.pgType.nullable(), unsaved.creditcardid), Fragment.lit("::int4, "), Fragment.encode(PgTypes.text.nullable(), unsaved.creditcardapprovalcode), Fragment.lit(", "), Fragment.encode(CurrencyrateId.pgType.nullable(), unsaved.currencyrateid), Fragment.lit("::int4, "), Fragment.encode(PgTypes.numeric, unsaved.subtotal), Fragment.lit("::numeric, "), Fragment.encode(PgTypes.numeric, unsaved.taxamt), Fragment.lit("::numeric, "), Fragment.encode(PgTypes.numeric, unsaved.freight), Fragment.lit("::numeric, "), Fragment.encode(PgTypes.numeric.nullable(), unsaved.totaldue), Fragment.lit("::numeric, "), Fragment.encode(PgTypes.text.nullable(), unsaved.comment), Fragment.lit(", "), Fragment.encode(PgTypes.uuid, unsaved.rowguid), Fragment.lit("::uuid, "), Fragment.encode(PgTypes.timestamp, unsaved.modifieddate), Fragment.lit("::timestamp)\non conflict (\"salesorderid\")\ndo update set\n  \"revisionnumber\" = EXCLUDED.\"revisionnumber\",\n\"orderdate\" = EXCLUDED.\"orderdate\",\n\"duedate\" = EXCLUDED.\"duedate\",\n\"shipdate\" = EXCLUDED.\"shipdate\",\n\"status\" = EXCLUDED.\"status\",\n\"onlineorderflag\" = EXCLUDED.\"onlineorderflag\",\n\"purchaseordernumber\" = EXCLUDED.\"purchaseordernumber\",\n\"accountnumber\" = EXCLUDED.\"accountnumber\",\n\"customerid\" = EXCLUDED.\"customerid\",\n\"salespersonid\" = EXCLUDED.\"salespersonid\",\n\"territoryid\" = EXCLUDED.\"territoryid\",\n\"billtoaddressid\" = EXCLUDED.\"billtoaddressid\",\n\"shiptoaddressid\" = EXCLUDED.\"shiptoaddressid\",\n\"shipmethodid\" = EXCLUDED.\"shipmethodid\",\n\"creditcardid\" = EXCLUDED.\"creditcardid\",\n\"creditcardapprovalcode\" = EXCLUDED.\"creditcardapprovalcode\",\n\"currencyrateid\" = EXCLUDED.\"currencyrateid\",\n\"subtotal\" = EXCLUDED.\"subtotal\",\n\"taxamt\" = EXCLUDED.\"taxamt\",\n\"freight\" = EXCLUDED.\"freight\",\n\"totaldue\" = EXCLUDED.\"totaldue\",\n\"comment\" = EXCLUDED.\"comment\",\n\"rowguid\" = EXCLUDED.\"rowguid\",\n\"modifieddate\" = EXCLUDED.\"modifieddate\"\nreturning \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\""))
    .updateReturning(SalesorderheaderRow._rowParser.exactlyOne())
    .runUnchecked(c)

  override fun upsertBatch(
    unsaved: Iterator<SalesorderheaderRow>,
    c: Connection
  ): List<SalesorderheaderRow> = Fragment.interpolate(Fragment.lit("insert into \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")\nvalues (?::int4, ?::int2, ?::timestamp, ?::timestamp, ?::timestamp, ?::int2, ?::bool, ?::varchar, ?::varchar, ?::int4, ?::int4, ?::int4, ?::int4, ?::int4, ?::int4, ?::int4, ?, ?::int4, ?::numeric, ?::numeric, ?::numeric, ?::numeric, ?, ?::uuid, ?::timestamp)\non conflict (\"salesorderid\")\ndo update set\n  \"revisionnumber\" = EXCLUDED.\"revisionnumber\",\n\"orderdate\" = EXCLUDED.\"orderdate\",\n\"duedate\" = EXCLUDED.\"duedate\",\n\"shipdate\" = EXCLUDED.\"shipdate\",\n\"status\" = EXCLUDED.\"status\",\n\"onlineorderflag\" = EXCLUDED.\"onlineorderflag\",\n\"purchaseordernumber\" = EXCLUDED.\"purchaseordernumber\",\n\"accountnumber\" = EXCLUDED.\"accountnumber\",\n\"customerid\" = EXCLUDED.\"customerid\",\n\"salespersonid\" = EXCLUDED.\"salespersonid\",\n\"territoryid\" = EXCLUDED.\"territoryid\",\n\"billtoaddressid\" = EXCLUDED.\"billtoaddressid\",\n\"shiptoaddressid\" = EXCLUDED.\"shiptoaddressid\",\n\"shipmethodid\" = EXCLUDED.\"shipmethodid\",\n\"creditcardid\" = EXCLUDED.\"creditcardid\",\n\"creditcardapprovalcode\" = EXCLUDED.\"creditcardapprovalcode\",\n\"currencyrateid\" = EXCLUDED.\"currencyrateid\",\n\"subtotal\" = EXCLUDED.\"subtotal\",\n\"taxamt\" = EXCLUDED.\"taxamt\",\n\"freight\" = EXCLUDED.\"freight\",\n\"totaldue\" = EXCLUDED.\"totaldue\",\n\"comment\" = EXCLUDED.\"comment\",\n\"rowguid\" = EXCLUDED.\"rowguid\",\n\"modifieddate\" = EXCLUDED.\"modifieddate\"\nreturning \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\""))
    .updateManyReturning(SalesorderheaderRow._rowParser, unsaved)
  .runUnchecked(c)

  /** NOTE: this functionality is not safe if you use auto-commit mode! it runs 3 SQL statements */
  override fun upsertStreaming(
    unsaved: Iterator<SalesorderheaderRow>,
    batchSize: Int,
    c: Connection
  ): Int {
    Fragment.interpolate(Fragment.lit("create temporary table salesorderheader_TEMP (like \"sales\".\"salesorderheader\") on commit drop")).update().runUnchecked(c)
    streamingInsert.insertUnchecked("copy salesorderheader_TEMP(\"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\") from stdin", batchSize, unsaved, c, SalesorderheaderRow.pgText)
    return Fragment.interpolate(Fragment.lit("insert into \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")\nselect * from salesorderheader_TEMP\non conflict (\"salesorderid\")\ndo update set\n  \"revisionnumber\" = EXCLUDED.\"revisionnumber\",\n\"orderdate\" = EXCLUDED.\"orderdate\",\n\"duedate\" = EXCLUDED.\"duedate\",\n\"shipdate\" = EXCLUDED.\"shipdate\",\n\"status\" = EXCLUDED.\"status\",\n\"onlineorderflag\" = EXCLUDED.\"onlineorderflag\",\n\"purchaseordernumber\" = EXCLUDED.\"purchaseordernumber\",\n\"accountnumber\" = EXCLUDED.\"accountnumber\",\n\"customerid\" = EXCLUDED.\"customerid\",\n\"salespersonid\" = EXCLUDED.\"salespersonid\",\n\"territoryid\" = EXCLUDED.\"territoryid\",\n\"billtoaddressid\" = EXCLUDED.\"billtoaddressid\",\n\"shiptoaddressid\" = EXCLUDED.\"shiptoaddressid\",\n\"shipmethodid\" = EXCLUDED.\"shipmethodid\",\n\"creditcardid\" = EXCLUDED.\"creditcardid\",\n\"creditcardapprovalcode\" = EXCLUDED.\"creditcardapprovalcode\",\n\"currencyrateid\" = EXCLUDED.\"currencyrateid\",\n\"subtotal\" = EXCLUDED.\"subtotal\",\n\"taxamt\" = EXCLUDED.\"taxamt\",\n\"freight\" = EXCLUDED.\"freight\",\n\"totaldue\" = EXCLUDED.\"totaldue\",\n\"comment\" = EXCLUDED.\"comment\",\n\"rowguid\" = EXCLUDED.\"rowguid\",\n\"modifieddate\" = EXCLUDED.\"modifieddate\"\n;\ndrop table salesorderheader_TEMP;")).update().runUnchecked(c)
  }
}
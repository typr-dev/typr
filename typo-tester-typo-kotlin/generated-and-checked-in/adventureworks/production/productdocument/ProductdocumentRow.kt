/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.production.productdocument

import adventureworks.customtypes.Defaulted
import adventureworks.production.document.DocumentId
import adventureworks.production.product.ProductId
import java.time.LocalDateTime
import typo.kotlindsl.RowParser
import typo.kotlindsl.RowParsers
import typo.runtime.PgText
import typo.runtime.PgTypes

/** Table: production.productdocument
  * Cross-reference table mapping products to related product documents.
  * Composite primary key: productid, documentnode
  */
data class ProductdocumentRow(
  /** Product identification number. Foreign key to Product.ProductID.
    * Points to [adventureworks.production.product.ProductRow.productid]
    */
  val productid: ProductId,
  /** Default: now() */
  val modifieddate: LocalDateTime,
  /** Document identification number. Foreign key to Document.DocumentNode.
    * Default: '/'::character varying
    * Points to [adventureworks.production.document.DocumentRow.documentnode]
    */
  val documentnode: DocumentId
) {
  fun compositeId(): ProductdocumentId = ProductdocumentId(productid, documentnode)

  fun id(): ProductdocumentId = this.compositeId()

  fun toUnsavedRow(
    documentnode: Defaulted<DocumentId>,
    modifieddate: Defaulted<LocalDateTime>
  ): ProductdocumentRowUnsaved = ProductdocumentRowUnsaved(productid, modifieddate, documentnode)

  companion object {
    val _rowParser: RowParser<ProductdocumentRow> = RowParsers.of(ProductId.pgType, PgTypes.timestamp, DocumentId.pgType, { t0, t1, t2 -> ProductdocumentRow(t0, t1, t2) }, { row -> arrayOf<Any?>(row.productid, row.modifieddate, row.documentnode) })

    fun apply(
      compositeId: ProductdocumentId,
      modifieddate: LocalDateTime
    ): ProductdocumentRow = ProductdocumentRow(compositeId.productid, modifieddate, compositeId.documentnode)

    val pgText: PgText<ProductdocumentRow> =
      PgText.from(_rowParser.underlying)
  }
}
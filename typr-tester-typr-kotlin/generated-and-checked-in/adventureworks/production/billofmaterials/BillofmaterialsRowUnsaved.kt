/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.production.billofmaterials

import adventureworks.customtypes.Defaulted
import adventureworks.customtypes.Defaulted.UseDefault
import adventureworks.production.product.ProductId
import adventureworks.production.unitmeasure.UnitmeasureId
import java.math.BigDecimal
import java.time.LocalDateTime
import typr.kotlindsl.KotlinDbTypes
import typr.kotlindsl.nullable
import typr.runtime.PgText
import typr.runtime.PgTypes

/** This class corresponds to a row in table `production.billofmaterials` which has not been persisted yet */
data class BillofmaterialsRowUnsaved(
  /** Parent product identification number. Foreign key to Product.ProductID.
    * Points to [adventureworks.production.product.ProductRow.productid]
    * Constraint CK_BillOfMaterials_BOMLevel affecting columns bomlevel, perassemblyqty, productassemblyid:  ((((productassemblyid IS NULL) AND (bomlevel = 0) AND (perassemblyqty = 1.00)) OR ((productassemblyid IS NOT NULL) AND (bomlevel >= 1))))
    * Constraint CK_BillOfMaterials_ProductAssemblyID affecting columns componentid, productassemblyid:  ((productassemblyid <> componentid))
    */
  val productassemblyid: ProductId? = null,
  /** Component identification number. Foreign key to Product.ProductID.
    * Points to [adventureworks.production.product.ProductRow.productid]
    * Constraint CK_BillOfMaterials_ProductAssemblyID affecting columns componentid, productassemblyid:  ((productassemblyid <> componentid))
    */
  val componentid: ProductId,
  /** Date the component stopped being used in the assembly item.
    * Constraint CK_BillOfMaterials_EndDate affecting columns enddate, startdate:  (((enddate > startdate) OR (enddate IS NULL)))
    */
  val enddate: LocalDateTime? = null,
  /** Standard code identifying the unit of measure for the quantity.
    * Points to [adventureworks.production.unitmeasure.UnitmeasureRow.unitmeasurecode]
    */
  val unitmeasurecode: UnitmeasureId,
  /** Indicates the depth the component is from its parent (AssemblyID).
    * Constraint CK_BillOfMaterials_BOMLevel affecting columns bomlevel, perassemblyqty, productassemblyid:  ((((productassemblyid IS NULL) AND (bomlevel = 0) AND (perassemblyqty = 1.00)) OR ((productassemblyid IS NOT NULL) AND (bomlevel >= 1))))
    */
  val bomlevel: Short,
  /** Default: nextval('production.billofmaterials_billofmaterialsid_seq'::regclass)
    * Primary key for BillOfMaterials records.
    */
  val billofmaterialsid: Defaulted<Int> = UseDefault(),
  /** Default: now()
    * Date the component started being used in the assembly item.
    * Constraint CK_BillOfMaterials_EndDate affecting columns enddate, startdate:  (((enddate > startdate) OR (enddate IS NULL)))
    */
  val startdate: Defaulted<LocalDateTime> = UseDefault(),
  /** Default: 1.00
    * Quantity of the component needed to create the assembly.
    * Constraint CK_BillOfMaterials_BOMLevel affecting columns bomlevel, perassemblyqty, productassemblyid:  ((((productassemblyid IS NULL) AND (bomlevel = 0) AND (perassemblyqty = 1.00)) OR ((productassemblyid IS NOT NULL) AND (bomlevel >= 1))))
    * Constraint CK_BillOfMaterials_PerAssemblyQty affecting columns perassemblyqty:  ((perassemblyqty >= 1.00))
    */
  val perassemblyqty: Defaulted<BigDecimal> = UseDefault(),
  /** Default: now() */
  val modifieddate: Defaulted<LocalDateTime> = UseDefault()
) {
  fun toRow(
    billofmaterialsidDefault: () -> Int,
    startdateDefault: () -> LocalDateTime,
    perassemblyqtyDefault: () -> BigDecimal,
    modifieddateDefault: () -> LocalDateTime
  ): BillofmaterialsRow = BillofmaterialsRow(billofmaterialsid = billofmaterialsid.getOrElse(billofmaterialsidDefault), productassemblyid = productassemblyid, componentid = componentid, startdate = startdate.getOrElse(startdateDefault), enddate = enddate, unitmeasurecode = unitmeasurecode, bomlevel = bomlevel, perassemblyqty = perassemblyqty.getOrElse(perassemblyqtyDefault), modifieddate = modifieddate.getOrElse(modifieddateDefault))

  companion object {
    val pgText: PgText<BillofmaterialsRowUnsaved> =
      PgText.instance({ row, sb -> ProductId.pgType.nullable().pgText().unsafeEncode(row.productassemblyid, sb)
      sb.append(PgText.DELIMETER)
      ProductId.pgType.pgText().unsafeEncode(row.componentid, sb)
      sb.append(PgText.DELIMETER)
      PgTypes.timestamp.nullable().pgText().unsafeEncode(row.enddate, sb)
      sb.append(PgText.DELIMETER)
      UnitmeasureId.pgType.pgText().unsafeEncode(row.unitmeasurecode, sb)
      sb.append(PgText.DELIMETER)
      KotlinDbTypes.PgTypes.int2.pgText().unsafeEncode(row.bomlevel, sb)
      sb.append(PgText.DELIMETER)
      Defaulted.pgText(KotlinDbTypes.PgTypes.int4.pgText()).unsafeEncode(row.billofmaterialsid, sb)
      sb.append(PgText.DELIMETER)
      Defaulted.pgText(PgTypes.timestamp.pgText()).unsafeEncode(row.startdate, sb)
      sb.append(PgText.DELIMETER)
      Defaulted.pgText(PgTypes.numeric.pgText()).unsafeEncode(row.perassemblyqty, sb)
      sb.append(PgText.DELIMETER)
      Defaulted.pgText(PgTypes.timestamp.pgText()).unsafeEncode(row.modifieddate, sb) })
  }
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.order_items_bulk_insert

import dev.typr.foundations.DuckDbTypes
import dev.typr.foundations.kotlin.Fragment
import dev.typr.foundations.kotlin.KotlinDbTypes
import java.math.BigDecimal
import java.sql.Connection
import testdb.orders.OrdersId
import testdb.products.ProductsId

class OrderItemsBulkInsertSqlRepoImpl() : OrderItemsBulkInsertSqlRepo {
  override fun apply(
    orderId: /* user-picked */ OrdersId,
    productId: /* user-picked */ ProductsId,
    quantity: Int,
    unitPrice: BigDecimal,
    c: Connection
  ): Int = Fragment.interpolate(Fragment.lit("-- Insert order items with composite key handling\n-- Tests: composite primary key in INSERT, foreign key types, RETURNING with composite key\n\nINSERT INTO order_items (order_id, product_id, quantity, unit_price)\nVALUES (\n    CAST("), Fragment.encode(OrdersId.duckDbType, orderId), Fragment.lit(" AS INTEGER),\n    CAST("), Fragment.encode(ProductsId.duckDbType, productId), Fragment.lit(" AS INTEGER),\n    CAST("), Fragment.encode(KotlinDbTypes.DuckDbTypes.integer, quantity), Fragment.lit(" AS INTEGER),\n    CAST("), Fragment.encode(DuckDbTypes.numeric, unitPrice), Fragment.lit(" AS DECIMAL)\n)\nRETURNING\n    order_id,\n    product_id,\n    quantity,\n    unit_price")).update().runUnchecked(c)
}
/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.precision_types_null;

import static dev.typr.foundations.Fragment.interpolate;

import dev.typr.foundations.DuckDbTypes;
import dev.typr.foundations.Fragment;
import dev.typr.foundations.dsl.DeleteBuilder;
import dev.typr.foundations.dsl.Dialect;
import dev.typr.foundations.dsl.SelectBuilder;
import dev.typr.foundations.dsl.UpdateBuilder;
import java.sql.Connection;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import testdb.precisetypes.Decimal10_2;
import testdb.precisetypes.Decimal18_4;
import testdb.precisetypes.Decimal5_2;
import testdb.precisetypes.Int10;
import testdb.precisetypes.Int18;
import testdb.precisetypes.Int5;

public class PrecisionTypesNullRepoImpl implements PrecisionTypesNullRepo {
  @Override
  public DeleteBuilder<PrecisionTypesNullFields, PrecisionTypesNullRow> delete() {
    return DeleteBuilder.of(
        "\"precision_types_null\"", PrecisionTypesNullFields.structure, Dialect.DUCKDB);
  }

  @Override
  public Boolean deleteById(PrecisionTypesNullId id, Connection c) {
    return interpolate(
                Fragment.lit("delete from \"precision_types_null\" where \"id\" = "),
                Fragment.encode(PrecisionTypesNullId.duckDbType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public Integer deleteByIds(PrecisionTypesNullId[] ids, Connection c) {
    return interpolate(
            Fragment.lit("delete\nfrom \"precision_types_null\"\nwhere \"id\" = ANY("),
            Fragment.encode(PrecisionTypesNullId.dbTypeArray, ids),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }

  @Override
  public PrecisionTypesNullRow insert(PrecisionTypesNullRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"precision_types_null\"(\"id\", \"string10\", \"string20\","
                    + " \"string50\", \"string100\", \"string255\", \"decimal5_2\","
                    + " \"decimal10_2\", \"decimal18_4\", \"decimal5_0\", \"decimal10_0\","
                    + " \"decimal18_0\")\n"
                    + "values ("),
            Fragment.encode(PrecisionTypesNullId.duckDbType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.duckDbType.opt(), unsaved.decimal52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.duckDbType.opt(), unsaved.decimal102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.duckDbType.opt(), unsaved.decimal184()),
            Fragment.lit(", "),
            Fragment.encode(Int5.duckDbType.opt(), unsaved.decimal50()),
            Fragment.lit(", "),
            Fragment.encode(Int10.duckDbType.opt(), unsaved.decimal100()),
            Fragment.lit(", "),
            Fragment.encode(Int18.duckDbType.opt(), unsaved.decimal180()),
            Fragment.lit(
                ")\n"
                    + "RETURNING \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\"\n"))
        .updateReturning(PrecisionTypesNullRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public SelectBuilder<PrecisionTypesNullFields, PrecisionTypesNullRow> select() {
    return SelectBuilder.of(
        "\"precision_types_null\"",
        PrecisionTypesNullFields.structure,
        PrecisionTypesNullRow._rowParser,
        Dialect.DUCKDB);
  }

  @Override
  public List<PrecisionTypesNullRow> selectAll(Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\"\n"
                    + "from \"precision_types_null\"\n"))
        .query(PrecisionTypesNullRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Optional<PrecisionTypesNullRow> selectById(PrecisionTypesNullId id, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\"\n"
                    + "from \"precision_types_null\"\n"
                    + "where \"id\" = "),
            Fragment.encode(PrecisionTypesNullId.duckDbType, id),
            Fragment.lit(""))
        .query(PrecisionTypesNullRow._rowParser.first())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesNullRow> selectByIds(PrecisionTypesNullId[] ids, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\"\n"
                    + "from \"precision_types_null\"\n"
                    + "where \"id\" = ANY("),
            Fragment.encode(PrecisionTypesNullId.dbTypeArray, ids),
            Fragment.lit(")"))
        .query(PrecisionTypesNullRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Map<PrecisionTypesNullId, PrecisionTypesNullRow> selectByIdsTracked(
      PrecisionTypesNullId[] ids, Connection c) {
    HashMap<PrecisionTypesNullId, PrecisionTypesNullRow> ret =
        new HashMap<PrecisionTypesNullId, PrecisionTypesNullRow>();
    selectByIds(ids, c).forEach(row -> ret.put(row.id(), row));
    return ret;
  }

  @Override
  public UpdateBuilder<PrecisionTypesNullFields, PrecisionTypesNullRow> update() {
    return UpdateBuilder.of(
        "\"precision_types_null\"",
        PrecisionTypesNullFields.structure,
        PrecisionTypesNullRow._rowParser,
        Dialect.DUCKDB);
  }

  @Override
  public Boolean update(PrecisionTypesNullRow row, Connection c) {
    PrecisionTypesNullId id = row.id();
    ;
    return interpolate(
                Fragment.lit("update \"precision_types_null\"\nset \"string10\" = "),
                Fragment.encode(DuckDbTypes.varchar.opt(), row.string10()),
                Fragment.lit(",\n\"string20\" = "),
                Fragment.encode(DuckDbTypes.varchar.opt(), row.string20()),
                Fragment.lit(",\n\"string50\" = "),
                Fragment.encode(DuckDbTypes.varchar.opt(), row.string50()),
                Fragment.lit(",\n\"string100\" = "),
                Fragment.encode(DuckDbTypes.varchar.opt(), row.string100()),
                Fragment.lit(",\n\"string255\" = "),
                Fragment.encode(DuckDbTypes.varchar.opt(), row.string255()),
                Fragment.lit(",\n\"decimal5_2\" = "),
                Fragment.encode(Decimal5_2.duckDbType.opt(), row.decimal52()),
                Fragment.lit(",\n\"decimal10_2\" = "),
                Fragment.encode(Decimal10_2.duckDbType.opt(), row.decimal102()),
                Fragment.lit(",\n\"decimal18_4\" = "),
                Fragment.encode(Decimal18_4.duckDbType.opt(), row.decimal184()),
                Fragment.lit(",\n\"decimal5_0\" = "),
                Fragment.encode(Int5.duckDbType.opt(), row.decimal50()),
                Fragment.lit(",\n\"decimal10_0\" = "),
                Fragment.encode(Int10.duckDbType.opt(), row.decimal100()),
                Fragment.lit(",\n\"decimal18_0\" = "),
                Fragment.encode(Int18.duckDbType.opt(), row.decimal180()),
                Fragment.lit("\nwhere \"id\" = "),
                Fragment.encode(PrecisionTypesNullId.duckDbType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public PrecisionTypesNullRow upsert(PrecisionTypesNullRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "INSERT INTO \"precision_types_null\"(\"id\", \"string10\", \"string20\","
                    + " \"string50\", \"string100\", \"string255\", \"decimal5_2\","
                    + " \"decimal10_2\", \"decimal18_4\", \"decimal5_0\", \"decimal10_0\","
                    + " \"decimal18_0\")\n"
                    + "VALUES ("),
            Fragment.encode(PrecisionTypesNullId.duckDbType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar.opt(), unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.duckDbType.opt(), unsaved.decimal52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.duckDbType.opt(), unsaved.decimal102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.duckDbType.opt(), unsaved.decimal184()),
            Fragment.lit(", "),
            Fragment.encode(Int5.duckDbType.opt(), unsaved.decimal50()),
            Fragment.lit(", "),
            Fragment.encode(Int10.duckDbType.opt(), unsaved.decimal100()),
            Fragment.lit(", "),
            Fragment.encode(Int18.duckDbType.opt(), unsaved.decimal180()),
            Fragment.lit(
                ")\n"
                    + "ON CONFLICT (\"id\")\n"
                    + "DO UPDATE SET\n"
                    + "  \"string10\" = EXCLUDED.\"string10\",\n"
                    + "\"string20\" = EXCLUDED.\"string20\",\n"
                    + "\"string50\" = EXCLUDED.\"string50\",\n"
                    + "\"string100\" = EXCLUDED.\"string100\",\n"
                    + "\"string255\" = EXCLUDED.\"string255\",\n"
                    + "\"decimal5_2\" = EXCLUDED.\"decimal5_2\",\n"
                    + "\"decimal10_2\" = EXCLUDED.\"decimal10_2\",\n"
                    + "\"decimal18_4\" = EXCLUDED.\"decimal18_4\",\n"
                    + "\"decimal5_0\" = EXCLUDED.\"decimal5_0\",\n"
                    + "\"decimal10_0\" = EXCLUDED.\"decimal10_0\",\n"
                    + "\"decimal18_0\" = EXCLUDED.\"decimal18_0\"\n"
                    + "RETURNING \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\""))
        .updateReturning(PrecisionTypesNullRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesNullRow> upsertBatch(
      Iterator<PrecisionTypesNullRow> unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "INSERT INTO \"precision_types_null\"(\"id\", \"string10\", \"string20\","
                    + " \"string50\", \"string100\", \"string255\", \"decimal5_2\","
                    + " \"decimal10_2\", \"decimal18_4\", \"decimal5_0\", \"decimal10_0\","
                    + " \"decimal18_0\")\n"
                    + "VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n"
                    + "ON CONFLICT (\"id\")\n"
                    + "DO UPDATE SET\n"
                    + "  \"string10\" = EXCLUDED.\"string10\",\n"
                    + "\"string20\" = EXCLUDED.\"string20\",\n"
                    + "\"string50\" = EXCLUDED.\"string50\",\n"
                    + "\"string100\" = EXCLUDED.\"string100\",\n"
                    + "\"string255\" = EXCLUDED.\"string255\",\n"
                    + "\"decimal5_2\" = EXCLUDED.\"decimal5_2\",\n"
                    + "\"decimal10_2\" = EXCLUDED.\"decimal10_2\",\n"
                    + "\"decimal18_4\" = EXCLUDED.\"decimal18_4\",\n"
                    + "\"decimal5_0\" = EXCLUDED.\"decimal5_0\",\n"
                    + "\"decimal10_0\" = EXCLUDED.\"decimal10_0\",\n"
                    + "\"decimal18_0\" = EXCLUDED.\"decimal18_0\"\n"
                    + "RETURNING \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\""))
        .updateReturningEach(PrecisionTypesNullRow._rowParser, unsaved)
        .runUnchecked(c);
  }
}

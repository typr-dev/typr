/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.precision_types;

import static dev.typr.foundations.Fragment.interpolate;

import dev.typr.foundations.DuckDbTypes;
import dev.typr.foundations.Fragment;
import dev.typr.foundations.dsl.DeleteBuilder;
import dev.typr.foundations.dsl.Dialect;
import dev.typr.foundations.dsl.SelectBuilder;
import dev.typr.foundations.dsl.UpdateBuilder;
import java.sql.Connection;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import testdb.precisetypes.Decimal10_2;
import testdb.precisetypes.Decimal18_4;
import testdb.precisetypes.Decimal5_2;
import testdb.precisetypes.Int10;
import testdb.precisetypes.Int18;
import testdb.precisetypes.Int5;

public class PrecisionTypesRepoImpl implements PrecisionTypesRepo {
  @Override
  public DeleteBuilder<PrecisionTypesFields, PrecisionTypesRow> delete() {
    return DeleteBuilder.of("\"precision_types\"", PrecisionTypesFields.structure, Dialect.DUCKDB);
  }

  @Override
  public Boolean deleteById(PrecisionTypesId id, Connection c) {
    return interpolate(
                Fragment.lit("delete from \"precision_types\" where \"id\" = "),
                Fragment.encode(PrecisionTypesId.duckDbType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public Integer deleteByIds(PrecisionTypesId[] ids, Connection c) {
    return interpolate(
            Fragment.lit("delete\nfrom \"precision_types\"\nwhere \"id\" = ANY("),
            Fragment.encode(PrecisionTypesId.dbTypeArray, ids),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }

  @Override
  public PrecisionTypesRow insert(PrecisionTypesRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"precision_types\"(\"id\", \"string10\", \"string20\", \"string50\","
                    + " \"string100\", \"string255\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"decimal5_0\", \"decimal10_0\", \"decimal18_0\")\n"
                    + "values ("),
            Fragment.encode(PrecisionTypesId.duckDbType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.duckDbType, unsaved.decimal52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.duckDbType, unsaved.decimal102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.duckDbType, unsaved.decimal184()),
            Fragment.lit(", "),
            Fragment.encode(Int5.duckDbType, unsaved.decimal50()),
            Fragment.lit(", "),
            Fragment.encode(Int10.duckDbType, unsaved.decimal100()),
            Fragment.lit(", "),
            Fragment.encode(Int18.duckDbType, unsaved.decimal180()),
            Fragment.lit(
                ")\n"
                    + "RETURNING \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\"\n"))
        .updateReturning(PrecisionTypesRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public SelectBuilder<PrecisionTypesFields, PrecisionTypesRow> select() {
    return SelectBuilder.of(
        "\"precision_types\"",
        PrecisionTypesFields.structure,
        PrecisionTypesRow._rowParser,
        Dialect.DUCKDB);
  }

  @Override
  public List<PrecisionTypesRow> selectAll(Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\"\n"
                    + "from \"precision_types\"\n"))
        .query(PrecisionTypesRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Optional<PrecisionTypesRow> selectById(PrecisionTypesId id, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\"\n"
                    + "from \"precision_types\"\n"
                    + "where \"id\" = "),
            Fragment.encode(PrecisionTypesId.duckDbType, id),
            Fragment.lit(""))
        .query(PrecisionTypesRow._rowParser.first())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesRow> selectByIds(PrecisionTypesId[] ids, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\"\n"
                    + "from \"precision_types\"\n"
                    + "where \"id\" = ANY("),
            Fragment.encode(PrecisionTypesId.dbTypeArray, ids),
            Fragment.lit(")"))
        .query(PrecisionTypesRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Map<PrecisionTypesId, PrecisionTypesRow> selectByIdsTracked(
      PrecisionTypesId[] ids, Connection c) {
    HashMap<PrecisionTypesId, PrecisionTypesRow> ret =
        new HashMap<PrecisionTypesId, PrecisionTypesRow>();
    selectByIds(ids, c).forEach(row -> ret.put(row.id(), row));
    return ret;
  }

  @Override
  public UpdateBuilder<PrecisionTypesFields, PrecisionTypesRow> update() {
    return UpdateBuilder.of(
        "\"precision_types\"",
        PrecisionTypesFields.structure,
        PrecisionTypesRow._rowParser,
        Dialect.DUCKDB);
  }

  @Override
  public Boolean update(PrecisionTypesRow row, Connection c) {
    PrecisionTypesId id = row.id();
    ;
    return interpolate(
                Fragment.lit("update \"precision_types\"\nset \"string10\" = "),
                Fragment.encode(DuckDbTypes.varchar, row.string10()),
                Fragment.lit(",\n\"string20\" = "),
                Fragment.encode(DuckDbTypes.varchar, row.string20()),
                Fragment.lit(",\n\"string50\" = "),
                Fragment.encode(DuckDbTypes.varchar, row.string50()),
                Fragment.lit(",\n\"string100\" = "),
                Fragment.encode(DuckDbTypes.varchar, row.string100()),
                Fragment.lit(",\n\"string255\" = "),
                Fragment.encode(DuckDbTypes.varchar, row.string255()),
                Fragment.lit(",\n\"decimal5_2\" = "),
                Fragment.encode(Decimal5_2.duckDbType, row.decimal52()),
                Fragment.lit(",\n\"decimal10_2\" = "),
                Fragment.encode(Decimal10_2.duckDbType, row.decimal102()),
                Fragment.lit(",\n\"decimal18_4\" = "),
                Fragment.encode(Decimal18_4.duckDbType, row.decimal184()),
                Fragment.lit(",\n\"decimal5_0\" = "),
                Fragment.encode(Int5.duckDbType, row.decimal50()),
                Fragment.lit(",\n\"decimal10_0\" = "),
                Fragment.encode(Int10.duckDbType, row.decimal100()),
                Fragment.lit(",\n\"decimal18_0\" = "),
                Fragment.encode(Int18.duckDbType, row.decimal180()),
                Fragment.lit("\nwhere \"id\" = "),
                Fragment.encode(PrecisionTypesId.duckDbType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public PrecisionTypesRow upsert(PrecisionTypesRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "INSERT INTO \"precision_types\"(\"id\", \"string10\", \"string20\", \"string50\","
                    + " \"string100\", \"string255\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"decimal5_0\", \"decimal10_0\", \"decimal18_0\")\n"
                    + "VALUES ("),
            Fragment.encode(PrecisionTypesId.duckDbType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(DuckDbTypes.varchar, unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.duckDbType, unsaved.decimal52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.duckDbType, unsaved.decimal102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.duckDbType, unsaved.decimal184()),
            Fragment.lit(", "),
            Fragment.encode(Int5.duckDbType, unsaved.decimal50()),
            Fragment.lit(", "),
            Fragment.encode(Int10.duckDbType, unsaved.decimal100()),
            Fragment.lit(", "),
            Fragment.encode(Int18.duckDbType, unsaved.decimal180()),
            Fragment.lit(
                ")\n"
                    + "ON CONFLICT (\"id\")\n"
                    + "DO UPDATE SET\n"
                    + "  \"string10\" = EXCLUDED.\"string10\",\n"
                    + "\"string20\" = EXCLUDED.\"string20\",\n"
                    + "\"string50\" = EXCLUDED.\"string50\",\n"
                    + "\"string100\" = EXCLUDED.\"string100\",\n"
                    + "\"string255\" = EXCLUDED.\"string255\",\n"
                    + "\"decimal5_2\" = EXCLUDED.\"decimal5_2\",\n"
                    + "\"decimal10_2\" = EXCLUDED.\"decimal10_2\",\n"
                    + "\"decimal18_4\" = EXCLUDED.\"decimal18_4\",\n"
                    + "\"decimal5_0\" = EXCLUDED.\"decimal5_0\",\n"
                    + "\"decimal10_0\" = EXCLUDED.\"decimal10_0\",\n"
                    + "\"decimal18_0\" = EXCLUDED.\"decimal18_0\"\n"
                    + "RETURNING \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\""))
        .updateReturning(PrecisionTypesRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesRow> upsertBatch(Iterator<PrecisionTypesRow> unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "INSERT INTO \"precision_types\"(\"id\", \"string10\", \"string20\", \"string50\","
                    + " \"string100\", \"string255\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"decimal5_0\", \"decimal10_0\", \"decimal18_0\")\n"
                    + "VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n"
                    + "ON CONFLICT (\"id\")\n"
                    + "DO UPDATE SET\n"
                    + "  \"string10\" = EXCLUDED.\"string10\",\n"
                    + "\"string20\" = EXCLUDED.\"string20\",\n"
                    + "\"string50\" = EXCLUDED.\"string50\",\n"
                    + "\"string100\" = EXCLUDED.\"string100\",\n"
                    + "\"string255\" = EXCLUDED.\"string255\",\n"
                    + "\"decimal5_2\" = EXCLUDED.\"decimal5_2\",\n"
                    + "\"decimal10_2\" = EXCLUDED.\"decimal10_2\",\n"
                    + "\"decimal18_4\" = EXCLUDED.\"decimal18_4\",\n"
                    + "\"decimal5_0\" = EXCLUDED.\"decimal5_0\",\n"
                    + "\"decimal10_0\" = EXCLUDED.\"decimal10_0\",\n"
                    + "\"decimal18_0\" = EXCLUDED.\"decimal18_0\"\n"
                    + "RETURNING \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"decimal5_2\", \"decimal10_2\", \"decimal18_4\","
                    + " \"decimal5_0\", \"decimal10_0\", \"decimal18_0\""))
        .updateReturningEach(PrecisionTypesRow._rowParser, unsaved)
        .runUnchecked(c);
  }
}

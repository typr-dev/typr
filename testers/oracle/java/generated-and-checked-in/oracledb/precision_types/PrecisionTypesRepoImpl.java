/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package oracledb.precision_types;

import static dev.typr.foundations.Fragment.interpolate;

import dev.typr.foundations.Fragment;
import dev.typr.foundations.OracleTypes;
import dev.typr.foundations.dsl.DeleteBuilder;
import dev.typr.foundations.dsl.Dialect;
import dev.typr.foundations.dsl.SelectBuilder;
import dev.typr.foundations.dsl.UpdateBuilder;
import java.sql.Connection;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import oracledb.precisetypes.Decimal10_2;
import oracledb.precisetypes.Decimal18_4;
import oracledb.precisetypes.Decimal5_2;
import oracledb.precisetypes.Int10;
import oracledb.precisetypes.Int18;
import oracledb.precisetypes.Int5;
import oracledb.precisetypes.LocalDateTime3;
import oracledb.precisetypes.LocalDateTime6;
import oracledb.precisetypes.LocalDateTime9;
import oracledb.precisetypes.NonEmptyPaddedString10;
import oracledb.precisetypes.NonEmptyString10;
import oracledb.precisetypes.NonEmptyString100;
import oracledb.precisetypes.NonEmptyString20;
import oracledb.precisetypes.NonEmptyString255;
import oracledb.precisetypes.NonEmptyString50;

public class PrecisionTypesRepoImpl implements PrecisionTypesRepo {
  @Override
  public DeleteBuilder<PrecisionTypesFields, PrecisionTypesRow> delete() {
    return DeleteBuilder.of("\"PRECISION_TYPES\"", PrecisionTypesFields.structure, Dialect.ORACLE);
  }

  @Override
  public Boolean deleteById(PrecisionTypesId id, Connection c) {
    return interpolate(
                Fragment.lit("delete from \"PRECISION_TYPES\" where \"ID\" = "),
                Fragment.encode(PrecisionTypesId.oracleType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public Integer deleteByIds(PrecisionTypesId[] ids, Connection c) {
    ArrayList<Fragment> fragments = new ArrayList<>();
    for (var id : ids) {
      fragments.add(Fragment.encode(PrecisionTypesId.oracleType, id));
    }
    ;
    return Fragment.interpolate(
            Fragment.lit("delete from \"PRECISION_TYPES\" where \"ID\" in ("),
            Fragment.comma(fragments),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }

  @Override
  public PrecisionTypesRow insert(PrecisionTypesRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"PRECISION_TYPES\"(\"ID\", \"STRING10\", \"STRING20\", \"STRING50\","
                    + " \"STRING100\", \"STRING255\", \"CHAR10\", \"NUMBER5_2\", \"NUMBER10_2\","
                    + " \"NUMBER18_4\", \"NUMBER5_0\", \"NUMBER10_0\", \"NUMBER18_0\", \"TS0\","
                    + " \"TS3\", \"TS6\", \"TS9\")\n"
                    + "values ("),
            Fragment.encode(PrecisionTypesId.oracleType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString10.oracleType, unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString20.oracleType, unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString50.oracleType, unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString100.oracleType, unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString255.oracleType, unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyPaddedString10.oracleType, unsaved.char10()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.oracleType, unsaved.number52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.oracleType, unsaved.number102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.oracleType, unsaved.number184()),
            Fragment.lit(", "),
            Fragment.encode(Int5.oracleType, unsaved.number50()),
            Fragment.lit(", "),
            Fragment.encode(Int10.oracleType, unsaved.number100()),
            Fragment.lit(", "),
            Fragment.encode(Int18.oracleType, unsaved.number180()),
            Fragment.lit(", "),
            Fragment.encode(OracleTypes.timestamp, unsaved.ts0()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime3.oracleType, unsaved.ts3()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime6.oracleType, unsaved.ts6()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime9.oracleType, unsaved.ts9()),
            Fragment.lit(")\n"))
        .updateReturningGeneratedKeys(
            new String[] {
              "ID",
              "STRING10",
              "STRING20",
              "STRING50",
              "STRING100",
              "STRING255",
              "CHAR10",
              "NUMBER5_2",
              "NUMBER10_2",
              "NUMBER18_4",
              "NUMBER5_0",
              "NUMBER10_0",
              "NUMBER18_0",
              "TS0",
              "TS3",
              "TS6",
              "TS9"
            },
            PrecisionTypesRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public PrecisionTypesRow insert(PrecisionTypesRowUnsaved unsaved, Connection c) {
    ArrayList<Fragment> columns = new ArrayList<>();
    ;
    ArrayList<Fragment> values = new ArrayList<>();
    ;
    columns.add(Fragment.lit("\"STRING10\""));
    values.add(
        interpolate(
            Fragment.encode(NonEmptyString10.oracleType, unsaved.string10()), Fragment.lit("")));
    columns.add(Fragment.lit("\"STRING20\""));
    values.add(
        interpolate(
            Fragment.encode(NonEmptyString20.oracleType, unsaved.string20()), Fragment.lit("")));
    columns.add(Fragment.lit("\"STRING50\""));
    values.add(
        interpolate(
            Fragment.encode(NonEmptyString50.oracleType, unsaved.string50()), Fragment.lit("")));
    columns.add(Fragment.lit("\"STRING100\""));
    values.add(
        interpolate(
            Fragment.encode(NonEmptyString100.oracleType, unsaved.string100()), Fragment.lit("")));
    columns.add(Fragment.lit("\"STRING255\""));
    values.add(
        interpolate(
            Fragment.encode(NonEmptyString255.oracleType, unsaved.string255()), Fragment.lit("")));
    columns.add(Fragment.lit("\"CHAR10\""));
    values.add(
        interpolate(
            Fragment.encode(NonEmptyPaddedString10.oracleType, unsaved.char10()),
            Fragment.lit("")));
    columns.add(Fragment.lit("\"NUMBER5_2\""));
    values.add(
        interpolate(Fragment.encode(Decimal5_2.oracleType, unsaved.number52()), Fragment.lit("")));
    columns.add(Fragment.lit("\"NUMBER10_2\""));
    values.add(
        interpolate(
            Fragment.encode(Decimal10_2.oracleType, unsaved.number102()), Fragment.lit("")));
    columns.add(Fragment.lit("\"NUMBER18_4\""));
    values.add(
        interpolate(
            Fragment.encode(Decimal18_4.oracleType, unsaved.number184()), Fragment.lit("")));
    columns.add(Fragment.lit("\"NUMBER5_0\""));
    values.add(interpolate(Fragment.encode(Int5.oracleType, unsaved.number50()), Fragment.lit("")));
    columns.add(Fragment.lit("\"NUMBER10_0\""));
    values.add(
        interpolate(Fragment.encode(Int10.oracleType, unsaved.number100()), Fragment.lit("")));
    columns.add(Fragment.lit("\"NUMBER18_0\""));
    values.add(
        interpolate(Fragment.encode(Int18.oracleType, unsaved.number180()), Fragment.lit("")));
    columns.add(Fragment.lit("\"TS0\""));
    values.add(
        interpolate(Fragment.encode(OracleTypes.timestamp, unsaved.ts0()), Fragment.lit("")));
    columns.add(Fragment.lit("\"TS3\""));
    values.add(
        interpolate(Fragment.encode(LocalDateTime3.oracleType, unsaved.ts3()), Fragment.lit("")));
    columns.add(Fragment.lit("\"TS6\""));
    values.add(
        interpolate(Fragment.encode(LocalDateTime6.oracleType, unsaved.ts6()), Fragment.lit("")));
    columns.add(Fragment.lit("\"TS9\""));
    values.add(
        interpolate(Fragment.encode(LocalDateTime9.oracleType, unsaved.ts9()), Fragment.lit("")));
    unsaved
        .id()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"ID\""));
              values.add(
                  interpolate(
                      Fragment.encode(PrecisionTypesId.oracleType, value), Fragment.lit("")));
            });
    ;
    Fragment q =
        interpolate(
            Fragment.lit("insert into \"PRECISION_TYPES\"("),
            Fragment.comma(columns),
            Fragment.lit(")\nvalues ("),
            Fragment.comma(values),
            Fragment.lit(")\n"));
    ;
    return q.updateReturningGeneratedKeys(
            new String[] {
              "ID",
              "STRING10",
              "STRING20",
              "STRING50",
              "STRING100",
              "STRING255",
              "CHAR10",
              "NUMBER5_2",
              "NUMBER10_2",
              "NUMBER18_4",
              "NUMBER5_0",
              "NUMBER10_0",
              "NUMBER18_0",
              "TS0",
              "TS3",
              "TS6",
              "TS9"
            },
            PrecisionTypesRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public SelectBuilder<PrecisionTypesFields, PrecisionTypesRow> select() {
    return SelectBuilder.of(
        "\"PRECISION_TYPES\"",
        PrecisionTypesFields.structure,
        PrecisionTypesRow._rowParser,
        Dialect.ORACLE);
  }

  @Override
  public List<PrecisionTypesRow> selectAll(Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"ID\", \"STRING10\", \"STRING20\", \"STRING50\", \"STRING100\","
                    + " \"STRING255\", \"CHAR10\", \"NUMBER5_2\", \"NUMBER10_2\", \"NUMBER18_4\","
                    + " \"NUMBER5_0\", \"NUMBER10_0\", \"NUMBER18_0\", \"TS0\", \"TS3\", \"TS6\","
                    + " \"TS9\"\n"
                    + "from \"PRECISION_TYPES\"\n"))
        .query(PrecisionTypesRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Optional<PrecisionTypesRow> selectById(PrecisionTypesId id, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"ID\", \"STRING10\", \"STRING20\", \"STRING50\", \"STRING100\","
                    + " \"STRING255\", \"CHAR10\", \"NUMBER5_2\", \"NUMBER10_2\", \"NUMBER18_4\","
                    + " \"NUMBER5_0\", \"NUMBER10_0\", \"NUMBER18_0\", \"TS0\", \"TS3\", \"TS6\","
                    + " \"TS9\"\n"
                    + "from \"PRECISION_TYPES\"\n"
                    + "where \"ID\" = "),
            Fragment.encode(PrecisionTypesId.oracleType, id),
            Fragment.lit(""))
        .query(PrecisionTypesRow._rowParser.first())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesRow> selectByIds(PrecisionTypesId[] ids, Connection c) {
    ArrayList<Fragment> fragments = new ArrayList<>();
    for (var id : ids) {
      fragments.add(Fragment.encode(PrecisionTypesId.oracleType, id));
    }
    ;
    return Fragment.interpolate(
            Fragment.lit(
                "select \"ID\", \"STRING10\", \"STRING20\", \"STRING50\", \"STRING100\","
                    + " \"STRING255\", \"CHAR10\", \"NUMBER5_2\", \"NUMBER10_2\", \"NUMBER18_4\","
                    + " \"NUMBER5_0\", \"NUMBER10_0\", \"NUMBER18_0\", \"TS0\", \"TS3\", \"TS6\","
                    + " \"TS9\" from \"PRECISION_TYPES\" where \"ID\" in ("),
            Fragment.comma(fragments),
            Fragment.lit(")"))
        .query(PrecisionTypesRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Map<PrecisionTypesId, PrecisionTypesRow> selectByIdsTracked(
      PrecisionTypesId[] ids, Connection c) {
    HashMap<PrecisionTypesId, PrecisionTypesRow> ret =
        new HashMap<PrecisionTypesId, PrecisionTypesRow>();
    selectByIds(ids, c).forEach(row -> ret.put(row.id(), row));
    return ret;
  }

  @Override
  public UpdateBuilder<PrecisionTypesFields, PrecisionTypesRow> update() {
    return UpdateBuilder.of(
        "\"PRECISION_TYPES\"",
        PrecisionTypesFields.structure,
        PrecisionTypesRow._rowParser,
        Dialect.ORACLE);
  }

  @Override
  public Boolean update(PrecisionTypesRow row, Connection c) {
    PrecisionTypesId id = row.id();
    ;
    return interpolate(
                Fragment.lit("update \"PRECISION_TYPES\"\nset \"STRING10\" = "),
                Fragment.encode(NonEmptyString10.oracleType, row.string10()),
                Fragment.lit(",\n\"STRING20\" = "),
                Fragment.encode(NonEmptyString20.oracleType, row.string20()),
                Fragment.lit(",\n\"STRING50\" = "),
                Fragment.encode(NonEmptyString50.oracleType, row.string50()),
                Fragment.lit(",\n\"STRING100\" = "),
                Fragment.encode(NonEmptyString100.oracleType, row.string100()),
                Fragment.lit(",\n\"STRING255\" = "),
                Fragment.encode(NonEmptyString255.oracleType, row.string255()),
                Fragment.lit(",\n\"CHAR10\" = "),
                Fragment.encode(NonEmptyPaddedString10.oracleType, row.char10()),
                Fragment.lit(",\n\"NUMBER5_2\" = "),
                Fragment.encode(Decimal5_2.oracleType, row.number52()),
                Fragment.lit(",\n\"NUMBER10_2\" = "),
                Fragment.encode(Decimal10_2.oracleType, row.number102()),
                Fragment.lit(",\n\"NUMBER18_4\" = "),
                Fragment.encode(Decimal18_4.oracleType, row.number184()),
                Fragment.lit(",\n\"NUMBER5_0\" = "),
                Fragment.encode(Int5.oracleType, row.number50()),
                Fragment.lit(",\n\"NUMBER10_0\" = "),
                Fragment.encode(Int10.oracleType, row.number100()),
                Fragment.lit(",\n\"NUMBER18_0\" = "),
                Fragment.encode(Int18.oracleType, row.number180()),
                Fragment.lit(",\n\"TS0\" = "),
                Fragment.encode(OracleTypes.timestamp, row.ts0()),
                Fragment.lit(",\n\"TS3\" = "),
                Fragment.encode(LocalDateTime3.oracleType, row.ts3()),
                Fragment.lit(",\n\"TS6\" = "),
                Fragment.encode(LocalDateTime6.oracleType, row.ts6()),
                Fragment.lit(",\n\"TS9\" = "),
                Fragment.encode(LocalDateTime9.oracleType, row.ts9()),
                Fragment.lit("\nwhere \"ID\" = "),
                Fragment.encode(PrecisionTypesId.oracleType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public void upsert(PrecisionTypesRow unsaved, Connection c) {
    interpolate(
            Fragment.lit("MERGE INTO \"PRECISION_TYPES\" t\nUSING (SELECT "),
            Fragment.encode(PrecisionTypesId.oracleType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString10.oracleType, unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString20.oracleType, unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString50.oracleType, unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString100.oracleType, unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString255.oracleType, unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyPaddedString10.oracleType, unsaved.char10()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.oracleType, unsaved.number52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.oracleType, unsaved.number102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.oracleType, unsaved.number184()),
            Fragment.lit(", "),
            Fragment.encode(Int5.oracleType, unsaved.number50()),
            Fragment.lit(", "),
            Fragment.encode(Int10.oracleType, unsaved.number100()),
            Fragment.lit(", "),
            Fragment.encode(Int18.oracleType, unsaved.number180()),
            Fragment.lit(", "),
            Fragment.encode(OracleTypes.timestamp, unsaved.ts0()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime3.oracleType, unsaved.ts3()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime6.oracleType, unsaved.ts6()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime9.oracleType, unsaved.ts9()),
            Fragment.lit(
                " FROM DUAL) s\n"
                    + "ON (t.\"ID\" = s.\"ID\")\n"
                    + "WHEN MATCHED THEN UPDATE SET t.\"STRING10\" = s.\"STRING10\",\n"
                    + "t.\"STRING20\" = s.\"STRING20\",\n"
                    + "t.\"STRING50\" = s.\"STRING50\",\n"
                    + "t.\"STRING100\" = s.\"STRING100\",\n"
                    + "t.\"STRING255\" = s.\"STRING255\",\n"
                    + "t.\"CHAR10\" = s.\"CHAR10\",\n"
                    + "t.\"NUMBER5_2\" = s.\"NUMBER5_2\",\n"
                    + "t.\"NUMBER10_2\" = s.\"NUMBER10_2\",\n"
                    + "t.\"NUMBER18_4\" = s.\"NUMBER18_4\",\n"
                    + "t.\"NUMBER5_0\" = s.\"NUMBER5_0\",\n"
                    + "t.\"NUMBER10_0\" = s.\"NUMBER10_0\",\n"
                    + "t.\"NUMBER18_0\" = s.\"NUMBER18_0\",\n"
                    + "t.\"TS0\" = s.\"TS0\",\n"
                    + "t.\"TS3\" = s.\"TS3\",\n"
                    + "t.\"TS6\" = s.\"TS6\",\n"
                    + "t.\"TS9\" = s.\"TS9\"\n"
                    + "WHEN NOT MATCHED THEN INSERT (\"ID\", \"STRING10\", \"STRING20\","
                    + " \"STRING50\", \"STRING100\", \"STRING255\", \"CHAR10\", \"NUMBER5_2\","
                    + " \"NUMBER10_2\", \"NUMBER18_4\", \"NUMBER5_0\", \"NUMBER10_0\","
                    + " \"NUMBER18_0\", \"TS0\", \"TS3\", \"TS6\", \"TS9\") VALUES ("),
            Fragment.encode(PrecisionTypesId.oracleType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString10.oracleType, unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString20.oracleType, unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString50.oracleType, unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString100.oracleType, unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyString255.oracleType, unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(NonEmptyPaddedString10.oracleType, unsaved.char10()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.oracleType, unsaved.number52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.oracleType, unsaved.number102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.oracleType, unsaved.number184()),
            Fragment.lit(", "),
            Fragment.encode(Int5.oracleType, unsaved.number50()),
            Fragment.lit(", "),
            Fragment.encode(Int10.oracleType, unsaved.number100()),
            Fragment.lit(", "),
            Fragment.encode(Int18.oracleType, unsaved.number180()),
            Fragment.lit(", "),
            Fragment.encode(OracleTypes.timestamp, unsaved.ts0()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime3.oracleType, unsaved.ts3()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime6.oracleType, unsaved.ts6()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime9.oracleType, unsaved.ts9()),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }

  @Override
  public void upsertBatch(Iterator<PrecisionTypesRow> unsaved, Connection c) {
    interpolate(
            Fragment.lit(
                "MERGE INTO \"PRECISION_TYPES\" t\n"
                    + "USING (SELECT ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? FROM DUAL)"
                    + " s\n"
                    + "ON (t.\"ID\" = s.\"ID\")\n"
                    + "WHEN MATCHED THEN UPDATE SET t.\"STRING10\" = s.\"STRING10\",\n"
                    + "t.\"STRING20\" = s.\"STRING20\",\n"
                    + "t.\"STRING50\" = s.\"STRING50\",\n"
                    + "t.\"STRING100\" = s.\"STRING100\",\n"
                    + "t.\"STRING255\" = s.\"STRING255\",\n"
                    + "t.\"CHAR10\" = s.\"CHAR10\",\n"
                    + "t.\"NUMBER5_2\" = s.\"NUMBER5_2\",\n"
                    + "t.\"NUMBER10_2\" = s.\"NUMBER10_2\",\n"
                    + "t.\"NUMBER18_4\" = s.\"NUMBER18_4\",\n"
                    + "t.\"NUMBER5_0\" = s.\"NUMBER5_0\",\n"
                    + "t.\"NUMBER10_0\" = s.\"NUMBER10_0\",\n"
                    + "t.\"NUMBER18_0\" = s.\"NUMBER18_0\",\n"
                    + "t.\"TS0\" = s.\"TS0\",\n"
                    + "t.\"TS3\" = s.\"TS3\",\n"
                    + "t.\"TS6\" = s.\"TS6\",\n"
                    + "t.\"TS9\" = s.\"TS9\"\n"
                    + "WHEN NOT MATCHED THEN INSERT (\"ID\", \"STRING10\", \"STRING20\","
                    + " \"STRING50\", \"STRING100\", \"STRING255\", \"CHAR10\", \"NUMBER5_2\","
                    + " \"NUMBER10_2\", \"NUMBER18_4\", \"NUMBER5_0\", \"NUMBER10_0\","
                    + " \"NUMBER18_0\", \"TS0\", \"TS3\", \"TS6\", \"TS9\") VALUES (?, ?, ?, ?, ?,"
                    + " ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"))
        .updateMany(PrecisionTypesRow._rowParser, unsaved)
        .runUnchecked(c);
  }
}

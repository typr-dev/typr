/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.person_detail;

import adventureworks.person.businessentity.BusinessentityId;
import java.sql.Connection;
import java.time.LocalDateTime;
import java.util.List;
import typr.runtime.Fragment;
import typr.runtime.PgTypes;
import static typr.runtime.Fragment.interpolate;

public class PersonDetailSqlRepoImpl implements PersonDetailSqlRepo {
  @Override
  public List<PersonDetailSqlRow> apply(
    /* user-picked */ BusinessentityId businessentityid,
    LocalDateTime modifiedAfter,
    Connection c
  ) {
    return interpolate(Fragment.lit("SELECT s.businessentityid,\n       p.title,\n       p.firstname,\n       p.middlename,\n       p.lastname,\n       e.jobtitle,\n       a.addressline1,\n       a.city,\n       a.postalcode,\n       a.rowguid\nFROM sales.salesperson s\n         JOIN humanresources.employee e ON e.businessentityid = s.businessentityid\n         JOIN person.person p ON p.businessentityid = s.businessentityid\n         JOIN person.businessentityaddress bea ON bea.businessentityid = s.businessentityid\n         LEFT JOIN person.address a ON a.addressid = bea.addressid\nwhere s.businessentityid = "), Fragment.encode(BusinessentityId.pgType, businessentityid), Fragment.lit("::int4\n  and p.modifieddate > "), Fragment.encode(PgTypes.timestamp, modifiedAfter), Fragment.lit("::timestamp")).query(PersonDetailSqlRow._rowParser.all()).runUnchecked(c);
  };
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.public_.identity_test;

import adventureworks.customtypes.Defaulted;
import adventureworks.customtypes.Defaulted.UseDefault;
import com.fasterxml.jackson.annotation.JsonProperty;
import typr.runtime.PgText;
import typr.runtime.PgTypes;

/** This class corresponds to a row in table `public.identity-test` which has not been persisted yet */
public record IdentityTestRowUnsaved(
  IdentityTestId name,
  /** Identity BY DEFAULT, identityStart: 1, identityIncrement: 1, identityMaximum: 2147483647, identityMinimum: 1 */
  @JsonProperty("default_generated") Defaulted<Integer> defaultGenerated
) {
  public IdentityTestRowUnsaved(IdentityTestId name) {
    this(name, new UseDefault<>());
  };

  public IdentityTestRowUnsaved withName(IdentityTestId name) {
    return new IdentityTestRowUnsaved(name, defaultGenerated);
  };

  /** Identity BY DEFAULT, identityStart: 1, identityIncrement: 1, identityMaximum: 2147483647, identityMinimum: 1 */
  public IdentityTestRowUnsaved withDefaultGenerated(Defaulted<Integer> defaultGenerated) {
    return new IdentityTestRowUnsaved(name, defaultGenerated);
  };

  static public PgText<IdentityTestRowUnsaved> pgText =
    PgText.instance((row, sb) -> {
      IdentityTestId.pgType.pgText().unsafeEncode(row.name, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(PgTypes.int4.pgText()).unsafeEncode(row.defaultGenerated, sb);
    });

  public IdentityTestRow toRow(
    java.util.function.Supplier<Integer> defaultGeneratedDefault,
    java.util.function.Supplier<Integer> alwaysGeneratedDefault
  ) {
    return new IdentityTestRow(alwaysGeneratedDefault.get(), defaultGenerated.getOrElse(defaultGeneratedDefault), name);
  };
}
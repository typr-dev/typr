/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.public_.precision_types;

import static dev.typr.foundations.Fragment.interpolate;

import adventureworks.precisetypes.PaddedString10;
import adventureworks.precisetypes.PaddedString3;
import adventureworks.precisetypes.String10;
import adventureworks.precisetypes.String100;
import adventureworks.precisetypes.String20;
import adventureworks.precisetypes.String255;
import adventureworks.precisetypes.String50;
import dev.typr.foundations.Fragment;
import dev.typr.foundations.PgTypes;
import dev.typr.foundations.dsl.DeleteBuilder;
import dev.typr.foundations.dsl.Dialect;
import dev.typr.foundations.dsl.SelectBuilder;
import dev.typr.foundations.dsl.UpdateBuilder;
import dev.typr.foundations.streamingInsert;
import java.sql.Connection;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;

public class PrecisionTypesRepoImpl implements PrecisionTypesRepo {
  @Override
  public DeleteBuilder<PrecisionTypesFields, PrecisionTypesRow> delete() {
    return DeleteBuilder.of(
        "\"public\".\"precision_types\"", PrecisionTypesFields.structure, Dialect.POSTGRESQL);
  }

  @Override
  public Boolean deleteById(PrecisionTypesId id, Connection c) {
    return interpolate(
                Fragment.lit("delete from \"public\".\"precision_types\" where \"id\" = "),
                Fragment.encode(PrecisionTypesId.dbType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public Integer deleteByIds(PrecisionTypesId[] ids, Connection c) {
    return interpolate(
            Fragment.lit("delete\nfrom \"public\".\"precision_types\"\nwhere \"id\" = ANY("),
            Fragment.encode(PrecisionTypesId.dbTypeArray, ids),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }

  @Override
  public PrecisionTypesRow insert(PrecisionTypesRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"public\".\"precision_types\"(\"id\", \"string10\", \"string20\","
                    + " \"string50\", \"string100\", \"string255\", \"bpchar3\", \"bpchar10\","
                    + " \"decimal5_2\", \"decimal10_2\", \"decimal18_4\", \"numeric8_2\","
                    + " \"numeric12_4\", \"timestamp0\", \"timestamp3\", \"timestamp6\","
                    + " \"timestamptz0\", \"timestamptz3\", \"timestamptz6\", \"time0\", \"time3\","
                    + " \"time6\", \"timetz0\", \"timetz3\", \"timetz6\")\n"
                    + "values ("),
            Fragment.encode(PrecisionTypesId.dbType, unsaved.id()),
            Fragment.lit("::int4, "),
            Fragment.encode(String10.dbType, unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(String20.dbType, unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(String50.dbType, unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(String100.dbType, unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(String255.dbType, unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(PaddedString3.dbType, unsaved.bpchar3()),
            Fragment.lit("::bpchar, "),
            Fragment.encode(PaddedString10.dbType, unsaved.bpchar10()),
            Fragment.lit("::bpchar, "),
            Fragment.encode(PgTypes.numeric, unsaved.decimal52()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.decimal102()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.decimal184()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.numeric82()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.numeric124()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp0()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp3()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp6()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz0()),
            Fragment.lit("::timestamptz, "),
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz3()),
            Fragment.lit("::timestamptz, "),
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz6()),
            Fragment.lit("::timestamptz, "),
            Fragment.encode(PgTypes.time, unsaved.time0()),
            Fragment.lit("::time, "),
            Fragment.encode(PgTypes.time, unsaved.time3()),
            Fragment.lit("::time, "),
            Fragment.encode(PgTypes.time, unsaved.time6()),
            Fragment.lit("::time, "),
            Fragment.encode(PgTypes.timetz, unsaved.timetz0()),
            Fragment.lit("::timetz, "),
            Fragment.encode(PgTypes.timetz, unsaved.timetz3()),
            Fragment.lit("::timetz, "),
            Fragment.encode(PgTypes.timetz, unsaved.timetz6()),
            Fragment.lit(
                "::timetz)\n"
                    + "RETURNING \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
                    + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
                    + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\","
                    + " \"timetz3\", \"timetz6\"\n"))
        .updateReturning(PrecisionTypesRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public PrecisionTypesRow insert(PrecisionTypesRowUnsaved unsaved, Connection c) {
    ArrayList<Fragment> columns = new ArrayList<>();
    ;
    ArrayList<Fragment> values = new ArrayList<>();
    ;
    columns.add(Fragment.lit("\"string10\""));
    values.add(interpolate(Fragment.encode(String10.dbType, unsaved.string10()), Fragment.lit("")));
    columns.add(Fragment.lit("\"string20\""));
    values.add(interpolate(Fragment.encode(String20.dbType, unsaved.string20()), Fragment.lit("")));
    columns.add(Fragment.lit("\"string50\""));
    values.add(interpolate(Fragment.encode(String50.dbType, unsaved.string50()), Fragment.lit("")));
    columns.add(Fragment.lit("\"string100\""));
    values.add(
        interpolate(Fragment.encode(String100.dbType, unsaved.string100()), Fragment.lit("")));
    columns.add(Fragment.lit("\"string255\""));
    values.add(
        interpolate(Fragment.encode(String255.dbType, unsaved.string255()), Fragment.lit("")));
    columns.add(Fragment.lit("\"bpchar3\""));
    values.add(
        interpolate(
            Fragment.encode(PaddedString3.dbType, unsaved.bpchar3()), Fragment.lit("::bpchar")));
    columns.add(Fragment.lit("\"bpchar10\""));
    values.add(
        interpolate(
            Fragment.encode(PaddedString10.dbType, unsaved.bpchar10()), Fragment.lit("::bpchar")));
    columns.add(Fragment.lit("\"decimal5_2\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.numeric, unsaved.decimal52()), Fragment.lit("::numeric")));
    columns.add(Fragment.lit("\"decimal10_2\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.numeric, unsaved.decimal102()), Fragment.lit("::numeric")));
    columns.add(Fragment.lit("\"decimal18_4\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.numeric, unsaved.decimal184()), Fragment.lit("::numeric")));
    columns.add(Fragment.lit("\"numeric8_2\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.numeric, unsaved.numeric82()), Fragment.lit("::numeric")));
    columns.add(Fragment.lit("\"numeric12_4\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.numeric, unsaved.numeric124()), Fragment.lit("::numeric")));
    columns.add(Fragment.lit("\"timestamp0\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp0()), Fragment.lit("::timestamp")));
    columns.add(Fragment.lit("\"timestamp3\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp3()), Fragment.lit("::timestamp")));
    columns.add(Fragment.lit("\"timestamp6\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp6()), Fragment.lit("::timestamp")));
    columns.add(Fragment.lit("\"timestamptz0\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz0()),
            Fragment.lit("::timestamptz")));
    columns.add(Fragment.lit("\"timestamptz3\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz3()),
            Fragment.lit("::timestamptz")));
    columns.add(Fragment.lit("\"timestamptz6\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz6()),
            Fragment.lit("::timestamptz")));
    columns.add(Fragment.lit("\"time0\""));
    values.add(interpolate(Fragment.encode(PgTypes.time, unsaved.time0()), Fragment.lit("::time")));
    columns.add(Fragment.lit("\"time3\""));
    values.add(interpolate(Fragment.encode(PgTypes.time, unsaved.time3()), Fragment.lit("::time")));
    columns.add(Fragment.lit("\"time6\""));
    values.add(interpolate(Fragment.encode(PgTypes.time, unsaved.time6()), Fragment.lit("::time")));
    columns.add(Fragment.lit("\"timetz0\""));
    values.add(
        interpolate(Fragment.encode(PgTypes.timetz, unsaved.timetz0()), Fragment.lit("::timetz")));
    columns.add(Fragment.lit("\"timetz3\""));
    values.add(
        interpolate(Fragment.encode(PgTypes.timetz, unsaved.timetz3()), Fragment.lit("::timetz")));
    columns.add(Fragment.lit("\"timetz6\""));
    values.add(
        interpolate(Fragment.encode(PgTypes.timetz, unsaved.timetz6()), Fragment.lit("::timetz")));
    unsaved
        .id()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"id\""));
              values.add(
                  interpolate(
                      Fragment.encode(PrecisionTypesId.dbType, value), Fragment.lit("::int4")));
            });
    ;
    Fragment q =
        interpolate(
            Fragment.lit("insert into \"public\".\"precision_types\"("),
            Fragment.comma(columns),
            Fragment.lit(")\nvalues ("),
            Fragment.comma(values),
            Fragment.lit(
                ")\n"
                    + "RETURNING \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
                    + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
                    + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\","
                    + " \"timetz3\", \"timetz6\"\n"));
    ;
    return q.updateReturning(PrecisionTypesRow._rowParser.exactlyOne()).runUnchecked(c);
  }

  @Override
  public Long insertStreaming(
      Iterator<PrecisionTypesRow> unsaved, Integer batchSize, Connection c) {
    return streamingInsert.insertUnchecked(
        "COPY \"public\".\"precision_types\"(\"id\", \"string10\", \"string20\", \"string50\","
            + " \"string100\", \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\","
            + " \"decimal10_2\", \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
            + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
            + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\", \"timetz3\","
            + " \"timetz6\") FROM STDIN",
        batchSize,
        unsaved,
        c,
        PrecisionTypesRow.pgText);
  }

  /** NOTE: this functionality requires PostgreSQL 16 or later! */
  @Override
  public Long insertUnsavedStreaming(
      Iterator<PrecisionTypesRowUnsaved> unsaved, Integer batchSize, Connection c) {
    return streamingInsert.insertUnchecked(
        "COPY \"public\".\"precision_types\"(\"string10\", \"string20\", \"string50\","
            + " \"string100\", \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\","
            + " \"decimal10_2\", \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
            + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
            + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\", \"timetz3\","
            + " \"timetz6\", \"id\") FROM STDIN (DEFAULT '__DEFAULT_VALUE__')",
        batchSize,
        unsaved,
        c,
        PrecisionTypesRowUnsaved.pgText);
  }

  @Override
  public SelectBuilder<PrecisionTypesFields, PrecisionTypesRow> select() {
    return SelectBuilder.of(
        "\"public\".\"precision_types\"",
        PrecisionTypesFields.structure,
        PrecisionTypesRow._rowParser,
        Dialect.POSTGRESQL);
  }

  @Override
  public List<PrecisionTypesRow> selectAll(Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
                    + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
                    + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\","
                    + " \"timetz3\", \"timetz6\"\n"
                    + "from \"public\".\"precision_types\"\n"))
        .query(PrecisionTypesRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Optional<PrecisionTypesRow> selectById(PrecisionTypesId id, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
                    + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
                    + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\","
                    + " \"timetz3\", \"timetz6\"\n"
                    + "from \"public\".\"precision_types\"\n"
                    + "where \"id\" = "),
            Fragment.encode(PrecisionTypesId.dbType, id),
            Fragment.lit(""))
        .query(PrecisionTypesRow._rowParser.first())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesRow> selectByIds(PrecisionTypesId[] ids, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
                    + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
                    + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\","
                    + " \"timetz3\", \"timetz6\"\n"
                    + "from \"public\".\"precision_types\"\n"
                    + "where \"id\" = ANY("),
            Fragment.encode(PrecisionTypesId.dbTypeArray, ids),
            Fragment.lit(")"))
        .query(PrecisionTypesRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Map<PrecisionTypesId, PrecisionTypesRow> selectByIdsTracked(
      PrecisionTypesId[] ids, Connection c) {
    HashMap<PrecisionTypesId, PrecisionTypesRow> ret =
        new HashMap<PrecisionTypesId, PrecisionTypesRow>();
    selectByIds(ids, c).forEach(row -> ret.put(row.id(), row));
    return ret;
  }

  @Override
  public UpdateBuilder<PrecisionTypesFields, PrecisionTypesRow> update() {
    return UpdateBuilder.of(
        "\"public\".\"precision_types\"",
        PrecisionTypesFields.structure,
        PrecisionTypesRow._rowParser,
        Dialect.POSTGRESQL);
  }

  @Override
  public Boolean update(PrecisionTypesRow row, Connection c) {
    PrecisionTypesId id = row.id();
    ;
    return interpolate(
                Fragment.lit("update \"public\".\"precision_types\"\nset \"string10\" = "),
                Fragment.encode(String10.dbType, row.string10()),
                Fragment.lit(",\n\"string20\" = "),
                Fragment.encode(String20.dbType, row.string20()),
                Fragment.lit(",\n\"string50\" = "),
                Fragment.encode(String50.dbType, row.string50()),
                Fragment.lit(",\n\"string100\" = "),
                Fragment.encode(String100.dbType, row.string100()),
                Fragment.lit(",\n\"string255\" = "),
                Fragment.encode(String255.dbType, row.string255()),
                Fragment.lit(",\n\"bpchar3\" = "),
                Fragment.encode(PaddedString3.dbType, row.bpchar3()),
                Fragment.lit("::bpchar,\n\"bpchar10\" = "),
                Fragment.encode(PaddedString10.dbType, row.bpchar10()),
                Fragment.lit("::bpchar,\n\"decimal5_2\" = "),
                Fragment.encode(PgTypes.numeric, row.decimal52()),
                Fragment.lit("::numeric,\n\"decimal10_2\" = "),
                Fragment.encode(PgTypes.numeric, row.decimal102()),
                Fragment.lit("::numeric,\n\"decimal18_4\" = "),
                Fragment.encode(PgTypes.numeric, row.decimal184()),
                Fragment.lit("::numeric,\n\"numeric8_2\" = "),
                Fragment.encode(PgTypes.numeric, row.numeric82()),
                Fragment.lit("::numeric,\n\"numeric12_4\" = "),
                Fragment.encode(PgTypes.numeric, row.numeric124()),
                Fragment.lit("::numeric,\n\"timestamp0\" = "),
                Fragment.encode(PgTypes.timestamp, row.timestamp0()),
                Fragment.lit("::timestamp,\n\"timestamp3\" = "),
                Fragment.encode(PgTypes.timestamp, row.timestamp3()),
                Fragment.lit("::timestamp,\n\"timestamp6\" = "),
                Fragment.encode(PgTypes.timestamp, row.timestamp6()),
                Fragment.lit("::timestamp,\n\"timestamptz0\" = "),
                Fragment.encode(PgTypes.timestamptz, row.timestamptz0()),
                Fragment.lit("::timestamptz,\n\"timestamptz3\" = "),
                Fragment.encode(PgTypes.timestamptz, row.timestamptz3()),
                Fragment.lit("::timestamptz,\n\"timestamptz6\" = "),
                Fragment.encode(PgTypes.timestamptz, row.timestamptz6()),
                Fragment.lit("::timestamptz,\n\"time0\" = "),
                Fragment.encode(PgTypes.time, row.time0()),
                Fragment.lit("::time,\n\"time3\" = "),
                Fragment.encode(PgTypes.time, row.time3()),
                Fragment.lit("::time,\n\"time6\" = "),
                Fragment.encode(PgTypes.time, row.time6()),
                Fragment.lit("::time,\n\"timetz0\" = "),
                Fragment.encode(PgTypes.timetz, row.timetz0()),
                Fragment.lit("::timetz,\n\"timetz3\" = "),
                Fragment.encode(PgTypes.timetz, row.timetz3()),
                Fragment.lit("::timetz,\n\"timetz6\" = "),
                Fragment.encode(PgTypes.timetz, row.timetz6()),
                Fragment.lit("::timetz\nwhere \"id\" = "),
                Fragment.encode(PrecisionTypesId.dbType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public PrecisionTypesRow upsert(PrecisionTypesRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"public\".\"precision_types\"(\"id\", \"string10\", \"string20\","
                    + " \"string50\", \"string100\", \"string255\", \"bpchar3\", \"bpchar10\","
                    + " \"decimal5_2\", \"decimal10_2\", \"decimal18_4\", \"numeric8_2\","
                    + " \"numeric12_4\", \"timestamp0\", \"timestamp3\", \"timestamp6\","
                    + " \"timestamptz0\", \"timestamptz3\", \"timestamptz6\", \"time0\", \"time3\","
                    + " \"time6\", \"timetz0\", \"timetz3\", \"timetz6\")\n"
                    + "values ("),
            Fragment.encode(PrecisionTypesId.dbType, unsaved.id()),
            Fragment.lit("::int4, "),
            Fragment.encode(String10.dbType, unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(String20.dbType, unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(String50.dbType, unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(String100.dbType, unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(String255.dbType, unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(PaddedString3.dbType, unsaved.bpchar3()),
            Fragment.lit("::bpchar, "),
            Fragment.encode(PaddedString10.dbType, unsaved.bpchar10()),
            Fragment.lit("::bpchar, "),
            Fragment.encode(PgTypes.numeric, unsaved.decimal52()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.decimal102()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.decimal184()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.numeric82()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.numeric124()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp0()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp3()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamp, unsaved.timestamp6()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz0()),
            Fragment.lit("::timestamptz, "),
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz3()),
            Fragment.lit("::timestamptz, "),
            Fragment.encode(PgTypes.timestamptz, unsaved.timestamptz6()),
            Fragment.lit("::timestamptz, "),
            Fragment.encode(PgTypes.time, unsaved.time0()),
            Fragment.lit("::time, "),
            Fragment.encode(PgTypes.time, unsaved.time3()),
            Fragment.lit("::time, "),
            Fragment.encode(PgTypes.time, unsaved.time6()),
            Fragment.lit("::time, "),
            Fragment.encode(PgTypes.timetz, unsaved.timetz0()),
            Fragment.lit("::timetz, "),
            Fragment.encode(PgTypes.timetz, unsaved.timetz3()),
            Fragment.lit("::timetz, "),
            Fragment.encode(PgTypes.timetz, unsaved.timetz6()),
            Fragment.lit(
                "::timetz)\n"
                    + "on conflict (\"id\")\n"
                    + "do update set\n"
                    + "  \"string10\" = EXCLUDED.\"string10\",\n"
                    + "\"string20\" = EXCLUDED.\"string20\",\n"
                    + "\"string50\" = EXCLUDED.\"string50\",\n"
                    + "\"string100\" = EXCLUDED.\"string100\",\n"
                    + "\"string255\" = EXCLUDED.\"string255\",\n"
                    + "\"bpchar3\" = EXCLUDED.\"bpchar3\",\n"
                    + "\"bpchar10\" = EXCLUDED.\"bpchar10\",\n"
                    + "\"decimal5_2\" = EXCLUDED.\"decimal5_2\",\n"
                    + "\"decimal10_2\" = EXCLUDED.\"decimal10_2\",\n"
                    + "\"decimal18_4\" = EXCLUDED.\"decimal18_4\",\n"
                    + "\"numeric8_2\" = EXCLUDED.\"numeric8_2\",\n"
                    + "\"numeric12_4\" = EXCLUDED.\"numeric12_4\",\n"
                    + "\"timestamp0\" = EXCLUDED.\"timestamp0\",\n"
                    + "\"timestamp3\" = EXCLUDED.\"timestamp3\",\n"
                    + "\"timestamp6\" = EXCLUDED.\"timestamp6\",\n"
                    + "\"timestamptz0\" = EXCLUDED.\"timestamptz0\",\n"
                    + "\"timestamptz3\" = EXCLUDED.\"timestamptz3\",\n"
                    + "\"timestamptz6\" = EXCLUDED.\"timestamptz6\",\n"
                    + "\"time0\" = EXCLUDED.\"time0\",\n"
                    + "\"time3\" = EXCLUDED.\"time3\",\n"
                    + "\"time6\" = EXCLUDED.\"time6\",\n"
                    + "\"timetz0\" = EXCLUDED.\"timetz0\",\n"
                    + "\"timetz3\" = EXCLUDED.\"timetz3\",\n"
                    + "\"timetz6\" = EXCLUDED.\"timetz6\"\n"
                    + "returning \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
                    + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
                    + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\","
                    + " \"timetz3\", \"timetz6\""))
        .updateReturning(PrecisionTypesRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesRow> upsertBatch(Iterator<PrecisionTypesRow> unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"public\".\"precision_types\"(\"id\", \"string10\", \"string20\","
                    + " \"string50\", \"string100\", \"string255\", \"bpchar3\", \"bpchar10\","
                    + " \"decimal5_2\", \"decimal10_2\", \"decimal18_4\", \"numeric8_2\","
                    + " \"numeric12_4\", \"timestamp0\", \"timestamp3\", \"timestamp6\","
                    + " \"timestamptz0\", \"timestamptz3\", \"timestamptz6\", \"time0\", \"time3\","
                    + " \"time6\", \"timetz0\", \"timetz3\", \"timetz6\")\n"
                    + "values (?::int4, ?, ?, ?, ?, ?, ?::bpchar, ?::bpchar, ?::numeric,"
                    + " ?::numeric, ?::numeric, ?::numeric, ?::numeric, ?::timestamp, ?::timestamp,"
                    + " ?::timestamp, ?::timestamptz, ?::timestamptz, ?::timestamptz, ?::time,"
                    + " ?::time, ?::time, ?::timetz, ?::timetz, ?::timetz)\n"
                    + "on conflict (\"id\")\n"
                    + "do update set\n"
                    + "  \"string10\" = EXCLUDED.\"string10\",\n"
                    + "\"string20\" = EXCLUDED.\"string20\",\n"
                    + "\"string50\" = EXCLUDED.\"string50\",\n"
                    + "\"string100\" = EXCLUDED.\"string100\",\n"
                    + "\"string255\" = EXCLUDED.\"string255\",\n"
                    + "\"bpchar3\" = EXCLUDED.\"bpchar3\",\n"
                    + "\"bpchar10\" = EXCLUDED.\"bpchar10\",\n"
                    + "\"decimal5_2\" = EXCLUDED.\"decimal5_2\",\n"
                    + "\"decimal10_2\" = EXCLUDED.\"decimal10_2\",\n"
                    + "\"decimal18_4\" = EXCLUDED.\"decimal18_4\",\n"
                    + "\"numeric8_2\" = EXCLUDED.\"numeric8_2\",\n"
                    + "\"numeric12_4\" = EXCLUDED.\"numeric12_4\",\n"
                    + "\"timestamp0\" = EXCLUDED.\"timestamp0\",\n"
                    + "\"timestamp3\" = EXCLUDED.\"timestamp3\",\n"
                    + "\"timestamp6\" = EXCLUDED.\"timestamp6\",\n"
                    + "\"timestamptz0\" = EXCLUDED.\"timestamptz0\",\n"
                    + "\"timestamptz3\" = EXCLUDED.\"timestamptz3\",\n"
                    + "\"timestamptz6\" = EXCLUDED.\"timestamptz6\",\n"
                    + "\"time0\" = EXCLUDED.\"time0\",\n"
                    + "\"time3\" = EXCLUDED.\"time3\",\n"
                    + "\"time6\" = EXCLUDED.\"time6\",\n"
                    + "\"timetz0\" = EXCLUDED.\"timetz0\",\n"
                    + "\"timetz3\" = EXCLUDED.\"timetz3\",\n"
                    + "\"timetz6\" = EXCLUDED.\"timetz6\"\n"
                    + "returning \"id\", \"string10\", \"string20\", \"string50\", \"string100\","
                    + " \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\", \"decimal10_2\","
                    + " \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\","
                    + " \"timestamp3\", \"timestamp6\", \"timestamptz0\", \"timestamptz3\","
                    + " \"timestamptz6\", \"time0\", \"time3\", \"time6\", \"timetz0\","
                    + " \"timetz3\", \"timetz6\""))
        .updateManyReturning(PrecisionTypesRow._rowParser, unsaved)
        .runUnchecked(c);
  }

  /** NOTE: this functionality is not safe if you use auto-commit mode! it runs 3 SQL statements */
  @Override
  public Integer upsertStreaming(
      Iterator<PrecisionTypesRow> unsaved, Integer batchSize, Connection c) {
    interpolate(
            Fragment.lit(
                "create temporary table precision_types_TEMP (like \"public\".\"precision_types\")"
                    + " on commit drop"))
        .update()
        .runUnchecked(c);
    streamingInsert.insertUnchecked(
        "copy precision_types_TEMP(\"id\", \"string10\", \"string20\", \"string50\", \"string100\","
            + " \"string255\", \"bpchar3\", \"bpchar10\", \"decimal5_2\", \"decimal10_2\","
            + " \"decimal18_4\", \"numeric8_2\", \"numeric12_4\", \"timestamp0\", \"timestamp3\","
            + " \"timestamp6\", \"timestamptz0\", \"timestamptz3\", \"timestamptz6\", \"time0\","
            + " \"time3\", \"time6\", \"timetz0\", \"timetz3\", \"timetz6\") from stdin",
        batchSize,
        unsaved,
        c,
        PrecisionTypesRow.pgText);
    return interpolate(
            Fragment.lit(
                "insert into \"public\".\"precision_types\"(\"id\", \"string10\", \"string20\","
                    + " \"string50\", \"string100\", \"string255\", \"bpchar3\", \"bpchar10\","
                    + " \"decimal5_2\", \"decimal10_2\", \"decimal18_4\", \"numeric8_2\","
                    + " \"numeric12_4\", \"timestamp0\", \"timestamp3\", \"timestamp6\","
                    + " \"timestamptz0\", \"timestamptz3\", \"timestamptz6\", \"time0\", \"time3\","
                    + " \"time6\", \"timetz0\", \"timetz3\", \"timetz6\")\n"
                    + "select * from precision_types_TEMP\n"
                    + "on conflict (\"id\")\n"
                    + "do update set\n"
                    + "  \"string10\" = EXCLUDED.\"string10\",\n"
                    + "\"string20\" = EXCLUDED.\"string20\",\n"
                    + "\"string50\" = EXCLUDED.\"string50\",\n"
                    + "\"string100\" = EXCLUDED.\"string100\",\n"
                    + "\"string255\" = EXCLUDED.\"string255\",\n"
                    + "\"bpchar3\" = EXCLUDED.\"bpchar3\",\n"
                    + "\"bpchar10\" = EXCLUDED.\"bpchar10\",\n"
                    + "\"decimal5_2\" = EXCLUDED.\"decimal5_2\",\n"
                    + "\"decimal10_2\" = EXCLUDED.\"decimal10_2\",\n"
                    + "\"decimal18_4\" = EXCLUDED.\"decimal18_4\",\n"
                    + "\"numeric8_2\" = EXCLUDED.\"numeric8_2\",\n"
                    + "\"numeric12_4\" = EXCLUDED.\"numeric12_4\",\n"
                    + "\"timestamp0\" = EXCLUDED.\"timestamp0\",\n"
                    + "\"timestamp3\" = EXCLUDED.\"timestamp3\",\n"
                    + "\"timestamp6\" = EXCLUDED.\"timestamp6\",\n"
                    + "\"timestamptz0\" = EXCLUDED.\"timestamptz0\",\n"
                    + "\"timestamptz3\" = EXCLUDED.\"timestamptz3\",\n"
                    + "\"timestamptz6\" = EXCLUDED.\"timestamptz6\",\n"
                    + "\"time0\" = EXCLUDED.\"time0\",\n"
                    + "\"time3\" = EXCLUDED.\"time3\",\n"
                    + "\"time6\" = EXCLUDED.\"time6\",\n"
                    + "\"timetz0\" = EXCLUDED.\"timetz0\",\n"
                    + "\"timetz3\" = EXCLUDED.\"timetz3\",\n"
                    + "\"timetz6\" = EXCLUDED.\"timetz6\"\n"
                    + ";\n"
                    + "drop table precision_types_TEMP;"))
        .update()
        .runUnchecked(c);
  }
}

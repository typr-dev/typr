/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.humanresources.employeedepartmenthistory

import adventureworks.customtypes.Defaulted
import adventureworks.customtypes.Defaulted.UseDefault
import adventureworks.humanresources.department.DepartmentId
import adventureworks.humanresources.shift.ShiftId
import adventureworks.person.businessentity.BusinessentityId
import dev.typr.foundations.PgText
import dev.typr.foundations.PgTypes
import dev.typr.foundations.kotlin.nullable
import java.time.LocalDate
import java.time.LocalDateTime

/** This class corresponds to a row in table `humanresources.employeedepartmenthistory` which has not been persisted yet */
data class EmployeedepartmenthistoryRowUnsaved(
  /** Employee identification number. Foreign key to Employee.BusinessEntityID.
    * Points to [adventureworks.humanresources.employee.EmployeeRow.businessentityid]
    */
  val businessentityid: BusinessentityId,
  /** Department in which the employee worked including currently. Foreign key to Department.DepartmentID.
    * Points to [adventureworks.humanresources.department.DepartmentRow.departmentid]
    */
  val departmentid: DepartmentId,
  /** Identifies which 8-hour shift the employee works. Foreign key to Shift.Shift.ID.
    * Points to [adventureworks.humanresources.shift.ShiftRow.shiftid]
    */
  val shiftid: ShiftId,
  /** Date the employee started work in the department.
    * Constraint CK_EmployeeDepartmentHistory_EndDate affecting columns enddate, startdate:  (((enddate >= startdate) OR (enddate IS NULL)))
    */
  val startdate: LocalDate,
  /** Date the employee left the department. NULL = Current department.
    * Constraint CK_EmployeeDepartmentHistory_EndDate affecting columns enddate, startdate:  (((enddate >= startdate) OR (enddate IS NULL)))
    */
  val enddate: LocalDate? = null,
  /** Default: now() */
  val modifieddate: Defaulted<LocalDateTime> = UseDefault()
) {
  fun toRow(modifieddateDefault: () -> LocalDateTime): EmployeedepartmenthistoryRow = EmployeedepartmenthistoryRow(businessentityid = businessentityid, departmentid = departmentid, shiftid = shiftid, startdate = startdate, enddate = enddate, modifieddate = modifieddate.getOrElse(modifieddateDefault))

  companion object {
    val pgText: PgText<EmployeedepartmenthistoryRowUnsaved> =
      PgText.instance({ row, sb -> BusinessentityId.pgType.text().unsafeEncode(row.businessentityid, sb)
      sb.append(PgText.DELIMETER)
      DepartmentId.pgType.text().unsafeEncode(row.departmentid, sb)
      sb.append(PgText.DELIMETER)
      ShiftId.pgType.text().unsafeEncode(row.shiftid, sb)
      sb.append(PgText.DELIMETER)
      PgTypes.date.text().unsafeEncode(row.startdate, sb)
      sb.append(PgText.DELIMETER)
      PgTypes.date.nullable().text().unsafeEncode(row.enddate, sb)
      sb.append(PgText.DELIMETER)
      Defaulted.pgText(PgTypes.timestamp.text()).unsafeEncode(row.modifieddate, sb) })
  }
}
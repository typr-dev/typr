/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.public.users

import adventureworks.customtypes.Defaulted
import adventureworks.customtypes.Defaulted.UseDefault
import com.fasterxml.jackson.annotation.JsonProperty
import dev.typr.foundations.PgText
import dev.typr.foundations.PgTypes
import dev.typr.foundations.data.Unknown
import dev.typr.foundations.kotlin.nullable
import java.time.Instant

/** This class corresponds to a row in table `public.users` which has not been persisted yet */
data class UsersRowUnsaved(
  @field:JsonProperty("user_id") val userId: UsersId,
  val name: String,
  @field:JsonProperty("last_name") val lastName: String? = null,
  val email: Unknown,
  val password: String,
  @field:JsonProperty("verified_on") val verifiedOn: Instant? = null,
  /** Default: now() */
  @field:JsonProperty("created_at") val createdAt: Defaulted<Instant> = UseDefault()
) {
  fun toRow(createdAtDefault: () -> Instant): UsersRow = UsersRow(userId = userId, name = name, lastName = lastName, email = email, password = password, createdAt = createdAt.getOrElse(createdAtDefault), verifiedOn = verifiedOn)

  companion object {
    val pgText: PgText<UsersRowUnsaved> =
      PgText.instance({ row, sb -> UsersId.dbType.text().unsafeEncode(row.userId, sb)
      sb.append(PgText.DELIMETER)
      PgTypes.text.text().unsafeEncode(row.name, sb)
      sb.append(PgText.DELIMETER)
      PgTypes.text.nullable().text().unsafeEncode(row.lastName, sb)
      sb.append(PgText.DELIMETER)
      PgTypes.unknown.text().unsafeEncode(row.email, sb)
      sb.append(PgText.DELIMETER)
      PgTypes.text.text().unsafeEncode(row.password, sb)
      sb.append(PgText.DELIMETER)
      PgTypes.timestamptz.nullable().text().unsafeEncode(row.verifiedOn, sb)
      sb.append(PgText.DELIMETER)
      Defaulted.pgText(PgTypes.timestamptz.text()).unsafeEncode(row.createdAt, sb) })
  }
}
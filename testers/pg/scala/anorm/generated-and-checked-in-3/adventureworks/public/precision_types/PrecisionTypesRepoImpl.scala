/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.public.precision_types

import adventureworks.customtypes.Defaulted
import adventureworks.customtypes.TypoInstant
import adventureworks.customtypes.TypoLocalDateTime
import adventureworks.customtypes.TypoLocalTime
import adventureworks.customtypes.TypoOffsetTime
import adventureworks.streamingInsert
import anorm.BatchSql
import anorm.NamedParameter
import anorm.ParameterValue
import anorm.RowParser
import anorm.SQL
import anorm.SimpleSql
import anorm.ToStatement
import java.sql.Connection
import scala.annotation.nowarn
import typr.dsl.DeleteBuilder
import typr.dsl.SelectBuilder
import typr.dsl.UpdateBuilder
import anorm.SqlStringInterpolation

class PrecisionTypesRepoImpl extends PrecisionTypesRepo {
  override def delete: DeleteBuilder[PrecisionTypesFields, PrecisionTypesRow] = DeleteBuilder.of(""""public"."precision_types"""", PrecisionTypesFields.structure, PrecisionTypesRow.rowParser(1).*)

  override def deleteById(id: PrecisionTypesId)(using c: Connection): Boolean = SQL"""delete from "public"."precision_types" where "id" = ${ParameterValue(id, null, PrecisionTypesId.toStatement)}""".executeUpdate() > 0

  override def deleteByIds(ids: Array[PrecisionTypesId])(using c: Connection): Int = {
    SQL"""delete
    from "public"."precision_types"
    where "id" = ANY(${ParameterValue(ids, null, PrecisionTypesId.arrayToStatement)})
    """.executeUpdate()
  }

  override def insert(unsaved: PrecisionTypesRow)(using c: Connection): PrecisionTypesRow = {
  SQL"""insert into "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
    values (${ParameterValue(unsaved.id, null, PrecisionTypesId.toStatement)}::int4, ${ParameterValue(unsaved.string10, null, ToStatement.stringToStatement)}, ${ParameterValue(unsaved.string20, null, ToStatement.stringToStatement)}, ${ParameterValue(unsaved.string50, null, ToStatement.stringToStatement)}, ${ParameterValue(unsaved.string100, null, ToStatement.stringToStatement)}, ${ParameterValue(unsaved.string255, null, ToStatement.stringToStatement)}, ${ParameterValue(unsaved.bpchar3, null, ToStatement.stringToStatement)}::bpchar, ${ParameterValue(unsaved.bpchar10, null, ToStatement.stringToStatement)}::bpchar, ${ParameterValue(unsaved.decimal52, null, ToStatement.scalaBigDecimalToStatement)}::numeric, ${ParameterValue(unsaved.decimal102, null, ToStatement.scalaBigDecimalToStatement)}::numeric, ${ParameterValue(unsaved.decimal184, null, ToStatement.scalaBigDecimalToStatement)}::numeric, ${ParameterValue(unsaved.numeric82, null, ToStatement.scalaBigDecimalToStatement)}::numeric, ${ParameterValue(unsaved.numeric124, null, ToStatement.scalaBigDecimalToStatement)}::numeric, ${ParameterValue(unsaved.timestamp0, null, TypoLocalDateTime.toStatement)}::timestamp, ${ParameterValue(unsaved.timestamp3, null, TypoLocalDateTime.toStatement)}::timestamp, ${ParameterValue(unsaved.timestamp6, null, TypoLocalDateTime.toStatement)}::timestamp, ${ParameterValue(unsaved.timestamptz0, null, TypoInstant.toStatement)}::timestamptz, ${ParameterValue(unsaved.timestamptz3, null, TypoInstant.toStatement)}::timestamptz, ${ParameterValue(unsaved.timestamptz6, null, TypoInstant.toStatement)}::timestamptz, ${ParameterValue(unsaved.time0, null, TypoLocalTime.toStatement)}::time, ${ParameterValue(unsaved.time3, null, TypoLocalTime.toStatement)}::time, ${ParameterValue(unsaved.time6, null, TypoLocalTime.toStatement)}::time, ${ParameterValue(unsaved.timetz0, null, TypoOffsetTime.toStatement)}::timetz, ${ParameterValue(unsaved.timetz3, null, TypoOffsetTime.toStatement)}::timetz, ${ParameterValue(unsaved.timetz6, null, TypoOffsetTime.toStatement)}::timetz)
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    """
    .executeInsert(PrecisionTypesRow.rowParser(1).single)
  }

  override def insert(unsaved: PrecisionTypesRowUnsaved)(using c: Connection): PrecisionTypesRow = {
    val namedParameters = List(
      Some((NamedParameter("string10", ParameterValue(unsaved.string10, null, ToStatement.stringToStatement)), "")),
      Some((NamedParameter("string20", ParameterValue(unsaved.string20, null, ToStatement.stringToStatement)), "")),
      Some((NamedParameter("string50", ParameterValue(unsaved.string50, null, ToStatement.stringToStatement)), "")),
      Some((NamedParameter("string100", ParameterValue(unsaved.string100, null, ToStatement.stringToStatement)), "")),
      Some((NamedParameter("string255", ParameterValue(unsaved.string255, null, ToStatement.stringToStatement)), "")),
      Some((NamedParameter("bpchar3", ParameterValue(unsaved.bpchar3, null, ToStatement.stringToStatement)), "::bpchar")),
      Some((NamedParameter("bpchar10", ParameterValue(unsaved.bpchar10, null, ToStatement.stringToStatement)), "::bpchar")),
      Some((NamedParameter("decimal5_2", ParameterValue(unsaved.decimal52, null, ToStatement.scalaBigDecimalToStatement)), "::numeric")),
      Some((NamedParameter("decimal10_2", ParameterValue(unsaved.decimal102, null, ToStatement.scalaBigDecimalToStatement)), "::numeric")),
      Some((NamedParameter("decimal18_4", ParameterValue(unsaved.decimal184, null, ToStatement.scalaBigDecimalToStatement)), "::numeric")),
      Some((NamedParameter("numeric8_2", ParameterValue(unsaved.numeric82, null, ToStatement.scalaBigDecimalToStatement)), "::numeric")),
      Some((NamedParameter("numeric12_4", ParameterValue(unsaved.numeric124, null, ToStatement.scalaBigDecimalToStatement)), "::numeric")),
      Some((NamedParameter("timestamp0", ParameterValue(unsaved.timestamp0, null, TypoLocalDateTime.toStatement)), "::timestamp")),
      Some((NamedParameter("timestamp3", ParameterValue(unsaved.timestamp3, null, TypoLocalDateTime.toStatement)), "::timestamp")),
      Some((NamedParameter("timestamp6", ParameterValue(unsaved.timestamp6, null, TypoLocalDateTime.toStatement)), "::timestamp")),
      Some((NamedParameter("timestamptz0", ParameterValue(unsaved.timestamptz0, null, TypoInstant.toStatement)), "::timestamptz")),
      Some((NamedParameter("timestamptz3", ParameterValue(unsaved.timestamptz3, null, TypoInstant.toStatement)), "::timestamptz")),
      Some((NamedParameter("timestamptz6", ParameterValue(unsaved.timestamptz6, null, TypoInstant.toStatement)), "::timestamptz")),
      Some((NamedParameter("time0", ParameterValue(unsaved.time0, null, TypoLocalTime.toStatement)), "::time")),
      Some((NamedParameter("time3", ParameterValue(unsaved.time3, null, TypoLocalTime.toStatement)), "::time")),
      Some((NamedParameter("time6", ParameterValue(unsaved.time6, null, TypoLocalTime.toStatement)), "::time")),
      Some((NamedParameter("timetz0", ParameterValue(unsaved.timetz0, null, TypoOffsetTime.toStatement)), "::timetz")),
      Some((NamedParameter("timetz3", ParameterValue(unsaved.timetz3, null, TypoOffsetTime.toStatement)), "::timetz")),
      Some((NamedParameter("timetz6", ParameterValue(unsaved.timetz6, null, TypoOffsetTime.toStatement)), "::timetz")),
      unsaved.id match {
        case Defaulted.UseDefault() => None
        case Defaulted.Provided(value) => Some((NamedParameter("id", ParameterValue(value, null, PrecisionTypesId.toStatement)), "::int4"))
      }
    ).flatten
    val quote = '"'.toString
    if (namedParameters.isEmpty) {
      SQL"""insert into "public"."precision_types" default values
      returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
      """
        .executeInsert(PrecisionTypesRow.rowParser(1).single)
    } else {
      val q = s"""insert into "public"."precision_types"(${namedParameters.map{case (x, _) => quote + x.name + quote}.mkString(", ")})
              values (${namedParameters.map{ case (np, cast) => s"{${np.name}}$cast"}.mkString(", ")})
              returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
              """
      SimpleSql(SQL(q), namedParameters.map { case (np, _) => np.tupled }.toMap, RowParser.successful)
        .executeInsert(PrecisionTypesRow.rowParser(1).single)
    }
  }

  override def insertStreaming(
    unsaved: Iterator[PrecisionTypesRow],
    batchSize: Int = 10000
  )(using c: Connection): Long = streamingInsert(s"""COPY "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6") FROM STDIN""", batchSize, unsaved)(using PrecisionTypesRow.pgText, c)

  /** NOTE: this functionality requires PostgreSQL 16 or later! */
  override def insertUnsavedStreaming(
    unsaved: Iterator[PrecisionTypesRowUnsaved],
    batchSize: Int = 10000
  )(using c: Connection): Long = streamingInsert(s"""COPY "public"."precision_types"("string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6", "id") FROM STDIN (DEFAULT '__DEFAULT_VALUE__')""", batchSize, unsaved)(using PrecisionTypesRowUnsaved.pgText, c)

  override def select: SelectBuilder[PrecisionTypesFields, PrecisionTypesRow] = SelectBuilder.of(""""public"."precision_types"""", PrecisionTypesFields.structure, PrecisionTypesRow.rowParser)

  override def selectAll(using c: Connection): List[PrecisionTypesRow] = {
    SQL"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    from "public"."precision_types"
    """.as(PrecisionTypesRow.rowParser(1).*)
  }

  override def selectById(id: PrecisionTypesId)(using c: Connection): Option[PrecisionTypesRow] = {
    SQL"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    from "public"."precision_types"
    where "id" = ${ParameterValue(id, null, PrecisionTypesId.toStatement)}
    """.as(PrecisionTypesRow.rowParser(1).singleOpt)
  }

  override def selectByIds(ids: Array[PrecisionTypesId])(using c: Connection): List[PrecisionTypesRow] = {
    SQL"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    from "public"."precision_types"
    where "id" = ANY(${ParameterValue(ids, null, PrecisionTypesId.arrayToStatement)})
    """.as(PrecisionTypesRow.rowParser(1).*)
  }

  override def selectByIdsTracked(ids: Array[PrecisionTypesId])(using c: Connection): Map[PrecisionTypesId, PrecisionTypesRow] = {
    val byId = selectByIds(ids).view.map(x => (x.id, x)).toMap
    ids.view.flatMap(id => byId.get(id).map(x => (id, x))).toMap
  }

  override def update: UpdateBuilder[PrecisionTypesFields, PrecisionTypesRow] = UpdateBuilder.of(""""public"."precision_types"""", PrecisionTypesFields.structure, PrecisionTypesRow.rowParser(1).*)

  override def update(row: PrecisionTypesRow)(using c: Connection): Option[PrecisionTypesRow] = {
    val id = row.id
    SQL"""update "public"."precision_types"
    set "string10" = ${ParameterValue(row.string10, null, ToStatement.stringToStatement)},
    "string20" = ${ParameterValue(row.string20, null, ToStatement.stringToStatement)},
    "string50" = ${ParameterValue(row.string50, null, ToStatement.stringToStatement)},
    "string100" = ${ParameterValue(row.string100, null, ToStatement.stringToStatement)},
    "string255" = ${ParameterValue(row.string255, null, ToStatement.stringToStatement)},
    "bpchar3" = ${ParameterValue(row.bpchar3, null, ToStatement.stringToStatement)}::bpchar,
    "bpchar10" = ${ParameterValue(row.bpchar10, null, ToStatement.stringToStatement)}::bpchar,
    "decimal5_2" = ${ParameterValue(row.decimal52, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    "decimal10_2" = ${ParameterValue(row.decimal102, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    "decimal18_4" = ${ParameterValue(row.decimal184, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    "numeric8_2" = ${ParameterValue(row.numeric82, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    "numeric12_4" = ${ParameterValue(row.numeric124, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    "timestamp0" = ${ParameterValue(row.timestamp0, null, TypoLocalDateTime.toStatement)}::timestamp,
    "timestamp3" = ${ParameterValue(row.timestamp3, null, TypoLocalDateTime.toStatement)}::timestamp,
    "timestamp6" = ${ParameterValue(row.timestamp6, null, TypoLocalDateTime.toStatement)}::timestamp,
    "timestamptz0" = ${ParameterValue(row.timestamptz0, null, TypoInstant.toStatement)}::timestamptz,
    "timestamptz3" = ${ParameterValue(row.timestamptz3, null, TypoInstant.toStatement)}::timestamptz,
    "timestamptz6" = ${ParameterValue(row.timestamptz6, null, TypoInstant.toStatement)}::timestamptz,
    "time0" = ${ParameterValue(row.time0, null, TypoLocalTime.toStatement)}::time,
    "time3" = ${ParameterValue(row.time3, null, TypoLocalTime.toStatement)}::time,
    "time6" = ${ParameterValue(row.time6, null, TypoLocalTime.toStatement)}::time,
    "timetz0" = ${ParameterValue(row.timetz0, null, TypoOffsetTime.toStatement)}::timetz,
    "timetz3" = ${ParameterValue(row.timetz3, null, TypoOffsetTime.toStatement)}::timetz,
    "timetz6" = ${ParameterValue(row.timetz6, null, TypoOffsetTime.toStatement)}::timetz
    where "id" = ${ParameterValue(id, null, PrecisionTypesId.toStatement)}
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    """.executeInsert(PrecisionTypesRow.rowParser(1).singleOpt)
  }

  override def upsert(unsaved: PrecisionTypesRow)(using c: Connection): PrecisionTypesRow = {
  SQL"""insert into "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
    values (
      ${ParameterValue(unsaved.id, null, PrecisionTypesId.toStatement)}::int4,
    ${ParameterValue(unsaved.string10, null, ToStatement.stringToStatement)},
    ${ParameterValue(unsaved.string20, null, ToStatement.stringToStatement)},
    ${ParameterValue(unsaved.string50, null, ToStatement.stringToStatement)},
    ${ParameterValue(unsaved.string100, null, ToStatement.stringToStatement)},
    ${ParameterValue(unsaved.string255, null, ToStatement.stringToStatement)},
    ${ParameterValue(unsaved.bpchar3, null, ToStatement.stringToStatement)}::bpchar,
    ${ParameterValue(unsaved.bpchar10, null, ToStatement.stringToStatement)}::bpchar,
    ${ParameterValue(unsaved.decimal52, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    ${ParameterValue(unsaved.decimal102, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    ${ParameterValue(unsaved.decimal184, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    ${ParameterValue(unsaved.numeric82, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    ${ParameterValue(unsaved.numeric124, null, ToStatement.scalaBigDecimalToStatement)}::numeric,
    ${ParameterValue(unsaved.timestamp0, null, TypoLocalDateTime.toStatement)}::timestamp,
    ${ParameterValue(unsaved.timestamp3, null, TypoLocalDateTime.toStatement)}::timestamp,
    ${ParameterValue(unsaved.timestamp6, null, TypoLocalDateTime.toStatement)}::timestamp,
    ${ParameterValue(unsaved.timestamptz0, null, TypoInstant.toStatement)}::timestamptz,
    ${ParameterValue(unsaved.timestamptz3, null, TypoInstant.toStatement)}::timestamptz,
    ${ParameterValue(unsaved.timestamptz6, null, TypoInstant.toStatement)}::timestamptz,
    ${ParameterValue(unsaved.time0, null, TypoLocalTime.toStatement)}::time,
    ${ParameterValue(unsaved.time3, null, TypoLocalTime.toStatement)}::time,
    ${ParameterValue(unsaved.time6, null, TypoLocalTime.toStatement)}::time,
    ${ParameterValue(unsaved.timetz0, null, TypoOffsetTime.toStatement)}::timetz,
    ${ParameterValue(unsaved.timetz3, null, TypoOffsetTime.toStatement)}::timetz,
    ${ParameterValue(unsaved.timetz6, null, TypoOffsetTime.toStatement)}::timetz
    )
    on conflict ("id")
    do update set
      "string10" = EXCLUDED."string10",
    "string20" = EXCLUDED."string20",
    "string50" = EXCLUDED."string50",
    "string100" = EXCLUDED."string100",
    "string255" = EXCLUDED."string255",
    "bpchar3" = EXCLUDED."bpchar3",
    "bpchar10" = EXCLUDED."bpchar10",
    "decimal5_2" = EXCLUDED."decimal5_2",
    "decimal10_2" = EXCLUDED."decimal10_2",
    "decimal18_4" = EXCLUDED."decimal18_4",
    "numeric8_2" = EXCLUDED."numeric8_2",
    "numeric12_4" = EXCLUDED."numeric12_4",
    "timestamp0" = EXCLUDED."timestamp0",
    "timestamp3" = EXCLUDED."timestamp3",
    "timestamp6" = EXCLUDED."timestamp6",
    "timestamptz0" = EXCLUDED."timestamptz0",
    "timestamptz3" = EXCLUDED."timestamptz3",
    "timestamptz6" = EXCLUDED."timestamptz6",
    "time0" = EXCLUDED."time0",
    "time3" = EXCLUDED."time3",
    "time6" = EXCLUDED."time6",
    "timetz0" = EXCLUDED."timetz0",
    "timetz3" = EXCLUDED."timetz3",
    "timetz6" = EXCLUDED."timetz6"
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    """
    .executeInsert(PrecisionTypesRow.rowParser(1).single)
  }

  override def upsertBatch(unsaved: Iterable[PrecisionTypesRow])(using c: Connection): List[PrecisionTypesRow] = {
    def toNamedParameter(row: PrecisionTypesRow): List[NamedParameter] = List(
      NamedParameter("id", ParameterValue(row.id, null, PrecisionTypesId.toStatement)),
      NamedParameter("string10", ParameterValue(row.string10, null, ToStatement.stringToStatement)),
      NamedParameter("string20", ParameterValue(row.string20, null, ToStatement.stringToStatement)),
      NamedParameter("string50", ParameterValue(row.string50, null, ToStatement.stringToStatement)),
      NamedParameter("string100", ParameterValue(row.string100, null, ToStatement.stringToStatement)),
      NamedParameter("string255", ParameterValue(row.string255, null, ToStatement.stringToStatement)),
      NamedParameter("bpchar3", ParameterValue(row.bpchar3, null, ToStatement.stringToStatement)),
      NamedParameter("bpchar10", ParameterValue(row.bpchar10, null, ToStatement.stringToStatement)),
      NamedParameter("decimal5_2", ParameterValue(row.decimal52, null, ToStatement.scalaBigDecimalToStatement)),
      NamedParameter("decimal10_2", ParameterValue(row.decimal102, null, ToStatement.scalaBigDecimalToStatement)),
      NamedParameter("decimal18_4", ParameterValue(row.decimal184, null, ToStatement.scalaBigDecimalToStatement)),
      NamedParameter("numeric8_2", ParameterValue(row.numeric82, null, ToStatement.scalaBigDecimalToStatement)),
      NamedParameter("numeric12_4", ParameterValue(row.numeric124, null, ToStatement.scalaBigDecimalToStatement)),
      NamedParameter("timestamp0", ParameterValue(row.timestamp0, null, TypoLocalDateTime.toStatement)),
      NamedParameter("timestamp3", ParameterValue(row.timestamp3, null, TypoLocalDateTime.toStatement)),
      NamedParameter("timestamp6", ParameterValue(row.timestamp6, null, TypoLocalDateTime.toStatement)),
      NamedParameter("timestamptz0", ParameterValue(row.timestamptz0, null, TypoInstant.toStatement)),
      NamedParameter("timestamptz3", ParameterValue(row.timestamptz3, null, TypoInstant.toStatement)),
      NamedParameter("timestamptz6", ParameterValue(row.timestamptz6, null, TypoInstant.toStatement)),
      NamedParameter("time0", ParameterValue(row.time0, null, TypoLocalTime.toStatement)),
      NamedParameter("time3", ParameterValue(row.time3, null, TypoLocalTime.toStatement)),
      NamedParameter("time6", ParameterValue(row.time6, null, TypoLocalTime.toStatement)),
      NamedParameter("timetz0", ParameterValue(row.timetz0, null, TypoOffsetTime.toStatement)),
      NamedParameter("timetz3", ParameterValue(row.timetz3, null, TypoOffsetTime.toStatement)),
      NamedParameter("timetz6", ParameterValue(row.timetz6, null, TypoOffsetTime.toStatement))
    )
  
    unsaved.toList match {
      case Nil => Nil
      case head :: rest =>
        new anorm.adventureworks.ExecuteReturningSyntax.Ops(
          BatchSql(
            s"""insert into "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
            values ({id}::int4, {string10}, {string20}, {string50}, {string100}, {string255}, {bpchar3}::bpchar, {bpchar10}::bpchar, {decimal5_2}::numeric, {decimal10_2}::numeric, {decimal18_4}::numeric, {numeric8_2}::numeric, {numeric12_4}::numeric, {timestamp0}::timestamp, {timestamp3}::timestamp, {timestamp6}::timestamp, {timestamptz0}::timestamptz, {timestamptz3}::timestamptz, {timestamptz6}::timestamptz, {time0}::time, {time3}::time, {time6}::time, {timetz0}::timetz, {timetz3}::timetz, {timetz6}::timetz)
            on conflict ("id")
            do update set
              "string10" = EXCLUDED."string10",
            "string20" = EXCLUDED."string20",
            "string50" = EXCLUDED."string50",
            "string100" = EXCLUDED."string100",
            "string255" = EXCLUDED."string255",
            "bpchar3" = EXCLUDED."bpchar3",
            "bpchar10" = EXCLUDED."bpchar10",
            "decimal5_2" = EXCLUDED."decimal5_2",
            "decimal10_2" = EXCLUDED."decimal10_2",
            "decimal18_4" = EXCLUDED."decimal18_4",
            "numeric8_2" = EXCLUDED."numeric8_2",
            "numeric12_4" = EXCLUDED."numeric12_4",
            "timestamp0" = EXCLUDED."timestamp0",
            "timestamp3" = EXCLUDED."timestamp3",
            "timestamp6" = EXCLUDED."timestamp6",
            "timestamptz0" = EXCLUDED."timestamptz0",
            "timestamptz3" = EXCLUDED."timestamptz3",
            "timestamptz6" = EXCLUDED."timestamptz6",
            "time0" = EXCLUDED."time0",
            "time3" = EXCLUDED."time3",
            "time6" = EXCLUDED."time6",
            "timetz0" = EXCLUDED."timetz0",
            "timetz3" = EXCLUDED."timetz3",
            "timetz6" = EXCLUDED."timetz6"
            returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
            """,
            toNamedParameter(head),
            rest.map(toNamedParameter)*
          )
        ).executeReturning(PrecisionTypesRow.rowParser(1).*)
    }
  }

  /** NOTE: this functionality is not safe if you use auto-commit mode! it runs 3 SQL statements */
  override def upsertStreaming(
    unsaved: Iterator[PrecisionTypesRow],
    batchSize: Int = 10000
  )(using c: Connection): Int = {
    SQL"""create temporary table precision_types_TEMP (like "public"."precision_types") on commit drop""".execute(): @nowarn
    streamingInsert(s"""copy precision_types_TEMP("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6") from stdin""", batchSize, unsaved)(using PrecisionTypesRow.pgText, c): @nowarn
    SQL"""insert into "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
    select * from precision_types_TEMP
    on conflict ("id")
    do update set
      "string10" = EXCLUDED."string10",
    "string20" = EXCLUDED."string20",
    "string50" = EXCLUDED."string50",
    "string100" = EXCLUDED."string100",
    "string255" = EXCLUDED."string255",
    "bpchar3" = EXCLUDED."bpchar3",
    "bpchar10" = EXCLUDED."bpchar10",
    "decimal5_2" = EXCLUDED."decimal5_2",
    "decimal10_2" = EXCLUDED."decimal10_2",
    "decimal18_4" = EXCLUDED."decimal18_4",
    "numeric8_2" = EXCLUDED."numeric8_2",
    "numeric12_4" = EXCLUDED."numeric12_4",
    "timestamp0" = EXCLUDED."timestamp0",
    "timestamp3" = EXCLUDED."timestamp3",
    "timestamp6" = EXCLUDED."timestamp6",
    "timestamptz0" = EXCLUDED."timestamptz0",
    "timestamptz3" = EXCLUDED."timestamptz3",
    "timestamptz6" = EXCLUDED."timestamptz6",
    "time0" = EXCLUDED."time0",
    "time3" = EXCLUDED."time3",
    "time6" = EXCLUDED."time6",
    "timetz0" = EXCLUDED."timetz0",
    "timetz3" = EXCLUDED."timetz3",
    "timetz6" = EXCLUDED."timetz6"
    ;
    drop table precision_types_TEMP;""".executeUpdate()
  }
}
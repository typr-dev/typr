/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.public.precision_types_null

import adventureworks.customtypes.Defaulted
import adventureworks.customtypes.TypoInstant
import adventureworks.customtypes.TypoLocalDateTime
import adventureworks.customtypes.TypoLocalTime
import adventureworks.customtypes.TypoOffsetTime
import cats.instances.list.catsStdInstancesForList
import doobie.free.connection.ConnectionIO
import doobie.postgres.syntax.FragmentOps
import doobie.syntax.SqlInterpolator.SingleFragment.fromWrite
import doobie.util.Write
import doobie.util.fragment.Fragment
import doobie.util.meta.Meta
import doobie.util.update.Update
import fs2.Stream
import typr.dsl.DeleteBuilder
import typr.dsl.SelectBuilder
import typr.dsl.UpdateBuilder
import doobie.syntax.string.toSqlInterpolator

class PrecisionTypesNullRepoImpl extends PrecisionTypesNullRepo {
  override def delete: DeleteBuilder[PrecisionTypesNullFields, PrecisionTypesNullRow] = DeleteBuilder.of(""""public"."precision_types_null"""", PrecisionTypesNullFields.structure, PrecisionTypesNullRow.read)

  override def deleteById(id: PrecisionTypesNullId): ConnectionIO[Boolean] = sql"""delete from "public"."precision_types_null" where "id" = ${fromWrite(id)(using new Write.Single(PrecisionTypesNullId.put))}""".update.run.map(_ > 0)

  override def deleteByIds(ids: Array[PrecisionTypesNullId]): ConnectionIO[Int] = sql"""delete from "public"."precision_types_null" where "id" = ANY(${fromWrite(ids)(using new Write.Single(PrecisionTypesNullId.arrayPut))})""".update.run

  override def insert(unsaved: PrecisionTypesNullRow): ConnectionIO[PrecisionTypesNullRow] = {
    sql"""insert into "public"."precision_types_null"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
    values (${fromWrite(unsaved.id)(using new Write.Single(PrecisionTypesNullId.put))}::int4, ${fromWrite(unsaved.string10)(using new Write.SingleOpt(Meta.StringMeta.put))}, ${fromWrite(unsaved.string20)(using new Write.SingleOpt(Meta.StringMeta.put))}, ${fromWrite(unsaved.string50)(using new Write.SingleOpt(Meta.StringMeta.put))}, ${fromWrite(unsaved.string100)(using new Write.SingleOpt(Meta.StringMeta.put))}, ${fromWrite(unsaved.string255)(using new Write.SingleOpt(Meta.StringMeta.put))}, ${fromWrite(unsaved.bpchar3)(using new Write.SingleOpt(Meta.StringMeta.put))}::bpchar, ${fromWrite(unsaved.bpchar10)(using new Write.SingleOpt(Meta.StringMeta.put))}::bpchar, ${fromWrite(unsaved.decimal52)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric, ${fromWrite(unsaved.decimal102)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric, ${fromWrite(unsaved.decimal184)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric, ${fromWrite(unsaved.numeric82)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric, ${fromWrite(unsaved.numeric124)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric, ${fromWrite(unsaved.timestamp0)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp, ${fromWrite(unsaved.timestamp3)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp, ${fromWrite(unsaved.timestamp6)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp, ${fromWrite(unsaved.timestamptz0)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz, ${fromWrite(unsaved.timestamptz3)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz, ${fromWrite(unsaved.timestamptz6)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz, ${fromWrite(unsaved.time0)(using new Write.SingleOpt(TypoLocalTime.put))}::time, ${fromWrite(unsaved.time3)(using new Write.SingleOpt(TypoLocalTime.put))}::time, ${fromWrite(unsaved.time6)(using new Write.SingleOpt(TypoLocalTime.put))}::time, ${fromWrite(unsaved.timetz0)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz, ${fromWrite(unsaved.timetz3)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz, ${fromWrite(unsaved.timetz6)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz)
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    """.query(using PrecisionTypesNullRow.read).unique
  }

  override def insert(unsaved: PrecisionTypesNullRowUnsaved): ConnectionIO[PrecisionTypesNullRow] = {
    val fs = List(
      Some((Fragment.const0(s""""string10""""), fr"${fromWrite(unsaved.string10)(using new Write.SingleOpt(Meta.StringMeta.put))}")),
      Some((Fragment.const0(s""""string20""""), fr"${fromWrite(unsaved.string20)(using new Write.SingleOpt(Meta.StringMeta.put))}")),
      Some((Fragment.const0(s""""string50""""), fr"${fromWrite(unsaved.string50)(using new Write.SingleOpt(Meta.StringMeta.put))}")),
      Some((Fragment.const0(s""""string100""""), fr"${fromWrite(unsaved.string100)(using new Write.SingleOpt(Meta.StringMeta.put))}")),
      Some((Fragment.const0(s""""string255""""), fr"${fromWrite(unsaved.string255)(using new Write.SingleOpt(Meta.StringMeta.put))}")),
      Some((Fragment.const0(s""""bpchar3""""), fr"${fromWrite(unsaved.bpchar3)(using new Write.SingleOpt(Meta.StringMeta.put))}::bpchar")),
      Some((Fragment.const0(s""""bpchar10""""), fr"${fromWrite(unsaved.bpchar10)(using new Write.SingleOpt(Meta.StringMeta.put))}::bpchar")),
      Some((Fragment.const0(s""""decimal5_2""""), fr"${fromWrite(unsaved.decimal52)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric")),
      Some((Fragment.const0(s""""decimal10_2""""), fr"${fromWrite(unsaved.decimal102)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric")),
      Some((Fragment.const0(s""""decimal18_4""""), fr"${fromWrite(unsaved.decimal184)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric")),
      Some((Fragment.const0(s""""numeric8_2""""), fr"${fromWrite(unsaved.numeric82)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric")),
      Some((Fragment.const0(s""""numeric12_4""""), fr"${fromWrite(unsaved.numeric124)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric")),
      Some((Fragment.const0(s""""timestamp0""""), fr"${fromWrite(unsaved.timestamp0)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp")),
      Some((Fragment.const0(s""""timestamp3""""), fr"${fromWrite(unsaved.timestamp3)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp")),
      Some((Fragment.const0(s""""timestamp6""""), fr"${fromWrite(unsaved.timestamp6)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp")),
      Some((Fragment.const0(s""""timestamptz0""""), fr"${fromWrite(unsaved.timestamptz0)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz")),
      Some((Fragment.const0(s""""timestamptz3""""), fr"${fromWrite(unsaved.timestamptz3)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz")),
      Some((Fragment.const0(s""""timestamptz6""""), fr"${fromWrite(unsaved.timestamptz6)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz")),
      Some((Fragment.const0(s""""time0""""), fr"${fromWrite(unsaved.time0)(using new Write.SingleOpt(TypoLocalTime.put))}::time")),
      Some((Fragment.const0(s""""time3""""), fr"${fromWrite(unsaved.time3)(using new Write.SingleOpt(TypoLocalTime.put))}::time")),
      Some((Fragment.const0(s""""time6""""), fr"${fromWrite(unsaved.time6)(using new Write.SingleOpt(TypoLocalTime.put))}::time")),
      Some((Fragment.const0(s""""timetz0""""), fr"${fromWrite(unsaved.timetz0)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz")),
      Some((Fragment.const0(s""""timetz3""""), fr"${fromWrite(unsaved.timetz3)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz")),
      Some((Fragment.const0(s""""timetz6""""), fr"${fromWrite(unsaved.timetz6)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz")),
      unsaved.id match {
        case Defaulted.UseDefault() => None
        case Defaulted.Provided(value) => Some((Fragment.const0(s""""id""""), fr"${fromWrite(value: PrecisionTypesNullId)(using new Write.Single(PrecisionTypesNullId.put))}::int4"))
      }
    ).flatten
    val q = if (fs.isEmpty) {
      sql"""insert into "public"."precision_types_null" default values
      returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
      """
    } else {
      val CommaSeparate = Fragment.FragmentMonoid.intercalate(fr", ")
      sql"""insert into "public"."precision_types_null"(${CommaSeparate.combineAllOption(fs.map { case (n, _) => n }).get})
      values (${CommaSeparate.combineAllOption(fs.map { case (_, f) => f }).get})
      returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
      """
    }
    q.query(using PrecisionTypesNullRow.read).unique
  }

  override def insertStreaming(
    unsaved: Stream[ConnectionIO, PrecisionTypesNullRow],
    batchSize: Int = 10000
  ): ConnectionIO[Long] = new FragmentOps(sql"""COPY "public"."precision_types_null"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6") FROM STDIN""").copyIn(unsaved, batchSize)(using PrecisionTypesNullRow.pgText)

  /** NOTE: this functionality requires PostgreSQL 16 or later! */
  override def insertUnsavedStreaming(
    unsaved: Stream[ConnectionIO, PrecisionTypesNullRowUnsaved],
    batchSize: Int = 10000
  ): ConnectionIO[Long] = new FragmentOps(sql"""COPY "public"."precision_types_null"("string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6", "id") FROM STDIN (DEFAULT '__DEFAULT_VALUE__')""").copyIn(unsaved, batchSize)(using PrecisionTypesNullRowUnsaved.pgText)

  override def select: SelectBuilder[PrecisionTypesNullFields, PrecisionTypesNullRow] = SelectBuilder.of(""""public"."precision_types_null"""", PrecisionTypesNullFields.structure, PrecisionTypesNullRow.read)

  override def selectAll: Stream[ConnectionIO, PrecisionTypesNullRow] = sql"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text from "public"."precision_types_null"""".query(using PrecisionTypesNullRow.read).stream

  override def selectById(id: PrecisionTypesNullId): ConnectionIO[Option[PrecisionTypesNullRow]] = sql"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text from "public"."precision_types_null" where "id" = ${fromWrite(id)(using new Write.Single(PrecisionTypesNullId.put))}""".query(using PrecisionTypesNullRow.read).option

  override def selectByIds(ids: Array[PrecisionTypesNullId]): Stream[ConnectionIO, PrecisionTypesNullRow] = sql"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text from "public"."precision_types_null" where "id" = ANY(${fromWrite(ids)(using new Write.Single(PrecisionTypesNullId.arrayPut))})""".query(using PrecisionTypesNullRow.read).stream

  override def selectByIdsTracked(ids: Array[PrecisionTypesNullId]): ConnectionIO[Map[PrecisionTypesNullId, PrecisionTypesNullRow]] = {
    selectByIds(ids).compile.toList.map { rows =>
      val byId = rows.view.map(x => (x.id, x)).toMap
      ids.view.flatMap(id => byId.get(id).map(x => (id, x))).toMap
    }
  }

  override def update: UpdateBuilder[PrecisionTypesNullFields, PrecisionTypesNullRow] = UpdateBuilder.of(""""public"."precision_types_null"""", PrecisionTypesNullFields.structure, PrecisionTypesNullRow.read)

  override def update(row: PrecisionTypesNullRow): ConnectionIO[Option[PrecisionTypesNullRow]] = {
    val id = row.id
    sql"""update "public"."precision_types_null"
    set "string10" = ${fromWrite(row.string10)(using new Write.SingleOpt(Meta.StringMeta.put))},
    "string20" = ${fromWrite(row.string20)(using new Write.SingleOpt(Meta.StringMeta.put))},
    "string50" = ${fromWrite(row.string50)(using new Write.SingleOpt(Meta.StringMeta.put))},
    "string100" = ${fromWrite(row.string100)(using new Write.SingleOpt(Meta.StringMeta.put))},
    "string255" = ${fromWrite(row.string255)(using new Write.SingleOpt(Meta.StringMeta.put))},
    "bpchar3" = ${fromWrite(row.bpchar3)(using new Write.SingleOpt(Meta.StringMeta.put))}::bpchar,
    "bpchar10" = ${fromWrite(row.bpchar10)(using new Write.SingleOpt(Meta.StringMeta.put))}::bpchar,
    "decimal5_2" = ${fromWrite(row.decimal52)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    "decimal10_2" = ${fromWrite(row.decimal102)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    "decimal18_4" = ${fromWrite(row.decimal184)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    "numeric8_2" = ${fromWrite(row.numeric82)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    "numeric12_4" = ${fromWrite(row.numeric124)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    "timestamp0" = ${fromWrite(row.timestamp0)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp,
    "timestamp3" = ${fromWrite(row.timestamp3)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp,
    "timestamp6" = ${fromWrite(row.timestamp6)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp,
    "timestamptz0" = ${fromWrite(row.timestamptz0)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz,
    "timestamptz3" = ${fromWrite(row.timestamptz3)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz,
    "timestamptz6" = ${fromWrite(row.timestamptz6)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz,
    "time0" = ${fromWrite(row.time0)(using new Write.SingleOpt(TypoLocalTime.put))}::time,
    "time3" = ${fromWrite(row.time3)(using new Write.SingleOpt(TypoLocalTime.put))}::time,
    "time6" = ${fromWrite(row.time6)(using new Write.SingleOpt(TypoLocalTime.put))}::time,
    "timetz0" = ${fromWrite(row.timetz0)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz,
    "timetz3" = ${fromWrite(row.timetz3)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz,
    "timetz6" = ${fromWrite(row.timetz6)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz
    where "id" = ${fromWrite(id)(using new Write.Single(PrecisionTypesNullId.put))}
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text""".query(using PrecisionTypesNullRow.read).option
  }

  override def upsert(unsaved: PrecisionTypesNullRow): ConnectionIO[PrecisionTypesNullRow] = {
    sql"""insert into "public"."precision_types_null"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
    values (
      ${fromWrite(unsaved.id)(using new Write.Single(PrecisionTypesNullId.put))}::int4,
    ${fromWrite(unsaved.string10)(using new Write.SingleOpt(Meta.StringMeta.put))},
    ${fromWrite(unsaved.string20)(using new Write.SingleOpt(Meta.StringMeta.put))},
    ${fromWrite(unsaved.string50)(using new Write.SingleOpt(Meta.StringMeta.put))},
    ${fromWrite(unsaved.string100)(using new Write.SingleOpt(Meta.StringMeta.put))},
    ${fromWrite(unsaved.string255)(using new Write.SingleOpt(Meta.StringMeta.put))},
    ${fromWrite(unsaved.bpchar3)(using new Write.SingleOpt(Meta.StringMeta.put))}::bpchar,
    ${fromWrite(unsaved.bpchar10)(using new Write.SingleOpt(Meta.StringMeta.put))}::bpchar,
    ${fromWrite(unsaved.decimal52)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    ${fromWrite(unsaved.decimal102)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    ${fromWrite(unsaved.decimal184)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    ${fromWrite(unsaved.numeric82)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    ${fromWrite(unsaved.numeric124)(using new Write.SingleOpt(Meta.ScalaBigDecimalMeta.put))}::numeric,
    ${fromWrite(unsaved.timestamp0)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp,
    ${fromWrite(unsaved.timestamp3)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp,
    ${fromWrite(unsaved.timestamp6)(using new Write.SingleOpt(TypoLocalDateTime.put))}::timestamp,
    ${fromWrite(unsaved.timestamptz0)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz,
    ${fromWrite(unsaved.timestamptz3)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz,
    ${fromWrite(unsaved.timestamptz6)(using new Write.SingleOpt(TypoInstant.put))}::timestamptz,
    ${fromWrite(unsaved.time0)(using new Write.SingleOpt(TypoLocalTime.put))}::time,
    ${fromWrite(unsaved.time3)(using new Write.SingleOpt(TypoLocalTime.put))}::time,
    ${fromWrite(unsaved.time6)(using new Write.SingleOpt(TypoLocalTime.put))}::time,
    ${fromWrite(unsaved.timetz0)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz,
    ${fromWrite(unsaved.timetz3)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz,
    ${fromWrite(unsaved.timetz6)(using new Write.SingleOpt(TypoOffsetTime.put))}::timetz
    )
    on conflict ("id")
    do update set
      "string10" = EXCLUDED."string10",
    "string20" = EXCLUDED."string20",
    "string50" = EXCLUDED."string50",
    "string100" = EXCLUDED."string100",
    "string255" = EXCLUDED."string255",
    "bpchar3" = EXCLUDED."bpchar3",
    "bpchar10" = EXCLUDED."bpchar10",
    "decimal5_2" = EXCLUDED."decimal5_2",
    "decimal10_2" = EXCLUDED."decimal10_2",
    "decimal18_4" = EXCLUDED."decimal18_4",
    "numeric8_2" = EXCLUDED."numeric8_2",
    "numeric12_4" = EXCLUDED."numeric12_4",
    "timestamp0" = EXCLUDED."timestamp0",
    "timestamp3" = EXCLUDED."timestamp3",
    "timestamp6" = EXCLUDED."timestamp6",
    "timestamptz0" = EXCLUDED."timestamptz0",
    "timestamptz3" = EXCLUDED."timestamptz3",
    "timestamptz6" = EXCLUDED."timestamptz6",
    "time0" = EXCLUDED."time0",
    "time3" = EXCLUDED."time3",
    "time6" = EXCLUDED."time6",
    "timetz0" = EXCLUDED."timetz0",
    "timetz3" = EXCLUDED."timetz3",
    "timetz6" = EXCLUDED."timetz6"
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    """.query(using PrecisionTypesNullRow.read).unique
  }

  override def upsertBatch(unsaved: List[PrecisionTypesNullRow]): Stream[ConnectionIO, PrecisionTypesNullRow] = {
    Update[PrecisionTypesNullRow](
      s"""insert into "public"."precision_types_null"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
      values (?::int4,?,?,?,?,?,?::bpchar,?::bpchar,?::numeric,?::numeric,?::numeric,?::numeric,?::numeric,?::timestamp,?::timestamp,?::timestamp,?::timestamptz,?::timestamptz,?::timestamptz,?::time,?::time,?::time,?::timetz,?::timetz,?::timetz)
      on conflict ("id")
      do update set
        "string10" = EXCLUDED."string10",
      "string20" = EXCLUDED."string20",
      "string50" = EXCLUDED."string50",
      "string100" = EXCLUDED."string100",
      "string255" = EXCLUDED."string255",
      "bpchar3" = EXCLUDED."bpchar3",
      "bpchar10" = EXCLUDED."bpchar10",
      "decimal5_2" = EXCLUDED."decimal5_2",
      "decimal10_2" = EXCLUDED."decimal10_2",
      "decimal18_4" = EXCLUDED."decimal18_4",
      "numeric8_2" = EXCLUDED."numeric8_2",
      "numeric12_4" = EXCLUDED."numeric12_4",
      "timestamp0" = EXCLUDED."timestamp0",
      "timestamp3" = EXCLUDED."timestamp3",
      "timestamp6" = EXCLUDED."timestamp6",
      "timestamptz0" = EXCLUDED."timestamptz0",
      "timestamptz3" = EXCLUDED."timestamptz3",
      "timestamptz6" = EXCLUDED."timestamptz6",
      "time0" = EXCLUDED."time0",
      "time3" = EXCLUDED."time3",
      "time6" = EXCLUDED."time6",
      "timetz0" = EXCLUDED."timetz0",
      "timetz3" = EXCLUDED."timetz3",
      "timetz6" = EXCLUDED."timetz6"
      returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text"""
    )(using PrecisionTypesNullRow.write)
    .updateManyWithGeneratedKeys[PrecisionTypesNullRow]("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")(unsaved)(using catsStdInstancesForList, PrecisionTypesNullRow.read)
  }

  /** NOTE: this functionality is not safe if you use auto-commit mode! it runs 3 SQL statements */
  override def upsertStreaming(
    unsaved: Stream[ConnectionIO, PrecisionTypesNullRow],
    batchSize: Int = 10000
  ): ConnectionIO[Int] = {
    for {
      _ <- sql"""create temporary table precision_types_null_TEMP (like "public"."precision_types_null") on commit drop""".update.run
      _ <- new FragmentOps(sql"""copy precision_types_null_TEMP("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6") from stdin""").copyIn(unsaved, batchSize)(using PrecisionTypesNullRow.pgText)
      res <- sql"""insert into "public"."precision_types_null"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
             select * from precision_types_null_TEMP
             on conflict ("id")
             do update set
               "string10" = EXCLUDED."string10",
             "string20" = EXCLUDED."string20",
             "string50" = EXCLUDED."string50",
             "string100" = EXCLUDED."string100",
             "string255" = EXCLUDED."string255",
             "bpchar3" = EXCLUDED."bpchar3",
             "bpchar10" = EXCLUDED."bpchar10",
             "decimal5_2" = EXCLUDED."decimal5_2",
             "decimal10_2" = EXCLUDED."decimal10_2",
             "decimal18_4" = EXCLUDED."decimal18_4",
             "numeric8_2" = EXCLUDED."numeric8_2",
             "numeric12_4" = EXCLUDED."numeric12_4",
             "timestamp0" = EXCLUDED."timestamp0",
             "timestamp3" = EXCLUDED."timestamp3",
             "timestamp6" = EXCLUDED."timestamp6",
             "timestamptz0" = EXCLUDED."timestamptz0",
             "timestamptz3" = EXCLUDED."timestamptz3",
             "timestamptz6" = EXCLUDED."timestamptz6",
             "time0" = EXCLUDED."time0",
             "time3" = EXCLUDED."time3",
             "time6" = EXCLUDED."time6",
             "timetz0" = EXCLUDED."timetz0",
             "timetz3" = EXCLUDED."timetz3",
             "timetz6" = EXCLUDED."timetz6"
             ;
             drop table precision_types_null_TEMP;""".update.run
    } yield res
  }
}
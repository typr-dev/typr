/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.person_dynamic

import dev.typr.foundations.PgTypes
import dev.typr.foundations.scala.Fragment
import dev.typr.foundations.scala.PgTypeOps
import java.sql.Connection
import dev.typr.foundations.scala.Fragment.sql

class PersonDynamicSqlRepoImpl extends PersonDynamicSqlRepo {
  override def apply(firstName: Option[String])(using c: Connection): List[PersonDynamicSqlRow] = {
    sql"""SELECT p.title, p.firstname, p.middlename, p.lastname
    FROM person.person p
    WHERE ${Fragment.encode(PgTypes.text.nullable, firstName)}::text IS NULL OR p.firstname = ${Fragment.encode(PgTypes.text.nullable, firstName)}
    """.query(PersonDynamicSqlRow.`_rowParser`.all()).runUnchecked(c)
  }
}
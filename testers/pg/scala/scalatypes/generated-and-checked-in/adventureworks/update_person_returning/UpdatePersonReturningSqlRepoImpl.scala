/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.update_person_returning

import dev.typr.foundations.PgTypes
import dev.typr.foundations.scala.Fragment
import dev.typr.foundations.scala.PgTypeOps
import java.sql.Connection
import java.time.LocalDateTime
import dev.typr.foundations.scala.Fragment.sql

class UpdatePersonReturningSqlRepoImpl extends UpdatePersonReturningSqlRepo {
  override def apply(
    suffix: /* nullability unknown */ Option[String],
    cutoff: /* nullability unknown */ Option[LocalDateTime]
  )(using c: Connection): List[UpdatePersonReturningSqlRow] = {
    sql"""update person.person
    set firstname = firstname || '-' || ${Fragment.encode(PgTypes.text.nullable, suffix)}
    where modifieddate < ${Fragment.encode(PgTypes.timestamp.nullable, cutoff)}::timestamp
    returning firstname, modifieddate""".query(UpdatePersonReturningSqlRow.`_rowParser`.all()).runUnchecked(c)
  }
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.public.precision_types

import adventureworks.customtypes.Defaulted
import adventureworks.customtypes.TypoInstant
import adventureworks.customtypes.TypoLocalDateTime
import adventureworks.customtypes.TypoLocalTime
import adventureworks.customtypes.TypoOffsetTime
import adventureworks.streamingInsert
import typr.dsl.DeleteBuilder
import typr.dsl.SelectBuilder
import typr.dsl.UpdateBuilder
import zio.ZIO
import zio.jdbc.SqlFragment
import zio.jdbc.SqlFragment.Segment
import zio.jdbc.SqlFragment.Setter
import zio.jdbc.UpdateResult
import zio.jdbc.ZConnection
import zio.stream.ZStream
import zio.jdbc.sqlInterpolator

class PrecisionTypesRepoImpl extends PrecisionTypesRepo {
  override def delete: DeleteBuilder[PrecisionTypesFields, PrecisionTypesRow] = DeleteBuilder.of(""""public"."precision_types"""", PrecisionTypesFields.structure, PrecisionTypesRow.jdbcDecoder)

  override def deleteById(id: PrecisionTypesId): ZIO[ZConnection, Throwable, Boolean] = sql"""delete from "public"."precision_types" where "id" = ${Segment.paramSegment(id)(using PrecisionTypesId.setter)}""".delete.map(_ > 0)

  override def deleteByIds(ids: Array[PrecisionTypesId]): ZIO[ZConnection, Throwable, Long] = sql"""delete from "public"."precision_types" where "id" = ANY(${Segment.paramSegment(ids)(using PrecisionTypesId.arraySetter)})""".delete

  override def insert(unsaved: PrecisionTypesRow): ZIO[ZConnection, Throwable, PrecisionTypesRow] = {
    sql"""insert into "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
    values (${Segment.paramSegment(unsaved.id)(using PrecisionTypesId.setter)}::int4, ${Segment.paramSegment(unsaved.string10)(using Setter.stringSetter)}, ${Segment.paramSegment(unsaved.string20)(using Setter.stringSetter)}, ${Segment.paramSegment(unsaved.string50)(using Setter.stringSetter)}, ${Segment.paramSegment(unsaved.string100)(using Setter.stringSetter)}, ${Segment.paramSegment(unsaved.string255)(using Setter.stringSetter)}, ${Segment.paramSegment(unsaved.bpchar3)(using Setter.stringSetter)}::bpchar, ${Segment.paramSegment(unsaved.bpchar10)(using Setter.stringSetter)}::bpchar, ${Segment.paramSegment(unsaved.decimal52)(using Setter.bigDecimalScalaSetter)}::numeric, ${Segment.paramSegment(unsaved.decimal102)(using Setter.bigDecimalScalaSetter)}::numeric, ${Segment.paramSegment(unsaved.decimal184)(using Setter.bigDecimalScalaSetter)}::numeric, ${Segment.paramSegment(unsaved.numeric82)(using Setter.bigDecimalScalaSetter)}::numeric, ${Segment.paramSegment(unsaved.numeric124)(using Setter.bigDecimalScalaSetter)}::numeric, ${Segment.paramSegment(unsaved.timestamp0)(using TypoLocalDateTime.setter)}::timestamp, ${Segment.paramSegment(unsaved.timestamp3)(using TypoLocalDateTime.setter)}::timestamp, ${Segment.paramSegment(unsaved.timestamp6)(using TypoLocalDateTime.setter)}::timestamp, ${Segment.paramSegment(unsaved.timestamptz0)(using TypoInstant.setter)}::timestamptz, ${Segment.paramSegment(unsaved.timestamptz3)(using TypoInstant.setter)}::timestamptz, ${Segment.paramSegment(unsaved.timestamptz6)(using TypoInstant.setter)}::timestamptz, ${Segment.paramSegment(unsaved.time0)(using TypoLocalTime.setter)}::time, ${Segment.paramSegment(unsaved.time3)(using TypoLocalTime.setter)}::time, ${Segment.paramSegment(unsaved.time6)(using TypoLocalTime.setter)}::time, ${Segment.paramSegment(unsaved.timetz0)(using TypoOffsetTime.setter)}::timetz, ${Segment.paramSegment(unsaved.timetz3)(using TypoOffsetTime.setter)}::timetz, ${Segment.paramSegment(unsaved.timetz6)(using TypoOffsetTime.setter)}::timetz)
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
    """.insertReturning(using PrecisionTypesRow.jdbcDecoder).map(_.updatedKeys.head)
  }

  override def insert(unsaved: PrecisionTypesRowUnsaved): ZIO[ZConnection, Throwable, PrecisionTypesRow] = {
    val fs = List(
      Some((sql""""string10"""", sql"${Segment.paramSegment(unsaved.string10)(using Setter.stringSetter)}")),
      Some((sql""""string20"""", sql"${Segment.paramSegment(unsaved.string20)(using Setter.stringSetter)}")),
      Some((sql""""string50"""", sql"${Segment.paramSegment(unsaved.string50)(using Setter.stringSetter)}")),
      Some((sql""""string100"""", sql"${Segment.paramSegment(unsaved.string100)(using Setter.stringSetter)}")),
      Some((sql""""string255"""", sql"${Segment.paramSegment(unsaved.string255)(using Setter.stringSetter)}")),
      Some((sql""""bpchar3"""", sql"${Segment.paramSegment(unsaved.bpchar3)(using Setter.stringSetter)}::bpchar")),
      Some((sql""""bpchar10"""", sql"${Segment.paramSegment(unsaved.bpchar10)(using Setter.stringSetter)}::bpchar")),
      Some((sql""""decimal5_2"""", sql"${Segment.paramSegment(unsaved.decimal52)(using Setter.bigDecimalScalaSetter)}::numeric")),
      Some((sql""""decimal10_2"""", sql"${Segment.paramSegment(unsaved.decimal102)(using Setter.bigDecimalScalaSetter)}::numeric")),
      Some((sql""""decimal18_4"""", sql"${Segment.paramSegment(unsaved.decimal184)(using Setter.bigDecimalScalaSetter)}::numeric")),
      Some((sql""""numeric8_2"""", sql"${Segment.paramSegment(unsaved.numeric82)(using Setter.bigDecimalScalaSetter)}::numeric")),
      Some((sql""""numeric12_4"""", sql"${Segment.paramSegment(unsaved.numeric124)(using Setter.bigDecimalScalaSetter)}::numeric")),
      Some((sql""""timestamp0"""", sql"${Segment.paramSegment(unsaved.timestamp0)(using TypoLocalDateTime.setter)}::timestamp")),
      Some((sql""""timestamp3"""", sql"${Segment.paramSegment(unsaved.timestamp3)(using TypoLocalDateTime.setter)}::timestamp")),
      Some((sql""""timestamp6"""", sql"${Segment.paramSegment(unsaved.timestamp6)(using TypoLocalDateTime.setter)}::timestamp")),
      Some((sql""""timestamptz0"""", sql"${Segment.paramSegment(unsaved.timestamptz0)(using TypoInstant.setter)}::timestamptz")),
      Some((sql""""timestamptz3"""", sql"${Segment.paramSegment(unsaved.timestamptz3)(using TypoInstant.setter)}::timestamptz")),
      Some((sql""""timestamptz6"""", sql"${Segment.paramSegment(unsaved.timestamptz6)(using TypoInstant.setter)}::timestamptz")),
      Some((sql""""time0"""", sql"${Segment.paramSegment(unsaved.time0)(using TypoLocalTime.setter)}::time")),
      Some((sql""""time3"""", sql"${Segment.paramSegment(unsaved.time3)(using TypoLocalTime.setter)}::time")),
      Some((sql""""time6"""", sql"${Segment.paramSegment(unsaved.time6)(using TypoLocalTime.setter)}::time")),
      Some((sql""""timetz0"""", sql"${Segment.paramSegment(unsaved.timetz0)(using TypoOffsetTime.setter)}::timetz")),
      Some((sql""""timetz3"""", sql"${Segment.paramSegment(unsaved.timetz3)(using TypoOffsetTime.setter)}::timetz")),
      Some((sql""""timetz6"""", sql"${Segment.paramSegment(unsaved.timetz6)(using TypoOffsetTime.setter)}::timetz")),
      unsaved.id match {
        case Defaulted.UseDefault() => None
        case Defaulted.Provided(value) => Some((sql""""id"""", sql"${Segment.paramSegment(value: PrecisionTypesId)(using PrecisionTypesId.setter)}::int4"))
      }
    ).flatten
    val q = if (fs.isEmpty) {
      sql"""insert into "public"."precision_types" default values
      returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text
      """
    } else {
      val names  = fs.map { case (n, _) => n }.mkFragment(SqlFragment(", "))
      val values = fs.map { case (_, f) => f }.mkFragment(SqlFragment(", "))
      sql"""insert into "public"."precision_types"($names) values ($values) returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text"""
    }
    q.insertReturning(using PrecisionTypesRow.jdbcDecoder).map(_.updatedKeys.head)
  }

  override def insertStreaming(
    unsaved: ZStream[ZConnection, Throwable, PrecisionTypesRow],
    batchSize: Int = 10000
  ): ZIO[ZConnection, Throwable, Long] = streamingInsert(s"""COPY "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6") FROM STDIN""", batchSize, unsaved)(using PrecisionTypesRow.pgText)

  /** NOTE: this functionality requires PostgreSQL 16 or later! */
  override def insertUnsavedStreaming(
    unsaved: ZStream[ZConnection, Throwable, PrecisionTypesRowUnsaved],
    batchSize: Int = 10000
  ): ZIO[ZConnection, Throwable, Long] = streamingInsert(s"""COPY "public"."precision_types"("string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6", "id") FROM STDIN (DEFAULT '__DEFAULT_VALUE__')""", batchSize, unsaved)(using PrecisionTypesRowUnsaved.pgText)

  override def select: SelectBuilder[PrecisionTypesFields, PrecisionTypesRow] = SelectBuilder.of(""""public"."precision_types"""", PrecisionTypesFields.structure, PrecisionTypesRow.jdbcDecoder)

  override def selectAll: ZStream[ZConnection, Throwable, PrecisionTypesRow] = sql"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text from "public"."precision_types"""".query(using PrecisionTypesRow.jdbcDecoder).selectStream()

  override def selectById(id: PrecisionTypesId): ZIO[ZConnection, Throwable, Option[PrecisionTypesRow]] = sql"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text from "public"."precision_types" where "id" = ${Segment.paramSegment(id)(using PrecisionTypesId.setter)}""".query(using PrecisionTypesRow.jdbcDecoder).selectOne

  override def selectByIds(ids: Array[PrecisionTypesId]): ZStream[ZConnection, Throwable, PrecisionTypesRow] = sql"""select "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text from "public"."precision_types" where "id" = ANY(${Segment.paramSegment(ids)(using PrecisionTypesId.arraySetter)})""".query(using PrecisionTypesRow.jdbcDecoder).selectStream()

  override def selectByIdsTracked(ids: Array[PrecisionTypesId]): ZIO[ZConnection, Throwable, Map[PrecisionTypesId, PrecisionTypesRow]] = {
    selectByIds(ids).runCollect.map { rows =>
      val byId = rows.view.map(x => (x.id, x)).toMap
      ids.view.flatMap(id => byId.get(id).map(x => (id, x))).toMap
    }
  }

  override def update: UpdateBuilder[PrecisionTypesFields, PrecisionTypesRow] = UpdateBuilder.of(""""public"."precision_types"""", PrecisionTypesFields.structure, PrecisionTypesRow.jdbcDecoder)

  override def update(row: PrecisionTypesRow): ZIO[ZConnection, Throwable, Option[PrecisionTypesRow]] = {
    val id = row.id
    sql"""update "public"."precision_types"
    set "string10" = ${Segment.paramSegment(row.string10)(using Setter.stringSetter)},
    "string20" = ${Segment.paramSegment(row.string20)(using Setter.stringSetter)},
    "string50" = ${Segment.paramSegment(row.string50)(using Setter.stringSetter)},
    "string100" = ${Segment.paramSegment(row.string100)(using Setter.stringSetter)},
    "string255" = ${Segment.paramSegment(row.string255)(using Setter.stringSetter)},
    "bpchar3" = ${Segment.paramSegment(row.bpchar3)(using Setter.stringSetter)}::bpchar,
    "bpchar10" = ${Segment.paramSegment(row.bpchar10)(using Setter.stringSetter)}::bpchar,
    "decimal5_2" = ${Segment.paramSegment(row.decimal52)(using Setter.bigDecimalScalaSetter)}::numeric,
    "decimal10_2" = ${Segment.paramSegment(row.decimal102)(using Setter.bigDecimalScalaSetter)}::numeric,
    "decimal18_4" = ${Segment.paramSegment(row.decimal184)(using Setter.bigDecimalScalaSetter)}::numeric,
    "numeric8_2" = ${Segment.paramSegment(row.numeric82)(using Setter.bigDecimalScalaSetter)}::numeric,
    "numeric12_4" = ${Segment.paramSegment(row.numeric124)(using Setter.bigDecimalScalaSetter)}::numeric,
    "timestamp0" = ${Segment.paramSegment(row.timestamp0)(using TypoLocalDateTime.setter)}::timestamp,
    "timestamp3" = ${Segment.paramSegment(row.timestamp3)(using TypoLocalDateTime.setter)}::timestamp,
    "timestamp6" = ${Segment.paramSegment(row.timestamp6)(using TypoLocalDateTime.setter)}::timestamp,
    "timestamptz0" = ${Segment.paramSegment(row.timestamptz0)(using TypoInstant.setter)}::timestamptz,
    "timestamptz3" = ${Segment.paramSegment(row.timestamptz3)(using TypoInstant.setter)}::timestamptz,
    "timestamptz6" = ${Segment.paramSegment(row.timestamptz6)(using TypoInstant.setter)}::timestamptz,
    "time0" = ${Segment.paramSegment(row.time0)(using TypoLocalTime.setter)}::time,
    "time3" = ${Segment.paramSegment(row.time3)(using TypoLocalTime.setter)}::time,
    "time6" = ${Segment.paramSegment(row.time6)(using TypoLocalTime.setter)}::time,
    "timetz0" = ${Segment.paramSegment(row.timetz0)(using TypoOffsetTime.setter)}::timetz,
    "timetz3" = ${Segment.paramSegment(row.timetz3)(using TypoOffsetTime.setter)}::timetz,
    "timetz6" = ${Segment.paramSegment(row.timetz6)(using TypoOffsetTime.setter)}::timetz
    where "id" = ${Segment.paramSegment(id)(using PrecisionTypesId.setter)}
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text"""
      .query(using PrecisionTypesRow.jdbcDecoder)
      .selectOne
  }

  override def upsert(unsaved: PrecisionTypesRow): ZIO[ZConnection, Throwable, UpdateResult[PrecisionTypesRow]] = {
    sql"""insert into "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
    values (
      ${Segment.paramSegment(unsaved.id)(using PrecisionTypesId.setter)}::int4,
    ${Segment.paramSegment(unsaved.string10)(using Setter.stringSetter)},
    ${Segment.paramSegment(unsaved.string20)(using Setter.stringSetter)},
    ${Segment.paramSegment(unsaved.string50)(using Setter.stringSetter)},
    ${Segment.paramSegment(unsaved.string100)(using Setter.stringSetter)},
    ${Segment.paramSegment(unsaved.string255)(using Setter.stringSetter)},
    ${Segment.paramSegment(unsaved.bpchar3)(using Setter.stringSetter)}::bpchar,
    ${Segment.paramSegment(unsaved.bpchar10)(using Setter.stringSetter)}::bpchar,
    ${Segment.paramSegment(unsaved.decimal52)(using Setter.bigDecimalScalaSetter)}::numeric,
    ${Segment.paramSegment(unsaved.decimal102)(using Setter.bigDecimalScalaSetter)}::numeric,
    ${Segment.paramSegment(unsaved.decimal184)(using Setter.bigDecimalScalaSetter)}::numeric,
    ${Segment.paramSegment(unsaved.numeric82)(using Setter.bigDecimalScalaSetter)}::numeric,
    ${Segment.paramSegment(unsaved.numeric124)(using Setter.bigDecimalScalaSetter)}::numeric,
    ${Segment.paramSegment(unsaved.timestamp0)(using TypoLocalDateTime.setter)}::timestamp,
    ${Segment.paramSegment(unsaved.timestamp3)(using TypoLocalDateTime.setter)}::timestamp,
    ${Segment.paramSegment(unsaved.timestamp6)(using TypoLocalDateTime.setter)}::timestamp,
    ${Segment.paramSegment(unsaved.timestamptz0)(using TypoInstant.setter)}::timestamptz,
    ${Segment.paramSegment(unsaved.timestamptz3)(using TypoInstant.setter)}::timestamptz,
    ${Segment.paramSegment(unsaved.timestamptz6)(using TypoInstant.setter)}::timestamptz,
    ${Segment.paramSegment(unsaved.time0)(using TypoLocalTime.setter)}::time,
    ${Segment.paramSegment(unsaved.time3)(using TypoLocalTime.setter)}::time,
    ${Segment.paramSegment(unsaved.time6)(using TypoLocalTime.setter)}::time,
    ${Segment.paramSegment(unsaved.timetz0)(using TypoOffsetTime.setter)}::timetz,
    ${Segment.paramSegment(unsaved.timetz3)(using TypoOffsetTime.setter)}::timetz,
    ${Segment.paramSegment(unsaved.timetz6)(using TypoOffsetTime.setter)}::timetz
    )
    on conflict ("id")
    do update set
      "string10" = EXCLUDED."string10",
    "string20" = EXCLUDED."string20",
    "string50" = EXCLUDED."string50",
    "string100" = EXCLUDED."string100",
    "string255" = EXCLUDED."string255",
    "bpchar3" = EXCLUDED."bpchar3",
    "bpchar10" = EXCLUDED."bpchar10",
    "decimal5_2" = EXCLUDED."decimal5_2",
    "decimal10_2" = EXCLUDED."decimal10_2",
    "decimal18_4" = EXCLUDED."decimal18_4",
    "numeric8_2" = EXCLUDED."numeric8_2",
    "numeric12_4" = EXCLUDED."numeric12_4",
    "timestamp0" = EXCLUDED."timestamp0",
    "timestamp3" = EXCLUDED."timestamp3",
    "timestamp6" = EXCLUDED."timestamp6",
    "timestamptz0" = EXCLUDED."timestamptz0",
    "timestamptz3" = EXCLUDED."timestamptz3",
    "timestamptz6" = EXCLUDED."timestamptz6",
    "time0" = EXCLUDED."time0",
    "time3" = EXCLUDED."time3",
    "time6" = EXCLUDED."time6",
    "timetz0" = EXCLUDED."timetz0",
    "timetz3" = EXCLUDED."timetz3",
    "timetz6" = EXCLUDED."timetz6"
    returning "id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0"::text, "timestamp3"::text, "timestamp6"::text, "timestamptz0"::text, "timestamptz3"::text, "timestamptz6"::text, "time0"::text, "time3"::text, "time6"::text, "timetz0"::text, "timetz3"::text, "timetz6"::text""".insertReturning(using PrecisionTypesRow.jdbcDecoder)
  }

  /** NOTE: this functionality is not safe if you use auto-commit mode! it runs 3 SQL statements */
  override def upsertStreaming(
    unsaved: ZStream[ZConnection, Throwable, PrecisionTypesRow],
    batchSize: Int = 10000
  ): ZIO[ZConnection, Throwable, Long] = {
    val created = sql"""create temporary table precision_types_TEMP (like "public"."precision_types") on commit drop""".execute
    val copied = streamingInsert(s"""copy precision_types_TEMP("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6") from stdin""", batchSize, unsaved)(using PrecisionTypesRow.pgText)
    val merged = sql"""insert into "public"."precision_types"("id", "string10", "string20", "string50", "string100", "string255", "bpchar3", "bpchar10", "decimal5_2", "decimal10_2", "decimal18_4", "numeric8_2", "numeric12_4", "timestamp0", "timestamp3", "timestamp6", "timestamptz0", "timestamptz3", "timestamptz6", "time0", "time3", "time6", "timetz0", "timetz3", "timetz6")
    select * from precision_types_TEMP
    on conflict ("id")
    do update set
      "string10" = EXCLUDED."string10",
    "string20" = EXCLUDED."string20",
    "string50" = EXCLUDED."string50",
    "string100" = EXCLUDED."string100",
    "string255" = EXCLUDED."string255",
    "bpchar3" = EXCLUDED."bpchar3",
    "bpchar10" = EXCLUDED."bpchar10",
    "decimal5_2" = EXCLUDED."decimal5_2",
    "decimal10_2" = EXCLUDED."decimal10_2",
    "decimal18_4" = EXCLUDED."decimal18_4",
    "numeric8_2" = EXCLUDED."numeric8_2",
    "numeric12_4" = EXCLUDED."numeric12_4",
    "timestamp0" = EXCLUDED."timestamp0",
    "timestamp3" = EXCLUDED."timestamp3",
    "timestamp6" = EXCLUDED."timestamp6",
    "timestamptz0" = EXCLUDED."timestamptz0",
    "timestamptz3" = EXCLUDED."timestamptz3",
    "timestamptz6" = EXCLUDED."timestamptz6",
    "time0" = EXCLUDED."time0",
    "time3" = EXCLUDED."time3",
    "time6" = EXCLUDED."time6",
    "timetz0" = EXCLUDED."timetz0",
    "timetz3" = EXCLUDED."timetz3",
    "timetz6" = EXCLUDED."timetz6"
    ;
    drop table precision_types_TEMP;""".update
    created *> copied *> merged
  }
}
/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.precision_types_null;

import static dev.typr.foundations.Fragment.interpolate;

import dev.typr.foundations.Fragment;
import dev.typr.foundations.SqlServerTypes;
import dev.typr.foundations.dsl.DeleteBuilder;
import dev.typr.foundations.dsl.Dialect;
import dev.typr.foundations.dsl.SelectBuilder;
import dev.typr.foundations.dsl.UpdateBuilder;
import java.sql.Connection;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import testdb.precisetypes.Binary10;
import testdb.precisetypes.Binary32;
import testdb.precisetypes.Decimal10_2;
import testdb.precisetypes.Decimal12_4;
import testdb.precisetypes.Decimal18_4;
import testdb.precisetypes.Decimal5_2;
import testdb.precisetypes.Decimal8_2;
import testdb.precisetypes.LocalDateTime3;
import testdb.precisetypes.LocalDateTime7;
import testdb.precisetypes.LocalTime3;
import testdb.precisetypes.LocalTime7;
import testdb.precisetypes.OffsetDateTime3;
import testdb.precisetypes.OffsetDateTime7;
import testdb.precisetypes.PaddedString10;
import testdb.precisetypes.String10;
import testdb.precisetypes.String100;
import testdb.precisetypes.String20;
import testdb.precisetypes.String255;
import testdb.precisetypes.String50;

public class PrecisionTypesNullRepoImpl implements PrecisionTypesNullRepo {
  @Override
  public DeleteBuilder<PrecisionTypesNullFields, PrecisionTypesNullRow> delete() {
    return DeleteBuilder.of(
        "[precision_types_null]", PrecisionTypesNullFields.structure, Dialect.SQLSERVER);
  }

  @Override
  public Boolean deleteById(PrecisionTypesNullId id, Connection c) {
    return interpolate(
                Fragment.lit("delete from [precision_types_null] where [id] = "),
                Fragment.encode(PrecisionTypesNullId.sqlServerType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public Integer deleteByIds(PrecisionTypesNullId[] ids, Connection c) {
    ArrayList<Fragment> fragments = new ArrayList<>();
    for (var id : ids) {
      fragments.add(Fragment.encode(PrecisionTypesNullId.sqlServerType, id));
    }
    ;
    return Fragment.interpolate(
            Fragment.lit("delete from [precision_types_null] where [id] in ("),
            Fragment.comma(fragments),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }

  @Override
  public PrecisionTypesNullRow insert(PrecisionTypesNullRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into [precision_types_null]([string10], [string20], [string50],"
                    + " [string100], [string255], [nstring10], [nstring50], [nstring255], [char10],"
                    + " [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2],"
                    + " [numeric12_4], [binary10], [binary32], [time0], [time3], [time7],"
                    + " [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7])\n"
                    + "OUTPUT INSERTED.[id], INSERTED.[string10], INSERTED.[string20],"
                    + " INSERTED.[string50], INSERTED.[string100], INSERTED.[string255],"
                    + " INSERTED.[nstring10], INSERTED.[nstring50], INSERTED.[nstring255],"
                    + " INSERTED.[char10], INSERTED.[nchar10], INSERTED.[decimal5_2],"
                    + " INSERTED.[decimal10_2], INSERTED.[decimal18_4], INSERTED.[numeric8_2],"
                    + " INSERTED.[numeric12_4], INSERTED.[binary10], INSERTED.[binary32],"
                    + " INSERTED.[time0], INSERTED.[time3], INSERTED.[time7],"
                    + " INSERTED.[datetime2_0], INSERTED.[datetime2_3], INSERTED.[datetime2_7],"
                    + " INSERTED.[dto0], INSERTED.[dto3], INSERTED.[dto7]\n"
                    + "values ("),
            Fragment.encode(String10.sqlServerType.opt(), unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(String20.sqlServerType.opt(), unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(String50.sqlServerType.opt(), unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(String100.sqlServerType.opt(), unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(String255.sqlServerType.opt(), unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(String10.sqlServerType.opt(), unsaved.nstring10()),
            Fragment.lit(", "),
            Fragment.encode(String50.sqlServerType.opt(), unsaved.nstring50()),
            Fragment.lit(", "),
            Fragment.encode(String255.sqlServerType.opt(), unsaved.nstring255()),
            Fragment.lit(", "),
            Fragment.encode(PaddedString10.sqlServerType.opt(), unsaved.char10()),
            Fragment.lit(", "),
            Fragment.encode(PaddedString10.sqlServerType.opt(), unsaved.nchar10()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.sqlServerType.opt(), unsaved.decimal52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.sqlServerType.opt(), unsaved.decimal102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.sqlServerType.opt(), unsaved.decimal184()),
            Fragment.lit(", "),
            Fragment.encode(Decimal8_2.sqlServerType.opt(), unsaved.numeric82()),
            Fragment.lit(", "),
            Fragment.encode(Decimal12_4.sqlServerType.opt(), unsaved.numeric124()),
            Fragment.lit(", "),
            Fragment.encode(Binary10.sqlServerType.opt(), unsaved.binary10()),
            Fragment.lit(", "),
            Fragment.encode(Binary32.sqlServerType.opt(), unsaved.binary32()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.time.opt(), unsaved.time0()),
            Fragment.lit(", "),
            Fragment.encode(LocalTime3.sqlServerType.opt(), unsaved.time3()),
            Fragment.lit(", "),
            Fragment.encode(LocalTime7.sqlServerType.opt(), unsaved.time7()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.datetime2.opt(), unsaved.datetime20()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime3.sqlServerType.opt(), unsaved.datetime23()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime7.sqlServerType.opt(), unsaved.datetime27()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.datetimeoffset.opt(), unsaved.dto0()),
            Fragment.lit(", "),
            Fragment.encode(OffsetDateTime3.sqlServerType.opt(), unsaved.dto3()),
            Fragment.lit(", "),
            Fragment.encode(OffsetDateTime7.sqlServerType.opt(), unsaved.dto7()),
            Fragment.lit(")\n"))
        .updateReturning(PrecisionTypesNullRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public PrecisionTypesNullRow insert(PrecisionTypesNullRowUnsaved unsaved, Connection c) {
    ArrayList<Fragment> columns = new ArrayList<>();
    ;
    ArrayList<Fragment> values = new ArrayList<>();
    ;
    columns.add(Fragment.lit("[string10]"));
    values.add(
        interpolate(
            Fragment.encode(String10.sqlServerType.opt(), unsaved.string10()), Fragment.lit("")));
    columns.add(Fragment.lit("[string20]"));
    values.add(
        interpolate(
            Fragment.encode(String20.sqlServerType.opt(), unsaved.string20()), Fragment.lit("")));
    columns.add(Fragment.lit("[string50]"));
    values.add(
        interpolate(
            Fragment.encode(String50.sqlServerType.opt(), unsaved.string50()), Fragment.lit("")));
    columns.add(Fragment.lit("[string100]"));
    values.add(
        interpolate(
            Fragment.encode(String100.sqlServerType.opt(), unsaved.string100()), Fragment.lit("")));
    columns.add(Fragment.lit("[string255]"));
    values.add(
        interpolate(
            Fragment.encode(String255.sqlServerType.opt(), unsaved.string255()), Fragment.lit("")));
    columns.add(Fragment.lit("[nstring10]"));
    values.add(
        interpolate(
            Fragment.encode(String10.sqlServerType.opt(), unsaved.nstring10()), Fragment.lit("")));
    columns.add(Fragment.lit("[nstring50]"));
    values.add(
        interpolate(
            Fragment.encode(String50.sqlServerType.opt(), unsaved.nstring50()), Fragment.lit("")));
    columns.add(Fragment.lit("[nstring255]"));
    values.add(
        interpolate(
            Fragment.encode(String255.sqlServerType.opt(), unsaved.nstring255()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[char10]"));
    values.add(
        interpolate(
            Fragment.encode(PaddedString10.sqlServerType.opt(), unsaved.char10()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[nchar10]"));
    values.add(
        interpolate(
            Fragment.encode(PaddedString10.sqlServerType.opt(), unsaved.nchar10()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[decimal5_2]"));
    values.add(
        interpolate(
            Fragment.encode(Decimal5_2.sqlServerType.opt(), unsaved.decimal52()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[decimal10_2]"));
    values.add(
        interpolate(
            Fragment.encode(Decimal10_2.sqlServerType.opt(), unsaved.decimal102()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[decimal18_4]"));
    values.add(
        interpolate(
            Fragment.encode(Decimal18_4.sqlServerType.opt(), unsaved.decimal184()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[numeric8_2]"));
    values.add(
        interpolate(
            Fragment.encode(Decimal8_2.sqlServerType.opt(), unsaved.numeric82()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[numeric12_4]"));
    values.add(
        interpolate(
            Fragment.encode(Decimal12_4.sqlServerType.opt(), unsaved.numeric124()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[binary10]"));
    values.add(
        interpolate(
            Fragment.encode(Binary10.sqlServerType.opt(), unsaved.binary10()), Fragment.lit("")));
    columns.add(Fragment.lit("[binary32]"));
    values.add(
        interpolate(
            Fragment.encode(Binary32.sqlServerType.opt(), unsaved.binary32()), Fragment.lit("")));
    columns.add(Fragment.lit("[time0]"));
    values.add(
        interpolate(Fragment.encode(SqlServerTypes.time.opt(), unsaved.time0()), Fragment.lit("")));
    columns.add(Fragment.lit("[time3]"));
    values.add(
        interpolate(
            Fragment.encode(LocalTime3.sqlServerType.opt(), unsaved.time3()), Fragment.lit("")));
    columns.add(Fragment.lit("[time7]"));
    values.add(
        interpolate(
            Fragment.encode(LocalTime7.sqlServerType.opt(), unsaved.time7()), Fragment.lit("")));
    columns.add(Fragment.lit("[datetime2_0]"));
    values.add(
        interpolate(
            Fragment.encode(SqlServerTypes.datetime2.opt(), unsaved.datetime20()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[datetime2_3]"));
    values.add(
        interpolate(
            Fragment.encode(LocalDateTime3.sqlServerType.opt(), unsaved.datetime23()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[datetime2_7]"));
    values.add(
        interpolate(
            Fragment.encode(LocalDateTime7.sqlServerType.opt(), unsaved.datetime27()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[dto0]"));
    values.add(
        interpolate(
            Fragment.encode(SqlServerTypes.datetimeoffset.opt(), unsaved.dto0()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[dto3]"));
    values.add(
        interpolate(
            Fragment.encode(OffsetDateTime3.sqlServerType.opt(), unsaved.dto3()),
            Fragment.lit("")));
    columns.add(Fragment.lit("[dto7]"));
    values.add(
        interpolate(
            Fragment.encode(OffsetDateTime7.sqlServerType.opt(), unsaved.dto7()),
            Fragment.lit("")));
    Fragment q =
        interpolate(
            Fragment.lit("insert into [precision_types_null]("),
            Fragment.comma(columns),
            Fragment.lit(
                ")\n"
                    + "OUTPUT INSERTED.[id], INSERTED.[string10], INSERTED.[string20],"
                    + " INSERTED.[string50], INSERTED.[string100], INSERTED.[string255],"
                    + " INSERTED.[nstring10], INSERTED.[nstring50], INSERTED.[nstring255],"
                    + " INSERTED.[char10], INSERTED.[nchar10], INSERTED.[decimal5_2],"
                    + " INSERTED.[decimal10_2], INSERTED.[decimal18_4], INSERTED.[numeric8_2],"
                    + " INSERTED.[numeric12_4], INSERTED.[binary10], INSERTED.[binary32],"
                    + " INSERTED.[time0], INSERTED.[time3], INSERTED.[time7],"
                    + " INSERTED.[datetime2_0], INSERTED.[datetime2_3], INSERTED.[datetime2_7],"
                    + " INSERTED.[dto0], INSERTED.[dto3], INSERTED.[dto7]\n"
                    + "values ("),
            Fragment.comma(values),
            Fragment.lit(")\n"));
    ;
    return q.updateReturning(PrecisionTypesNullRow._rowParser.exactlyOne()).runUnchecked(c);
  }

  @Override
  public SelectBuilder<PrecisionTypesNullFields, PrecisionTypesNullRow> select() {
    return SelectBuilder.of(
        "[precision_types_null]",
        PrecisionTypesNullFields.structure,
        PrecisionTypesNullRow._rowParser,
        Dialect.SQLSERVER);
  }

  @Override
  public List<PrecisionTypesNullRow> selectAll(Connection c) {
    return interpolate(
            Fragment.lit(
                "select [id], [string10], [string20], [string50], [string100], [string255],"
                    + " [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2],"
                    + " [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10],"
                    + " [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3],"
                    + " [datetime2_7], [dto0], [dto3], [dto7]\n"
                    + "from [precision_types_null]\n"))
        .query(PrecisionTypesNullRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Optional<PrecisionTypesNullRow> selectById(PrecisionTypesNullId id, Connection c) {
    return interpolate(
            Fragment.lit(
                "select [id], [string10], [string20], [string50], [string100], [string255],"
                    + " [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2],"
                    + " [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10],"
                    + " [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3],"
                    + " [datetime2_7], [dto0], [dto3], [dto7]\n"
                    + "from [precision_types_null]\n"
                    + "where [id] = "),
            Fragment.encode(PrecisionTypesNullId.sqlServerType, id),
            Fragment.lit(""))
        .query(PrecisionTypesNullRow._rowParser.first())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesNullRow> selectByIds(PrecisionTypesNullId[] ids, Connection c) {
    ArrayList<Fragment> fragments = new ArrayList<>();
    for (var id : ids) {
      fragments.add(Fragment.encode(PrecisionTypesNullId.sqlServerType, id));
    }
    ;
    return Fragment.interpolate(
            Fragment.lit(
                "select [id], [string10], [string20], [string50], [string100], [string255],"
                    + " [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2],"
                    + " [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10],"
                    + " [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3],"
                    + " [datetime2_7], [dto0], [dto3], [dto7] from [precision_types_null] where"
                    + " [id] in ("),
            Fragment.comma(fragments),
            Fragment.lit(")"))
        .query(PrecisionTypesNullRow._rowParser.all())
        .runUnchecked(c);
  }

  @Override
  public Map<PrecisionTypesNullId, PrecisionTypesNullRow> selectByIdsTracked(
      PrecisionTypesNullId[] ids, Connection c) {
    HashMap<PrecisionTypesNullId, PrecisionTypesNullRow> ret =
        new HashMap<PrecisionTypesNullId, PrecisionTypesNullRow>();
    selectByIds(ids, c).forEach(row -> ret.put(row.id(), row));
    return ret;
  }

  @Override
  public UpdateBuilder<PrecisionTypesNullFields, PrecisionTypesNullRow> update() {
    return UpdateBuilder.of(
        "[precision_types_null]",
        PrecisionTypesNullFields.structure,
        PrecisionTypesNullRow._rowParser,
        Dialect.SQLSERVER);
  }

  @Override
  public Boolean update(PrecisionTypesNullRow row, Connection c) {
    PrecisionTypesNullId id = row.id();
    ;
    return interpolate(
                Fragment.lit("update [precision_types_null]\nset [string10] = "),
                Fragment.encode(String10.sqlServerType.opt(), row.string10()),
                Fragment.lit(",\n[string20] = "),
                Fragment.encode(String20.sqlServerType.opt(), row.string20()),
                Fragment.lit(",\n[string50] = "),
                Fragment.encode(String50.sqlServerType.opt(), row.string50()),
                Fragment.lit(",\n[string100] = "),
                Fragment.encode(String100.sqlServerType.opt(), row.string100()),
                Fragment.lit(",\n[string255] = "),
                Fragment.encode(String255.sqlServerType.opt(), row.string255()),
                Fragment.lit(",\n[nstring10] = "),
                Fragment.encode(String10.sqlServerType.opt(), row.nstring10()),
                Fragment.lit(",\n[nstring50] = "),
                Fragment.encode(String50.sqlServerType.opt(), row.nstring50()),
                Fragment.lit(",\n[nstring255] = "),
                Fragment.encode(String255.sqlServerType.opt(), row.nstring255()),
                Fragment.lit(",\n[char10] = "),
                Fragment.encode(PaddedString10.sqlServerType.opt(), row.char10()),
                Fragment.lit(",\n[nchar10] = "),
                Fragment.encode(PaddedString10.sqlServerType.opt(), row.nchar10()),
                Fragment.lit(",\n[decimal5_2] = "),
                Fragment.encode(Decimal5_2.sqlServerType.opt(), row.decimal52()),
                Fragment.lit(",\n[decimal10_2] = "),
                Fragment.encode(Decimal10_2.sqlServerType.opt(), row.decimal102()),
                Fragment.lit(",\n[decimal18_4] = "),
                Fragment.encode(Decimal18_4.sqlServerType.opt(), row.decimal184()),
                Fragment.lit(",\n[numeric8_2] = "),
                Fragment.encode(Decimal8_2.sqlServerType.opt(), row.numeric82()),
                Fragment.lit(",\n[numeric12_4] = "),
                Fragment.encode(Decimal12_4.sqlServerType.opt(), row.numeric124()),
                Fragment.lit(",\n[binary10] = "),
                Fragment.encode(Binary10.sqlServerType.opt(), row.binary10()),
                Fragment.lit(",\n[binary32] = "),
                Fragment.encode(Binary32.sqlServerType.opt(), row.binary32()),
                Fragment.lit(",\n[time0] = "),
                Fragment.encode(SqlServerTypes.time.opt(), row.time0()),
                Fragment.lit(",\n[time3] = "),
                Fragment.encode(LocalTime3.sqlServerType.opt(), row.time3()),
                Fragment.lit(",\n[time7] = "),
                Fragment.encode(LocalTime7.sqlServerType.opt(), row.time7()),
                Fragment.lit(",\n[datetime2_0] = "),
                Fragment.encode(SqlServerTypes.datetime2.opt(), row.datetime20()),
                Fragment.lit(",\n[datetime2_3] = "),
                Fragment.encode(LocalDateTime3.sqlServerType.opt(), row.datetime23()),
                Fragment.lit(",\n[datetime2_7] = "),
                Fragment.encode(LocalDateTime7.sqlServerType.opt(), row.datetime27()),
                Fragment.lit(",\n[dto0] = "),
                Fragment.encode(SqlServerTypes.datetimeoffset.opt(), row.dto0()),
                Fragment.lit(",\n[dto3] = "),
                Fragment.encode(OffsetDateTime3.sqlServerType.opt(), row.dto3()),
                Fragment.lit(",\n[dto7] = "),
                Fragment.encode(OffsetDateTime7.sqlServerType.opt(), row.dto7()),
                Fragment.lit("\nwhere [id] = "),
                Fragment.encode(PrecisionTypesNullId.sqlServerType, id),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }

  @Override
  public PrecisionTypesNullRow upsert(PrecisionTypesNullRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit("MERGE INTO [precision_types_null] AS target\nUSING (VALUES ("),
            Fragment.encode(PrecisionTypesNullId.sqlServerType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(String10.sqlServerType.opt(), unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(String20.sqlServerType.opt(), unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(String50.sqlServerType.opt(), unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(String100.sqlServerType.opt(), unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(String255.sqlServerType.opt(), unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(String10.sqlServerType.opt(), unsaved.nstring10()),
            Fragment.lit(", "),
            Fragment.encode(String50.sqlServerType.opt(), unsaved.nstring50()),
            Fragment.lit(", "),
            Fragment.encode(String255.sqlServerType.opt(), unsaved.nstring255()),
            Fragment.lit(", "),
            Fragment.encode(PaddedString10.sqlServerType.opt(), unsaved.char10()),
            Fragment.lit(", "),
            Fragment.encode(PaddedString10.sqlServerType.opt(), unsaved.nchar10()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.sqlServerType.opt(), unsaved.decimal52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.sqlServerType.opt(), unsaved.decimal102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.sqlServerType.opt(), unsaved.decimal184()),
            Fragment.lit(", "),
            Fragment.encode(Decimal8_2.sqlServerType.opt(), unsaved.numeric82()),
            Fragment.lit(", "),
            Fragment.encode(Decimal12_4.sqlServerType.opt(), unsaved.numeric124()),
            Fragment.lit(", "),
            Fragment.encode(Binary10.sqlServerType.opt(), unsaved.binary10()),
            Fragment.lit(", "),
            Fragment.encode(Binary32.sqlServerType.opt(), unsaved.binary32()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.time.opt(), unsaved.time0()),
            Fragment.lit(", "),
            Fragment.encode(LocalTime3.sqlServerType.opt(), unsaved.time3()),
            Fragment.lit(", "),
            Fragment.encode(LocalTime7.sqlServerType.opt(), unsaved.time7()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.datetime2.opt(), unsaved.datetime20()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime3.sqlServerType.opt(), unsaved.datetime23()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime7.sqlServerType.opt(), unsaved.datetime27()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.datetimeoffset.opt(), unsaved.dto0()),
            Fragment.lit(", "),
            Fragment.encode(OffsetDateTime3.sqlServerType.opt(), unsaved.dto3()),
            Fragment.lit(", "),
            Fragment.encode(OffsetDateTime7.sqlServerType.opt(), unsaved.dto7()),
            Fragment.lit(
                ")) AS source([id], [string10], [string20], [string50], [string100], [string255],"
                    + " [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2],"
                    + " [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10],"
                    + " [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3],"
                    + " [datetime2_7], [dto0], [dto3], [dto7])\n"
                    + "ON target.[id] = source.[id]\n"
                    + "WHEN MATCHED THEN UPDATE SET [string10] = source.[string10],\n"
                    + "[string20] = source.[string20],\n"
                    + "[string50] = source.[string50],\n"
                    + "[string100] = source.[string100],\n"
                    + "[string255] = source.[string255],\n"
                    + "[nstring10] = source.[nstring10],\n"
                    + "[nstring50] = source.[nstring50],\n"
                    + "[nstring255] = source.[nstring255],\n"
                    + "[char10] = source.[char10],\n"
                    + "[nchar10] = source.[nchar10],\n"
                    + "[decimal5_2] = source.[decimal5_2],\n"
                    + "[decimal10_2] = source.[decimal10_2],\n"
                    + "[decimal18_4] = source.[decimal18_4],\n"
                    + "[numeric8_2] = source.[numeric8_2],\n"
                    + "[numeric12_4] = source.[numeric12_4],\n"
                    + "[binary10] = source.[binary10],\n"
                    + "[binary32] = source.[binary32],\n"
                    + "[time0] = source.[time0],\n"
                    + "[time3] = source.[time3],\n"
                    + "[time7] = source.[time7],\n"
                    + "[datetime2_0] = source.[datetime2_0],\n"
                    + "[datetime2_3] = source.[datetime2_3],\n"
                    + "[datetime2_7] = source.[datetime2_7],\n"
                    + "[dto0] = source.[dto0],\n"
                    + "[dto3] = source.[dto3],\n"
                    + "[dto7] = source.[dto7]\n"
                    + "WHEN NOT MATCHED THEN INSERT ([id], [string10], [string20], [string50],"
                    + " [string100], [string255], [nstring10], [nstring50], [nstring255], [char10],"
                    + " [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2],"
                    + " [numeric12_4], [binary10], [binary32], [time0], [time3], [time7],"
                    + " [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7]) VALUES"
                    + " ("),
            Fragment.encode(PrecisionTypesNullId.sqlServerType, unsaved.id()),
            Fragment.lit(", "),
            Fragment.encode(String10.sqlServerType.opt(), unsaved.string10()),
            Fragment.lit(", "),
            Fragment.encode(String20.sqlServerType.opt(), unsaved.string20()),
            Fragment.lit(", "),
            Fragment.encode(String50.sqlServerType.opt(), unsaved.string50()),
            Fragment.lit(", "),
            Fragment.encode(String100.sqlServerType.opt(), unsaved.string100()),
            Fragment.lit(", "),
            Fragment.encode(String255.sqlServerType.opt(), unsaved.string255()),
            Fragment.lit(", "),
            Fragment.encode(String10.sqlServerType.opt(), unsaved.nstring10()),
            Fragment.lit(", "),
            Fragment.encode(String50.sqlServerType.opt(), unsaved.nstring50()),
            Fragment.lit(", "),
            Fragment.encode(String255.sqlServerType.opt(), unsaved.nstring255()),
            Fragment.lit(", "),
            Fragment.encode(PaddedString10.sqlServerType.opt(), unsaved.char10()),
            Fragment.lit(", "),
            Fragment.encode(PaddedString10.sqlServerType.opt(), unsaved.nchar10()),
            Fragment.lit(", "),
            Fragment.encode(Decimal5_2.sqlServerType.opt(), unsaved.decimal52()),
            Fragment.lit(", "),
            Fragment.encode(Decimal10_2.sqlServerType.opt(), unsaved.decimal102()),
            Fragment.lit(", "),
            Fragment.encode(Decimal18_4.sqlServerType.opt(), unsaved.decimal184()),
            Fragment.lit(", "),
            Fragment.encode(Decimal8_2.sqlServerType.opt(), unsaved.numeric82()),
            Fragment.lit(", "),
            Fragment.encode(Decimal12_4.sqlServerType.opt(), unsaved.numeric124()),
            Fragment.lit(", "),
            Fragment.encode(Binary10.sqlServerType.opt(), unsaved.binary10()),
            Fragment.lit(", "),
            Fragment.encode(Binary32.sqlServerType.opt(), unsaved.binary32()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.time.opt(), unsaved.time0()),
            Fragment.lit(", "),
            Fragment.encode(LocalTime3.sqlServerType.opt(), unsaved.time3()),
            Fragment.lit(", "),
            Fragment.encode(LocalTime7.sqlServerType.opt(), unsaved.time7()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.datetime2.opt(), unsaved.datetime20()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime3.sqlServerType.opt(), unsaved.datetime23()),
            Fragment.lit(", "),
            Fragment.encode(LocalDateTime7.sqlServerType.opt(), unsaved.datetime27()),
            Fragment.lit(", "),
            Fragment.encode(SqlServerTypes.datetimeoffset.opt(), unsaved.dto0()),
            Fragment.lit(", "),
            Fragment.encode(OffsetDateTime3.sqlServerType.opt(), unsaved.dto3()),
            Fragment.lit(", "),
            Fragment.encode(OffsetDateTime7.sqlServerType.opt(), unsaved.dto7()),
            Fragment.lit(
                ")\n"
                    + "OUTPUT INSERTED.[id], INSERTED.[string10], INSERTED.[string20],"
                    + " INSERTED.[string50], INSERTED.[string100], INSERTED.[string255],"
                    + " INSERTED.[nstring10], INSERTED.[nstring50], INSERTED.[nstring255],"
                    + " INSERTED.[char10], INSERTED.[nchar10], INSERTED.[decimal5_2],"
                    + " INSERTED.[decimal10_2], INSERTED.[decimal18_4], INSERTED.[numeric8_2],"
                    + " INSERTED.[numeric12_4], INSERTED.[binary10], INSERTED.[binary32],"
                    + " INSERTED.[time0], INSERTED.[time3], INSERTED.[time7],"
                    + " INSERTED.[datetime2_0], INSERTED.[datetime2_3], INSERTED.[datetime2_7],"
                    + " INSERTED.[dto0], INSERTED.[dto3], INSERTED.[dto7];"))
        .updateReturning(PrecisionTypesNullRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }

  @Override
  public List<PrecisionTypesNullRow> upsertBatch(
      Iterator<PrecisionTypesNullRow> unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "MERGE INTO [precision_types_null] AS target\n"
                    + "USING (VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,"
                    + " ?, ?, ?, ?, ?, ?, ?)) AS source([id], [string10], [string20], [string50],"
                    + " [string100], [string255], [nstring10], [nstring50], [nstring255], [char10],"
                    + " [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2],"
                    + " [numeric12_4], [binary10], [binary32], [time0], [time3], [time7],"
                    + " [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7])\n"
                    + "ON target.[id] = source.[id]\n"
                    + "WHEN MATCHED THEN UPDATE SET [string10] = source.[string10],\n"
                    + "[string20] = source.[string20],\n"
                    + "[string50] = source.[string50],\n"
                    + "[string100] = source.[string100],\n"
                    + "[string255] = source.[string255],\n"
                    + "[nstring10] = source.[nstring10],\n"
                    + "[nstring50] = source.[nstring50],\n"
                    + "[nstring255] = source.[nstring255],\n"
                    + "[char10] = source.[char10],\n"
                    + "[nchar10] = source.[nchar10],\n"
                    + "[decimal5_2] = source.[decimal5_2],\n"
                    + "[decimal10_2] = source.[decimal10_2],\n"
                    + "[decimal18_4] = source.[decimal18_4],\n"
                    + "[numeric8_2] = source.[numeric8_2],\n"
                    + "[numeric12_4] = source.[numeric12_4],\n"
                    + "[binary10] = source.[binary10],\n"
                    + "[binary32] = source.[binary32],\n"
                    + "[time0] = source.[time0],\n"
                    + "[time3] = source.[time3],\n"
                    + "[time7] = source.[time7],\n"
                    + "[datetime2_0] = source.[datetime2_0],\n"
                    + "[datetime2_3] = source.[datetime2_3],\n"
                    + "[datetime2_7] = source.[datetime2_7],\n"
                    + "[dto0] = source.[dto0],\n"
                    + "[dto3] = source.[dto3],\n"
                    + "[dto7] = source.[dto7]\n"
                    + "WHEN NOT MATCHED THEN INSERT ([id], [string10], [string20], [string50],"
                    + " [string100], [string255], [nstring10], [nstring50], [nstring255], [char10],"
                    + " [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2],"
                    + " [numeric12_4], [binary10], [binary32], [time0], [time3], [time7],"
                    + " [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7]) VALUES"
                    + " (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,"
                    + " ?, ?)\n"
                    + "OUTPUT INSERTED.[id], INSERTED.[string10], INSERTED.[string20],"
                    + " INSERTED.[string50], INSERTED.[string100], INSERTED.[string255],"
                    + " INSERTED.[nstring10], INSERTED.[nstring50], INSERTED.[nstring255],"
                    + " INSERTED.[char10], INSERTED.[nchar10], INSERTED.[decimal5_2],"
                    + " INSERTED.[decimal10_2], INSERTED.[decimal18_4], INSERTED.[numeric8_2],"
                    + " INSERTED.[numeric12_4], INSERTED.[binary10], INSERTED.[binary32],"
                    + " INSERTED.[time0], INSERTED.[time3], INSERTED.[time7],"
                    + " INSERTED.[datetime2_0], INSERTED.[datetime2_3], INSERTED.[datetime2_7],"
                    + " INSERTED.[dto0], INSERTED.[dto3], INSERTED.[dto7];"))
        .updateReturningEach(PrecisionTypesNullRow._rowParser, unsaved)
        .runUnchecked(c);
  }
}

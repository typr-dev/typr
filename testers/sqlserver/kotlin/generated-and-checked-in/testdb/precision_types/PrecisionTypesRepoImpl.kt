/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.precision_types

import dev.typr.foundations.SqlServerTypes
import dev.typr.foundations.kotlin.DeleteBuilder
import dev.typr.foundations.kotlin.Dialect
import dev.typr.foundations.kotlin.Fragment
import dev.typr.foundations.kotlin.SelectBuilder
import dev.typr.foundations.kotlin.UpdateBuilder
import java.sql.Connection
import java.util.ArrayList
import kotlin.collections.Iterator
import kotlin.collections.List
import kotlin.collections.Map
import kotlin.collections.MutableMap
import testdb.precisetypes.Binary10
import testdb.precisetypes.Binary32
import testdb.precisetypes.Decimal10_2
import testdb.precisetypes.Decimal12_4
import testdb.precisetypes.Decimal18_4
import testdb.precisetypes.Decimal5_2
import testdb.precisetypes.Decimal8_2
import testdb.precisetypes.LocalDateTime3
import testdb.precisetypes.LocalDateTime7
import testdb.precisetypes.LocalTime3
import testdb.precisetypes.LocalTime7
import testdb.precisetypes.OffsetDateTime3
import testdb.precisetypes.OffsetDateTime7
import testdb.precisetypes.PaddedString10
import testdb.precisetypes.String10
import testdb.precisetypes.String100
import testdb.precisetypes.String20
import testdb.precisetypes.String255
import testdb.precisetypes.String50

class PrecisionTypesRepoImpl() : PrecisionTypesRepo {
  override fun delete(): DeleteBuilder<PrecisionTypesFields, PrecisionTypesRow> = DeleteBuilder.of("[precision_types]", PrecisionTypesFields.structure, Dialect.SQLSERVER)

  override fun deleteById(
    id: PrecisionTypesId,
    c: Connection
  ): Boolean = Fragment.interpolate(Fragment.lit("delete from [precision_types] where [id] = "), Fragment.encode(PrecisionTypesId.sqlServerType, id), Fragment.lit("")).update().runUnchecked(c) > 0

  override fun deleteByIds(
    ids: Array<PrecisionTypesId>,
    c: Connection
  ): Int {
    val fragments: ArrayList<Fragment> = ArrayList()
    for (id in ids) { fragments.add(Fragment.encode(PrecisionTypesId.sqlServerType, id)) }
    return Fragment.interpolate(Fragment.lit("delete from [precision_types] where [id] in ("), Fragment.comma(fragments.toMutableList()), Fragment.lit(")")).update().runUnchecked(c)
  }

  override fun insert(
    unsaved: PrecisionTypesRow,
    c: Connection
  ): PrecisionTypesRow = Fragment.interpolate(Fragment.lit("insert into [precision_types]([string10], [string20], [string50], [string100], [string255], [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10], [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7])\nOUTPUT INSERTED.[id], INSERTED.[string10], INSERTED.[string20], INSERTED.[string50], INSERTED.[string100], INSERTED.[string255], INSERTED.[nstring10], INSERTED.[nstring50], INSERTED.[nstring255], INSERTED.[char10], INSERTED.[nchar10], INSERTED.[decimal5_2], INSERTED.[decimal10_2], INSERTED.[decimal18_4], INSERTED.[numeric8_2], INSERTED.[numeric12_4], INSERTED.[binary10], INSERTED.[binary32], INSERTED.[time0], INSERTED.[time3], INSERTED.[time7], INSERTED.[datetime2_0], INSERTED.[datetime2_3], INSERTED.[datetime2_7], INSERTED.[dto0], INSERTED.[dto3], INSERTED.[dto7]\nvalues ("), Fragment.encode(String10.sqlServerType, unsaved.string10), Fragment.lit(", "), Fragment.encode(String20.sqlServerType, unsaved.string20), Fragment.lit(", "), Fragment.encode(String50.sqlServerType, unsaved.string50), Fragment.lit(", "), Fragment.encode(String100.sqlServerType, unsaved.string100), Fragment.lit(", "), Fragment.encode(String255.sqlServerType, unsaved.string255), Fragment.lit(", "), Fragment.encode(String10.sqlServerType, unsaved.nstring10), Fragment.lit(", "), Fragment.encode(String50.sqlServerType, unsaved.nstring50), Fragment.lit(", "), Fragment.encode(String255.sqlServerType, unsaved.nstring255), Fragment.lit(", "), Fragment.encode(PaddedString10.sqlServerType, unsaved.char10), Fragment.lit(", "), Fragment.encode(PaddedString10.sqlServerType, unsaved.nchar10), Fragment.lit(", "), Fragment.encode(Decimal5_2.sqlServerType, unsaved.decimal52), Fragment.lit(", "), Fragment.encode(Decimal10_2.sqlServerType, unsaved.decimal102), Fragment.lit(", "), Fragment.encode(Decimal18_4.sqlServerType, unsaved.decimal184), Fragment.lit(", "), Fragment.encode(Decimal8_2.sqlServerType, unsaved.numeric82), Fragment.lit(", "), Fragment.encode(Decimal12_4.sqlServerType, unsaved.numeric124), Fragment.lit(", "), Fragment.encode(Binary10.sqlServerType, unsaved.binary10), Fragment.lit(", "), Fragment.encode(Binary32.sqlServerType, unsaved.binary32), Fragment.lit(", "), Fragment.encode(SqlServerTypes.time, unsaved.time0), Fragment.lit(", "), Fragment.encode(LocalTime3.sqlServerType, unsaved.time3), Fragment.lit(", "), Fragment.encode(LocalTime7.sqlServerType, unsaved.time7), Fragment.lit(", "), Fragment.encode(SqlServerTypes.datetime2, unsaved.datetime20), Fragment.lit(", "), Fragment.encode(LocalDateTime3.sqlServerType, unsaved.datetime23), Fragment.lit(", "), Fragment.encode(LocalDateTime7.sqlServerType, unsaved.datetime27), Fragment.lit(", "), Fragment.encode(SqlServerTypes.datetimeoffset, unsaved.dto0), Fragment.lit(", "), Fragment.encode(OffsetDateTime3.sqlServerType, unsaved.dto3), Fragment.lit(", "), Fragment.encode(OffsetDateTime7.sqlServerType, unsaved.dto7), Fragment.lit(")\n"))
    .updateReturning(PrecisionTypesRow._rowParser.exactlyOne()).runUnchecked(c)

  override fun insert(
    unsaved: PrecisionTypesRowUnsaved,
    c: Connection
  ): PrecisionTypesRow {
    val columns: ArrayList<Fragment> = ArrayList()
    val values: ArrayList<Fragment> = ArrayList()
    columns.add(Fragment.lit("[string10]"))
    values.add(Fragment.interpolate(Fragment.encode(String10.sqlServerType, unsaved.string10), Fragment.lit("")))
    columns.add(Fragment.lit("[string20]"))
    values.add(Fragment.interpolate(Fragment.encode(String20.sqlServerType, unsaved.string20), Fragment.lit("")))
    columns.add(Fragment.lit("[string50]"))
    values.add(Fragment.interpolate(Fragment.encode(String50.sqlServerType, unsaved.string50), Fragment.lit("")))
    columns.add(Fragment.lit("[string100]"))
    values.add(Fragment.interpolate(Fragment.encode(String100.sqlServerType, unsaved.string100), Fragment.lit("")))
    columns.add(Fragment.lit("[string255]"))
    values.add(Fragment.interpolate(Fragment.encode(String255.sqlServerType, unsaved.string255), Fragment.lit("")))
    columns.add(Fragment.lit("[nstring10]"))
    values.add(Fragment.interpolate(Fragment.encode(String10.sqlServerType, unsaved.nstring10), Fragment.lit("")))
    columns.add(Fragment.lit("[nstring50]"))
    values.add(Fragment.interpolate(Fragment.encode(String50.sqlServerType, unsaved.nstring50), Fragment.lit("")))
    columns.add(Fragment.lit("[nstring255]"))
    values.add(Fragment.interpolate(Fragment.encode(String255.sqlServerType, unsaved.nstring255), Fragment.lit("")))
    columns.add(Fragment.lit("[char10]"))
    values.add(Fragment.interpolate(Fragment.encode(PaddedString10.sqlServerType, unsaved.char10), Fragment.lit("")))
    columns.add(Fragment.lit("[nchar10]"))
    values.add(Fragment.interpolate(Fragment.encode(PaddedString10.sqlServerType, unsaved.nchar10), Fragment.lit("")))
    columns.add(Fragment.lit("[decimal5_2]"))
    values.add(Fragment.interpolate(Fragment.encode(Decimal5_2.sqlServerType, unsaved.decimal52), Fragment.lit("")))
    columns.add(Fragment.lit("[decimal10_2]"))
    values.add(Fragment.interpolate(Fragment.encode(Decimal10_2.sqlServerType, unsaved.decimal102), Fragment.lit("")))
    columns.add(Fragment.lit("[decimal18_4]"))
    values.add(Fragment.interpolate(Fragment.encode(Decimal18_4.sqlServerType, unsaved.decimal184), Fragment.lit("")))
    columns.add(Fragment.lit("[numeric8_2]"))
    values.add(Fragment.interpolate(Fragment.encode(Decimal8_2.sqlServerType, unsaved.numeric82), Fragment.lit("")))
    columns.add(Fragment.lit("[numeric12_4]"))
    values.add(Fragment.interpolate(Fragment.encode(Decimal12_4.sqlServerType, unsaved.numeric124), Fragment.lit("")))
    columns.add(Fragment.lit("[binary10]"))
    values.add(Fragment.interpolate(Fragment.encode(Binary10.sqlServerType, unsaved.binary10), Fragment.lit("")))
    columns.add(Fragment.lit("[binary32]"))
    values.add(Fragment.interpolate(Fragment.encode(Binary32.sqlServerType, unsaved.binary32), Fragment.lit("")))
    columns.add(Fragment.lit("[time0]"))
    values.add(Fragment.interpolate(Fragment.encode(SqlServerTypes.time, unsaved.time0), Fragment.lit("")))
    columns.add(Fragment.lit("[time3]"))
    values.add(Fragment.interpolate(Fragment.encode(LocalTime3.sqlServerType, unsaved.time3), Fragment.lit("")))
    columns.add(Fragment.lit("[time7]"))
    values.add(Fragment.interpolate(Fragment.encode(LocalTime7.sqlServerType, unsaved.time7), Fragment.lit("")))
    columns.add(Fragment.lit("[datetime2_0]"))
    values.add(Fragment.interpolate(Fragment.encode(SqlServerTypes.datetime2, unsaved.datetime20), Fragment.lit("")))
    columns.add(Fragment.lit("[datetime2_3]"))
    values.add(Fragment.interpolate(Fragment.encode(LocalDateTime3.sqlServerType, unsaved.datetime23), Fragment.lit("")))
    columns.add(Fragment.lit("[datetime2_7]"))
    values.add(Fragment.interpolate(Fragment.encode(LocalDateTime7.sqlServerType, unsaved.datetime27), Fragment.lit("")))
    columns.add(Fragment.lit("[dto0]"))
    values.add(Fragment.interpolate(Fragment.encode(SqlServerTypes.datetimeoffset, unsaved.dto0), Fragment.lit("")))
    columns.add(Fragment.lit("[dto3]"))
    values.add(Fragment.interpolate(Fragment.encode(OffsetDateTime3.sqlServerType, unsaved.dto3), Fragment.lit("")))
    columns.add(Fragment.lit("[dto7]"))
    values.add(Fragment.interpolate(Fragment.encode(OffsetDateTime7.sqlServerType, unsaved.dto7), Fragment.lit("")))
    val q: Fragment = Fragment.interpolate(Fragment.lit("insert into [precision_types]("), Fragment.comma(columns.toMutableList()), Fragment.lit(")\nOUTPUT INSERTED.[id], INSERTED.[string10], INSERTED.[string20], INSERTED.[string50], INSERTED.[string100], INSERTED.[string255], INSERTED.[nstring10], INSERTED.[nstring50], INSERTED.[nstring255], INSERTED.[char10], INSERTED.[nchar10], INSERTED.[decimal5_2], INSERTED.[decimal10_2], INSERTED.[decimal18_4], INSERTED.[numeric8_2], INSERTED.[numeric12_4], INSERTED.[binary10], INSERTED.[binary32], INSERTED.[time0], INSERTED.[time3], INSERTED.[time7], INSERTED.[datetime2_0], INSERTED.[datetime2_3], INSERTED.[datetime2_7], INSERTED.[dto0], INSERTED.[dto3], INSERTED.[dto7]\nvalues ("), Fragment.comma(values.toMutableList()), Fragment.lit(")\n"))
    return q.updateReturning(PrecisionTypesRow._rowParser.exactlyOne()).runUnchecked(c)
  }

  override fun select(): SelectBuilder<PrecisionTypesFields, PrecisionTypesRow> = SelectBuilder.of("[precision_types]", PrecisionTypesFields.structure, PrecisionTypesRow._rowParser, Dialect.SQLSERVER)

  override fun selectAll(c: Connection): List<PrecisionTypesRow> = Fragment.interpolate(Fragment.lit("select [id], [string10], [string20], [string50], [string100], [string255], [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10], [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7]\nfrom [precision_types]\n")).query(PrecisionTypesRow._rowParser.all()).runUnchecked(c)

  override fun selectById(
    id: PrecisionTypesId,
    c: Connection
  ): PrecisionTypesRow? = Fragment.interpolate(Fragment.lit("select [id], [string10], [string20], [string50], [string100], [string255], [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10], [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7]\nfrom [precision_types]\nwhere [id] = "), Fragment.encode(PrecisionTypesId.sqlServerType, id), Fragment.lit("")).query(PrecisionTypesRow._rowParser.first()).runUnchecked(c)

  override fun selectByIds(
    ids: Array<PrecisionTypesId>,
    c: Connection
  ): List<PrecisionTypesRow> {
    val fragments: ArrayList<Fragment> = ArrayList()
    for (id in ids) { fragments.add(Fragment.encode(PrecisionTypesId.sqlServerType, id)) }
    return Fragment.interpolate(Fragment.lit("select [id], [string10], [string20], [string50], [string100], [string255], [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10], [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7] from [precision_types] where [id] in ("), Fragment.comma(fragments.toMutableList()), Fragment.lit(")")).query(PrecisionTypesRow._rowParser.all()).runUnchecked(c)
  }

  override fun selectByIdsTracked(
    ids: Array<PrecisionTypesId>,
    c: Connection
  ): Map<PrecisionTypesId, PrecisionTypesRow> {
    val ret: MutableMap<PrecisionTypesId, PrecisionTypesRow> = mutableMapOf<PrecisionTypesId, PrecisionTypesRow>()
    selectByIds(ids, c).forEach({ row -> ret.put(row.id, row) })
    return ret.toMap()
  }

  override fun update(): UpdateBuilder<PrecisionTypesFields, PrecisionTypesRow> = UpdateBuilder.of("[precision_types]", PrecisionTypesFields.structure, PrecisionTypesRow._rowParser, Dialect.SQLSERVER)

  override fun update(
    row: PrecisionTypesRow,
    c: Connection
  ): Boolean {
    val id: PrecisionTypesId = row.id
    return Fragment.interpolate(Fragment.lit("update [precision_types]\nset [string10] = "), Fragment.encode(String10.sqlServerType, row.string10), Fragment.lit(",\n[string20] = "), Fragment.encode(String20.sqlServerType, row.string20), Fragment.lit(",\n[string50] = "), Fragment.encode(String50.sqlServerType, row.string50), Fragment.lit(",\n[string100] = "), Fragment.encode(String100.sqlServerType, row.string100), Fragment.lit(",\n[string255] = "), Fragment.encode(String255.sqlServerType, row.string255), Fragment.lit(",\n[nstring10] = "), Fragment.encode(String10.sqlServerType, row.nstring10), Fragment.lit(",\n[nstring50] = "), Fragment.encode(String50.sqlServerType, row.nstring50), Fragment.lit(",\n[nstring255] = "), Fragment.encode(String255.sqlServerType, row.nstring255), Fragment.lit(",\n[char10] = "), Fragment.encode(PaddedString10.sqlServerType, row.char10), Fragment.lit(",\n[nchar10] = "), Fragment.encode(PaddedString10.sqlServerType, row.nchar10), Fragment.lit(",\n[decimal5_2] = "), Fragment.encode(Decimal5_2.sqlServerType, row.decimal52), Fragment.lit(",\n[decimal10_2] = "), Fragment.encode(Decimal10_2.sqlServerType, row.decimal102), Fragment.lit(",\n[decimal18_4] = "), Fragment.encode(Decimal18_4.sqlServerType, row.decimal184), Fragment.lit(",\n[numeric8_2] = "), Fragment.encode(Decimal8_2.sqlServerType, row.numeric82), Fragment.lit(",\n[numeric12_4] = "), Fragment.encode(Decimal12_4.sqlServerType, row.numeric124), Fragment.lit(",\n[binary10] = "), Fragment.encode(Binary10.sqlServerType, row.binary10), Fragment.lit(",\n[binary32] = "), Fragment.encode(Binary32.sqlServerType, row.binary32), Fragment.lit(",\n[time0] = "), Fragment.encode(SqlServerTypes.time, row.time0), Fragment.lit(",\n[time3] = "), Fragment.encode(LocalTime3.sqlServerType, row.time3), Fragment.lit(",\n[time7] = "), Fragment.encode(LocalTime7.sqlServerType, row.time7), Fragment.lit(",\n[datetime2_0] = "), Fragment.encode(SqlServerTypes.datetime2, row.datetime20), Fragment.lit(",\n[datetime2_3] = "), Fragment.encode(LocalDateTime3.sqlServerType, row.datetime23), Fragment.lit(",\n[datetime2_7] = "), Fragment.encode(LocalDateTime7.sqlServerType, row.datetime27), Fragment.lit(",\n[dto0] = "), Fragment.encode(SqlServerTypes.datetimeoffset, row.dto0), Fragment.lit(",\n[dto3] = "), Fragment.encode(OffsetDateTime3.sqlServerType, row.dto3), Fragment.lit(",\n[dto7] = "), Fragment.encode(OffsetDateTime7.sqlServerType, row.dto7), Fragment.lit("\nwhere [id] = "), Fragment.encode(PrecisionTypesId.sqlServerType, id), Fragment.lit("")).update().runUnchecked(c) > 0
  }

  override fun upsert(
    unsaved: PrecisionTypesRow,
    c: Connection
  ): PrecisionTypesRow = Fragment.interpolate(Fragment.lit("MERGE INTO [precision_types] AS target\nUSING (VALUES ("), Fragment.encode(PrecisionTypesId.sqlServerType, unsaved.id), Fragment.lit(", "), Fragment.encode(String10.sqlServerType, unsaved.string10), Fragment.lit(", "), Fragment.encode(String20.sqlServerType, unsaved.string20), Fragment.lit(", "), Fragment.encode(String50.sqlServerType, unsaved.string50), Fragment.lit(", "), Fragment.encode(String100.sqlServerType, unsaved.string100), Fragment.lit(", "), Fragment.encode(String255.sqlServerType, unsaved.string255), Fragment.lit(", "), Fragment.encode(String10.sqlServerType, unsaved.nstring10), Fragment.lit(", "), Fragment.encode(String50.sqlServerType, unsaved.nstring50), Fragment.lit(", "), Fragment.encode(String255.sqlServerType, unsaved.nstring255), Fragment.lit(", "), Fragment.encode(PaddedString10.sqlServerType, unsaved.char10), Fragment.lit(", "), Fragment.encode(PaddedString10.sqlServerType, unsaved.nchar10), Fragment.lit(", "), Fragment.encode(Decimal5_2.sqlServerType, unsaved.decimal52), Fragment.lit(", "), Fragment.encode(Decimal10_2.sqlServerType, unsaved.decimal102), Fragment.lit(", "), Fragment.encode(Decimal18_4.sqlServerType, unsaved.decimal184), Fragment.lit(", "), Fragment.encode(Decimal8_2.sqlServerType, unsaved.numeric82), Fragment.lit(", "), Fragment.encode(Decimal12_4.sqlServerType, unsaved.numeric124), Fragment.lit(", "), Fragment.encode(Binary10.sqlServerType, unsaved.binary10), Fragment.lit(", "), Fragment.encode(Binary32.sqlServerType, unsaved.binary32), Fragment.lit(", "), Fragment.encode(SqlServerTypes.time, unsaved.time0), Fragment.lit(", "), Fragment.encode(LocalTime3.sqlServerType, unsaved.time3), Fragment.lit(", "), Fragment.encode(LocalTime7.sqlServerType, unsaved.time7), Fragment.lit(", "), Fragment.encode(SqlServerTypes.datetime2, unsaved.datetime20), Fragment.lit(", "), Fragment.encode(LocalDateTime3.sqlServerType, unsaved.datetime23), Fragment.lit(", "), Fragment.encode(LocalDateTime7.sqlServerType, unsaved.datetime27), Fragment.lit(", "), Fragment.encode(SqlServerTypes.datetimeoffset, unsaved.dto0), Fragment.lit(", "), Fragment.encode(OffsetDateTime3.sqlServerType, unsaved.dto3), Fragment.lit(", "), Fragment.encode(OffsetDateTime7.sqlServerType, unsaved.dto7), Fragment.lit(")) AS source([id], [string10], [string20], [string50], [string100], [string255], [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10], [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7])\nON target.[id] = source.[id]\nWHEN MATCHED THEN UPDATE SET [string10] = source.[string10],\n[string20] = source.[string20],\n[string50] = source.[string50],\n[string100] = source.[string100],\n[string255] = source.[string255],\n[nstring10] = source.[nstring10],\n[nstring50] = source.[nstring50],\n[nstring255] = source.[nstring255],\n[char10] = source.[char10],\n[nchar10] = source.[nchar10],\n[decimal5_2] = source.[decimal5_2],\n[decimal10_2] = source.[decimal10_2],\n[decimal18_4] = source.[decimal18_4],\n[numeric8_2] = source.[numeric8_2],\n[numeric12_4] = source.[numeric12_4],\n[binary10] = source.[binary10],\n[binary32] = source.[binary32],\n[time0] = source.[time0],\n[time3] = source.[time3],\n[time7] = source.[time7],\n[datetime2_0] = source.[datetime2_0],\n[datetime2_3] = source.[datetime2_3],\n[datetime2_7] = source.[datetime2_7],\n[dto0] = source.[dto0],\n[dto3] = source.[dto3],\n[dto7] = source.[dto7]\nWHEN NOT MATCHED THEN INSERT ([id], [string10], [string20], [string50], [string100], [string255], [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10], [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7]) VALUES ("), Fragment.encode(PrecisionTypesId.sqlServerType, unsaved.id), Fragment.lit(", "), Fragment.encode(String10.sqlServerType, unsaved.string10), Fragment.lit(", "), Fragment.encode(String20.sqlServerType, unsaved.string20), Fragment.lit(", "), Fragment.encode(String50.sqlServerType, unsaved.string50), Fragment.lit(", "), Fragment.encode(String100.sqlServerType, unsaved.string100), Fragment.lit(", "), Fragment.encode(String255.sqlServerType, unsaved.string255), Fragment.lit(", "), Fragment.encode(String10.sqlServerType, unsaved.nstring10), Fragment.lit(", "), Fragment.encode(String50.sqlServerType, unsaved.nstring50), Fragment.lit(", "), Fragment.encode(String255.sqlServerType, unsaved.nstring255), Fragment.lit(", "), Fragment.encode(PaddedString10.sqlServerType, unsaved.char10), Fragment.lit(", "), Fragment.encode(PaddedString10.sqlServerType, unsaved.nchar10), Fragment.lit(", "), Fragment.encode(Decimal5_2.sqlServerType, unsaved.decimal52), Fragment.lit(", "), Fragment.encode(Decimal10_2.sqlServerType, unsaved.decimal102), Fragment.lit(", "), Fragment.encode(Decimal18_4.sqlServerType, unsaved.decimal184), Fragment.lit(", "), Fragment.encode(Decimal8_2.sqlServerType, unsaved.numeric82), Fragment.lit(", "), Fragment.encode(Decimal12_4.sqlServerType, unsaved.numeric124), Fragment.lit(", "), Fragment.encode(Binary10.sqlServerType, unsaved.binary10), Fragment.lit(", "), Fragment.encode(Binary32.sqlServerType, unsaved.binary32), Fragment.lit(", "), Fragment.encode(SqlServerTypes.time, unsaved.time0), Fragment.lit(", "), Fragment.encode(LocalTime3.sqlServerType, unsaved.time3), Fragment.lit(", "), Fragment.encode(LocalTime7.sqlServerType, unsaved.time7), Fragment.lit(", "), Fragment.encode(SqlServerTypes.datetime2, unsaved.datetime20), Fragment.lit(", "), Fragment.encode(LocalDateTime3.sqlServerType, unsaved.datetime23), Fragment.lit(", "), Fragment.encode(LocalDateTime7.sqlServerType, unsaved.datetime27), Fragment.lit(", "), Fragment.encode(SqlServerTypes.datetimeoffset, unsaved.dto0), Fragment.lit(", "), Fragment.encode(OffsetDateTime3.sqlServerType, unsaved.dto3), Fragment.lit(", "), Fragment.encode(OffsetDateTime7.sqlServerType, unsaved.dto7), Fragment.lit(")\nOUTPUT INSERTED.[id], INSERTED.[string10], INSERTED.[string20], INSERTED.[string50], INSERTED.[string100], INSERTED.[string255], INSERTED.[nstring10], INSERTED.[nstring50], INSERTED.[nstring255], INSERTED.[char10], INSERTED.[nchar10], INSERTED.[decimal5_2], INSERTED.[decimal10_2], INSERTED.[decimal18_4], INSERTED.[numeric8_2], INSERTED.[numeric12_4], INSERTED.[binary10], INSERTED.[binary32], INSERTED.[time0], INSERTED.[time3], INSERTED.[time7], INSERTED.[datetime2_0], INSERTED.[datetime2_3], INSERTED.[datetime2_7], INSERTED.[dto0], INSERTED.[dto3], INSERTED.[dto7];"))
    .updateReturning(PrecisionTypesRow._rowParser.exactlyOne())
    .runUnchecked(c)

  override fun upsertBatch(
    unsaved: Iterator<PrecisionTypesRow>,
    c: Connection
  ): List<PrecisionTypesRow> = Fragment.interpolate(Fragment.lit("MERGE INTO [precision_types] AS target\nUSING (VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)) AS source([id], [string10], [string20], [string50], [string100], [string255], [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10], [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7])\nON target.[id] = source.[id]\nWHEN MATCHED THEN UPDATE SET [string10] = source.[string10],\n[string20] = source.[string20],\n[string50] = source.[string50],\n[string100] = source.[string100],\n[string255] = source.[string255],\n[nstring10] = source.[nstring10],\n[nstring50] = source.[nstring50],\n[nstring255] = source.[nstring255],\n[char10] = source.[char10],\n[nchar10] = source.[nchar10],\n[decimal5_2] = source.[decimal5_2],\n[decimal10_2] = source.[decimal10_2],\n[decimal18_4] = source.[decimal18_4],\n[numeric8_2] = source.[numeric8_2],\n[numeric12_4] = source.[numeric12_4],\n[binary10] = source.[binary10],\n[binary32] = source.[binary32],\n[time0] = source.[time0],\n[time3] = source.[time3],\n[time7] = source.[time7],\n[datetime2_0] = source.[datetime2_0],\n[datetime2_3] = source.[datetime2_3],\n[datetime2_7] = source.[datetime2_7],\n[dto0] = source.[dto0],\n[dto3] = source.[dto3],\n[dto7] = source.[dto7]\nWHEN NOT MATCHED THEN INSERT ([id], [string10], [string20], [string50], [string100], [string255], [nstring10], [nstring50], [nstring255], [char10], [nchar10], [decimal5_2], [decimal10_2], [decimal18_4], [numeric8_2], [numeric12_4], [binary10], [binary32], [time0], [time3], [time7], [datetime2_0], [datetime2_3], [datetime2_7], [dto0], [dto3], [dto7]) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\nOUTPUT INSERTED.[id], INSERTED.[string10], INSERTED.[string20], INSERTED.[string50], INSERTED.[string100], INSERTED.[string255], INSERTED.[nstring10], INSERTED.[nstring50], INSERTED.[nstring255], INSERTED.[char10], INSERTED.[nchar10], INSERTED.[decimal5_2], INSERTED.[decimal10_2], INSERTED.[decimal18_4], INSERTED.[numeric8_2], INSERTED.[numeric12_4], INSERTED.[binary10], INSERTED.[binary32], INSERTED.[time0], INSERTED.[time3], INSERTED.[time7], INSERTED.[datetime2_0], INSERTED.[datetime2_3], INSERTED.[datetime2_7], INSERTED.[dto0], INSERTED.[dto3], INSERTED.[dto7];"))
    .updateReturningEach(PrecisionTypesRow._rowParser, unsaved)
  .runUnchecked(c)
}
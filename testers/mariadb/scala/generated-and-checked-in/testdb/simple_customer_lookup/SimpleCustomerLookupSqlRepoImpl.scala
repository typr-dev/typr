/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.simple_customer_lookup

import dev.typr.foundations.MariaTypes
import dev.typr.foundations.scala.Fragment
import java.sql.Connection
import dev.typr.foundations.scala.Fragment.sql

class SimpleCustomerLookupSqlRepoImpl extends SimpleCustomerLookupSqlRepo {
  override def apply(email: String)(using c: Connection): List[SimpleCustomerLookupSqlRow] = {
    sql"""-- Simple customer lookup by email
    SELECT customer_id,
           email,
           first_name,
           last_name,
           tier,
           status,
           created_at
    FROM customers
    WHERE email = ${Fragment.encode(MariaTypes.varchar, email)}
    """.query(SimpleCustomerLookupSqlRow.`_rowParser`.all()).runUnchecked(c)
  }
}
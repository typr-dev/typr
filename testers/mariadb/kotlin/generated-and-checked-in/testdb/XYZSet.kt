/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb

import dev.typr.foundations.MariaType
import dev.typr.foundations.MariaTypes
import dev.typr.foundations.data.maria.MariaSet
import java.util.EnumSet
import kotlin.collections.List
import kotlin.collections.Set

/** MariaDB SET type with values: x, y, z */
data class XYZSet(val members: Set<XYZSetMember>) {
  fun contains(member: XYZSetMember): Boolean = members.contains(member)

  fun isEmpty(): Boolean = members.isEmpty()

  fun size(): Int = members.size

  fun toCommaSeparated(): String = members.joinToString(",") { it.value }

  override fun toString(): String = toCommaSeparated()

  companion object {
    fun empty(): XYZSet = XYZSet(EnumSet.noneOf(XYZSetMember::class.java).toSet())

    fun fromString(str: String): XYZSet = run {
      if (str.isNullOrEmpty()) XYZSet(EnumSet.noneOf(XYZSetMember::class.java).toSet())
      else {
        val set = EnumSet.noneOf(XYZSetMember::class.java)
        str.split(",").forEach { v ->
          XYZSetMember.ByName[v.trim()]?.let { set.add(it) }
        }
        XYZSet(set.toSet())
      }
    }

    val mariaType: MariaType<XYZSet> =
      MariaTypes.set.bimap({ ms: MariaSet -> XYZSet.fromString(ms.toCommaSeparated()) }, { s: XYZSet -> MariaSet.fromString(s.toCommaSeparated()) })

    fun of(members: List<XYZSetMember>): XYZSet = run {
      if (members.isEmpty()) XYZSet(EnumSet.noneOf(XYZSetMember::class.java).toSet())
      else XYZSet(EnumSet.copyOf(members).toSet())
    }
  }
}
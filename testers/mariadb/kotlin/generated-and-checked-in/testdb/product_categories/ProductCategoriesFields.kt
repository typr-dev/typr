/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.product_categories

import dev.typr.foundations.RowParser
import dev.typr.foundations.dsl.FieldsExpr
import dev.typr.foundations.dsl.Path
import dev.typr.foundations.dsl.SqlExpr
import dev.typr.foundations.dsl.SqlExpr.FieldLike
import dev.typr.foundations.kotlin.ForeignKey
import dev.typr.foundations.kotlin.KotlinDbTypes
import dev.typr.foundations.kotlin.RelationStructure
import dev.typr.foundations.kotlin.SqlExpr.CompositeIn
import dev.typr.foundations.kotlin.SqlExpr.CompositeIn.Part
import dev.typr.foundations.kotlin.SqlExpr.Field
import dev.typr.foundations.kotlin.SqlExpr.IdField
import kotlin.collections.List
import testdb.categories.CategoriesFields
import testdb.categories.CategoriesId
import testdb.categories.CategoriesRow
import testdb.products.ProductsFields
import testdb.products.ProductsId
import testdb.products.ProductsRow

interface ProductCategoriesFields : FieldsExpr<ProductCategoriesRow> {
  abstract fun categoryId(): IdField<CategoriesId, ProductCategoriesRow>

  abstract override fun columns(): List<FieldLike<*, ProductCategoriesRow>>

  fun compositeIdIn(compositeIds: List<ProductCategoriesId>): SqlExpr<Boolean> = CompositeIn(listOf(Part<ProductsId, ProductCategoriesId, ProductCategoriesRow>(productId(), ProductCategoriesId::productId, ProductsId.pgType), Part<CategoriesId, ProductCategoriesId, ProductCategoriesRow>(categoryId(), ProductCategoriesId::categoryId, CategoriesId.pgType)), compositeIds)

  fun compositeIdIs(compositeId: ProductCategoriesId): SqlExpr<Boolean> = SqlExpr.all(productId().isEqual(compositeId.productId), categoryId().isEqual(compositeId.categoryId))

  fun fkCategories(): ForeignKey<CategoriesFields, CategoriesRow> = ForeignKey.of<CategoriesFields, CategoriesRow>("fk_pc_category").withColumnPair<CategoriesId>(categoryId(), CategoriesFields::categoryId)

  fun fkProducts(): ForeignKey<ProductsFields, ProductsRow> = ForeignKey.of<ProductsFields, ProductsRow>("fk_pc_product").withColumnPair<ProductsId>(productId(), ProductsFields::productId)

  abstract fun isPrimary(): Field<Boolean, ProductCategoriesRow>

  abstract fun productId(): IdField<ProductsId, ProductCategoriesRow>

  override fun rowParser(): RowParser<ProductCategoriesRow> = ProductCategoriesRow._rowParser.underlying

  abstract fun sortOrder(): Field<Short, ProductCategoriesRow>

  companion object {
    data class Impl(val _path: List<Path>) : ProductCategoriesFields, RelationStructure<ProductCategoriesFields, ProductCategoriesRow> {
      override fun productId(): IdField<ProductsId, ProductCategoriesRow> = IdField<ProductsId, ProductCategoriesRow>(_path, "product_id", ProductCategoriesRow::productId, null, null, { row, value -> row.copy(productId = value) }, ProductsId.pgType)

      override fun categoryId(): IdField<CategoriesId, ProductCategoriesRow> = IdField<CategoriesId, ProductCategoriesRow>(_path, "category_id", ProductCategoriesRow::categoryId, null, null, { row, value -> row.copy(categoryId = value) }, CategoriesId.pgType)

      override fun isPrimary(): Field<Boolean, ProductCategoriesRow> = Field<Boolean, ProductCategoriesRow>(_path, "is_primary", ProductCategoriesRow::isPrimary, null, null, { row, value -> row.copy(isPrimary = value) }, KotlinDbTypes.MariaTypes.bool)

      override fun sortOrder(): Field<Short, ProductCategoriesRow> = Field<Short, ProductCategoriesRow>(_path, "sort_order", ProductCategoriesRow::sortOrder, null, null, { row, value -> row.copy(sortOrder = value) }, KotlinDbTypes.MariaTypes.smallint)

      override fun _path(): List<Path> = _path

      override fun columns(): List<FieldLike<*, ProductCategoriesRow>> = listOf(this.productId().underlying, this.categoryId().underlying, this.isPrimary().underlying, this.sortOrder().underlying)

      override fun withPaths(_path: List<Path>): RelationStructure<ProductCategoriesFields, ProductCategoriesRow> = Impl(_path)
    }

    val structure: Impl = Impl(emptyList<dev.typr.foundations.dsl.Path>())
  }
}
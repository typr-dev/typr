/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.order_details

import java.sql.Connection
import kotlin.collections.List
import testdb.orders.OrdersId
import typo.runtime.Fragment.interpolate

class OrderDetailsSqlRepoImpl() : OrderDetailsSqlRepo {
  override fun apply(
    orderId: /* user-picked */ OrdersId,
    c: Connection
  ): List<OrderDetailsSqlRow> = interpolate(
    typo.runtime.Fragment.lit("""
      -- Get order with all items
      SELECT o.order_id,
             o.order_number,
             o.order_status,
             o.payment_status,
             o.subtotal,
             o.shipping_cost,
             o.tax_amount,
             o.discount_amount,
             o.total_amount,
             o.ordered_at,
             oi.item_id,
             oi.product_id,
             oi.sku,
             oi.product_name,
             oi.quantity,
             oi.unit_price,
             oi.line_total
      FROM orders o
      JOIN order_items oi ON o.order_id = oi.order_id
      WHERE o.order_id = """.trimMargin()),
    /* user-picked */ OrdersId.pgType.encode(orderId),
    typo.runtime.Fragment.lit("""


    """.trimMargin())
  ).query(OrderDetailsSqlRow._rowParser.all()).runUnchecked(c)
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.product_prices

import com.fasterxml.jackson.annotation.JsonProperty
import java.math.BigDecimal
import java.time.LocalDate
import java.util.Optional
import testdb.customtypes.Defaulted
import testdb.customtypes.Defaulted.UseDefault
import testdb.price_tiers.PriceTiersId
import testdb.products.ProductsId
import typo.runtime.MariaText
import typo.runtime.MariaTypes

/** This class corresponds to a row in table `product_prices` which has not been persisted yet */
data class ProductPricesRowUnsaved(
  /** 
    * Points to [testdb.products.ProductsRow.productId]
    */
  @JsonProperty("product_id") val productId: ProductsId,
  /**  */
  val price: BigDecimal,
  /**  */
  @JsonProperty("valid_from") val validFrom: LocalDate,
  /** Default: NULL
    * Points to [testdb.price_tiers.PriceTiersRow.tierId]
    */
  @JsonProperty("tier_id") val tierId: Defaulted<Optional<PriceTiersId>> = UseDefault(),
  /** Default: 'USD'

    */
  @JsonProperty("currency_code") val currencyCode: Defaulted<String> = UseDefault(),
  /** Default: NULL

    */
  @JsonProperty("valid_to") val validTo: Defaulted<Optional<LocalDate>> = UseDefault()
) {
  fun toRow(
    tierIdDefault: () -> Optional<PriceTiersId>,
    currencyCodeDefault: () -> String,
    validToDefault: () -> Optional<LocalDate>,
    priceIdDefault: () -> ProductPricesId
  ): ProductPricesRow = ProductPricesRow(priceId = priceIdDefault(), productId = productId, tierId = tierId.getOrElse(tierIdDefault), price = price, currencyCode = currencyCode.getOrElse(currencyCodeDefault), validFrom = validFrom, validTo = validTo.getOrElse(validToDefault))

  companion object {
    val mariaText: MariaText<ProductPricesRowUnsaved> =
      MariaText.instance({ row, sb -> ProductsId.pgType.mariaText().unsafeEncode(row.productId, sb)
      sb.append(MariaText.DELIMETER)
      MariaTypes.decimal.mariaText().unsafeEncode(row.price, sb)
      sb.append(MariaText.DELIMETER)
      MariaTypes.date.mariaText().unsafeEncode(row.validFrom, sb)
      sb.append(MariaText.DELIMETER)
      Defaulted.mariaText(PriceTiersId.pgType.opt().mariaText()).unsafeEncode(row.tierId, sb)
      sb.append(MariaText.DELIMETER)
      Defaulted.mariaText(MariaTypes.char_.mariaText()).unsafeEncode(row.currencyCode, sb)
      sb.append(MariaText.DELIMETER)
      Defaulted.mariaText(MariaTypes.date.opt().mariaText()).unsafeEncode(row.validTo, sb) })
  }
}
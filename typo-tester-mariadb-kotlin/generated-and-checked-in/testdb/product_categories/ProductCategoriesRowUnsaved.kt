/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.product_categories

import com.fasterxml.jackson.annotation.JsonProperty
import testdb.categories.CategoriesId
import testdb.customtypes.Defaulted
import testdb.customtypes.Defaulted.UseDefault
import testdb.products.ProductsId
import typo.runtime.MariaText
import typo.runtime.MariaTypes

/** This class corresponds to a row in table `product_categories` which has not been persisted yet */
data class ProductCategoriesRowUnsaved(
  /** 
    * Points to [testdb.products.ProductsRow.productId]
    */
  @JsonProperty("product_id") val productId: ProductsId,
  /** 
    * Points to [testdb.categories.CategoriesRow.categoryId]
    */
  @JsonProperty("category_id") val categoryId: CategoriesId,
  /** Default: 0

    */
  @JsonProperty("is_primary") val isPrimary: Defaulted<Boolean> = UseDefault(),
  /** Default: 0

    */
  @JsonProperty("sort_order") val sortOrder: Defaulted<Short> = UseDefault()
) {
  fun toRow(
    isPrimaryDefault: () -> Boolean,
    sortOrderDefault: () -> Short
  ): ProductCategoriesRow = ProductCategoriesRow(productId = productId, categoryId = categoryId, isPrimary = isPrimary.getOrElse(isPrimaryDefault), sortOrder = sortOrder.getOrElse(sortOrderDefault))

  companion object {
    val mariaText: MariaText<ProductCategoriesRowUnsaved> =
      MariaText.instance({ row, sb -> ProductsId.pgType.mariaText().unsafeEncode(row.productId, sb)
      sb.append(MariaText.DELIMETER)
      CategoriesId.pgType.mariaText().unsafeEncode(row.categoryId, sb)
      sb.append(MariaText.DELIMETER)
      Defaulted.mariaText(MariaTypes.bool.mariaText()).unsafeEncode(row.isPrimary, sb)
      sb.append(MariaText.DELIMETER)
      Defaulted.mariaText(MariaTypes.smallint.mariaText()).unsafeEncode(row.sortOrder, sb) })
  }
}
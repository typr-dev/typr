/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.product_prices;

import com.fasterxml.jackson.annotation.JsonProperty;
import java.math.BigDecimal;
import java.time.LocalDate;
import java.util.Optional;
import testdb.customtypes.Defaulted;
import testdb.customtypes.Defaulted.UseDefault;
import testdb.price_tiers.PriceTiersId;
import testdb.products.ProductsId;
import typo.runtime.MariaText;
import typo.runtime.MariaTypes;

/** This class corresponds to a row in table `product_prices` which has not been persisted yet */
public record ProductPricesRowUnsaved(
  /** 
    * Points to {@link testdb.products.ProductsRow#productId()}
    */
  @JsonProperty("product_id") ProductsId productId,
  /**  */
  BigDecimal price,
  /**  */
  @JsonProperty("valid_from") LocalDate validFrom,
  /** Default: NULL
    * Points to {@link testdb.price_tiers.PriceTiersRow#tierId()}
    */
  @JsonProperty("tier_id") Defaulted<Optional<PriceTiersId>> tierId,
  /** Default: 'USD'

    */
  @JsonProperty("currency_code") Defaulted<String> currencyCode,
  /** Default: NULL

    */
  @JsonProperty("valid_to") Defaulted<Optional<LocalDate>> validTo
) {
  public ProductPricesRowUnsaved(
    /** 
      * Points to {@link testdb.products.ProductsRow#productId()}
      */
    @JsonProperty("product_id") ProductsId productId,
    /**  */
    BigDecimal price,
    /**  */
    @JsonProperty("valid_from") LocalDate validFrom
  ) {
    this(productId, price, validFrom, new UseDefault<>(), new UseDefault<>(), new UseDefault<>());
  };

  /** 
    * Points to {@link testdb.products.ProductsRow#productId()}
    */
  public ProductPricesRowUnsaved withProductId(ProductsId productId) {
    return new ProductPricesRowUnsaved(productId, price, validFrom, tierId, currencyCode, validTo);
  };

  /**  */
  public ProductPricesRowUnsaved withPrice(BigDecimal price) {
    return new ProductPricesRowUnsaved(productId, price, validFrom, tierId, currencyCode, validTo);
  };

  /**  */
  public ProductPricesRowUnsaved withValidFrom(LocalDate validFrom) {
    return new ProductPricesRowUnsaved(productId, price, validFrom, tierId, currencyCode, validTo);
  };

  /** Default: NULL
    * Points to {@link testdb.price_tiers.PriceTiersRow#tierId()}
    */
  public ProductPricesRowUnsaved withTierId(Defaulted<Optional<PriceTiersId>> tierId) {
    return new ProductPricesRowUnsaved(productId, price, validFrom, tierId, currencyCode, validTo);
  };

  /** Default: 'USD'

    */
  public ProductPricesRowUnsaved withCurrencyCode(Defaulted<String> currencyCode) {
    return new ProductPricesRowUnsaved(productId, price, validFrom, tierId, currencyCode, validTo);
  };

  /** Default: NULL

    */
  public ProductPricesRowUnsaved withValidTo(Defaulted<Optional<LocalDate>> validTo) {
    return new ProductPricesRowUnsaved(productId, price, validFrom, tierId, currencyCode, validTo);
  };

  static public MariaText<ProductPricesRowUnsaved> mariaText =
    MariaText.instance((row, sb) -> {
      ProductsId.pgType.mariaText().unsafeEncode(row.productId, sb);
      sb.append(MariaText.DELIMETER);
      MariaTypes.decimal.mariaText().unsafeEncode(row.price, sb);
      sb.append(MariaText.DELIMETER);
      MariaTypes.date.mariaText().unsafeEncode(row.validFrom, sb);
      sb.append(MariaText.DELIMETER);
      Defaulted.mariaText(PriceTiersId.pgType.opt().mariaText()).unsafeEncode(row.tierId, sb);
      sb.append(MariaText.DELIMETER);
      Defaulted.mariaText(MariaTypes.char_.mariaText()).unsafeEncode(row.currencyCode, sb);
      sb.append(MariaText.DELIMETER);
      Defaulted.mariaText(MariaTypes.date.opt().mariaText()).unsafeEncode(row.validTo, sb);
    });

  public ProductPricesRow toRow(
    java.util.function.Supplier<Optional<PriceTiersId>> tierIdDefault,
    java.util.function.Supplier<String> currencyCodeDefault,
    java.util.function.Supplier<Optional<LocalDate>> validToDefault,
    java.util.function.Supplier<ProductPricesId> priceIdDefault
  ) {
    return new ProductPricesRow(priceIdDefault.get(), productId, tierId.getOrElse(tierIdDefault), price, currencyCode.getOrElse(currencyCodeDefault), validFrom, validTo.getOrElse(validToDefault));
  };
}
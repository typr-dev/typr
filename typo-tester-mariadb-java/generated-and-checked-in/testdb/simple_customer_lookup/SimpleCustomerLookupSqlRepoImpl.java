/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.simple_customer_lookup;

import java.sql.Connection;
import java.util.List;
import typo.runtime.MariaTypes;
import static typo.runtime.Fragment.interpolate;

public class SimpleCustomerLookupSqlRepoImpl implements SimpleCustomerLookupSqlRepo {
  @Override
  public List<SimpleCustomerLookupSqlRow> apply(
    String email,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         -- Simple customer lookup by email
         SELECT customer_id,
                email,
                first_name,
                last_name,
                tier,
                status,
                created_at
         FROM customers
         WHERE email = """),
      MariaTypes.text.encode(email),
      typo.runtime.Fragment.lit("""


      """)
    ).query(SimpleCustomerLookupSqlRow._rowParser.all()).runUnchecked(c);
  };
}
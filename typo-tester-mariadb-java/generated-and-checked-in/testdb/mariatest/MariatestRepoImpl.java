/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.mariatest;

import static typo.runtime.Fragment.interpolate;

import java.sql.Connection;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import typo.dsl.DeleteBuilder;
import typo.dsl.Dialect;
import typo.dsl.SelectBuilder;
import typo.dsl.UpdateBuilder;
import typo.runtime.Fragment;
import typo.runtime.MariaTypes;

public class MariatestRepoImpl implements MariatestRepo {
  @Override
  public DeleteBuilder<MariatestFields, MariatestRow> delete() {
    return DeleteBuilder.of("`mariatest`", MariatestFields.structure(), Dialect.MARIADB);
  }
  ;

  @Override
  public Boolean deleteById(MariatestId intCol, Connection c) {
    return interpolate(
                Fragment.lit("delete from `mariatest` where `int_col` = "),
                Fragment.encode(MariatestId.pgType, intCol),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }
  ;

  @Override
  public Integer deleteByIds(MariatestId[] intCols, Connection c) {
    ArrayList<Fragment> fragments = new ArrayList<>();
    for (var id : intCols) {
      fragments.add(Fragment.encode(MariatestId.pgType, id));
    }
    ;
    return Fragment.interpolate(
            Fragment.lit("delete from `mariatest` where `int_col` in ("),
            Fragment.comma(fragments),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }
  ;

  @Override
  public MariatestRow insert(MariatestRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into `mariatest`(`tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`,"
                    + " `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`,"
                    + " `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`,"
                    + " `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`)\n"
                    + "values ("),
            Fragment.encode(MariaTypes.tinyint, unsaved.tinyintCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.smallint, unsaved.smallintCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumint, unsaved.mediumintCol()),
            Fragment.lit(", "),
            Fragment.encode(MariatestId.pgType, unsaved.intCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bigint, unsaved.bigintCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.tinyintUnsigned, unsaved.tinyintUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.smallintUnsigned, unsaved.smallintUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumintUnsigned, unsaved.mediumintUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.intUnsigned, unsaved.intUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bigintUnsigned, unsaved.bigintUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.decimalCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.numericCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.float_, unsaved.floatCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.double_, unsaved.doubleCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bool, unsaved.boolCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bit, unsaved.bitCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bit, unsaved.bit1Col()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.char_, unsaved.charCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.varchar, unsaved.varcharCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.tinytext, unsaved.tinytextCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text, unsaved.textCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumtext, unsaved.mediumtextCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.longtext, unsaved.longtextCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.binary, unsaved.binaryCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.varbinary, unsaved.varbinaryCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.tinyblob, unsaved.tinyblobCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.blob, unsaved.blobCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumblob, unsaved.mediumblobCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.longblob, unsaved.longblobCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.date, unsaved.dateCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.time, unsaved.timeCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.time, unsaved.timeFspCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime, unsaved.datetimeCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime, unsaved.datetimeFspCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.timestamp, unsaved.timestampCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.timestamp, unsaved.timestampFspCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.year, unsaved.yearCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text, unsaved.enumCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.set, unsaved.setCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.longtext, unsaved.jsonCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.inet4, unsaved.inet4Col()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.inet6, unsaved.inet6Col()),
            Fragment.lit(
                ")\n"
                    + "RETURNING `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`,"
                    + " `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`,"
                    + " `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`,"
                    + " `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`\n"))
        .updateReturning(MariatestRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }
  ;

  @Override
  public MariatestRow insert(MariatestRowUnsaved unsaved, Connection c) {
    ArrayList<Fragment> columns = new ArrayList<>();
    ;
    ArrayList<Fragment> values = new ArrayList<>();
    ;
    columns.add(Fragment.lit("`tinyint_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.tinyint, unsaved.tinyintCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`smallint_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.smallint, unsaved.smallintCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`mediumint_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.mediumint, unsaved.mediumintCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`int_col`"));
    values.add(
        interpolate(Fragment.encode(MariatestId.pgType, unsaved.intCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`bigint_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.bigint, unsaved.bigintCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`tinyint_u_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.tinyintUnsigned, unsaved.tinyintUCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`smallint_u_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.smallintUnsigned, unsaved.smallintUCol()),
            Fragment.lit("")));
    columns.add(Fragment.lit("`mediumint_u_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.mediumintUnsigned, unsaved.mediumintUCol()),
            Fragment.lit("")));
    columns.add(Fragment.lit("`int_u_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.intUnsigned, unsaved.intUCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`bigint_u_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.bigintUnsigned, unsaved.bigintUCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`decimal_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.numeric, unsaved.decimalCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`numeric_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.numeric, unsaved.numericCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`float_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.float_, unsaved.floatCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`double_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.double_, unsaved.doubleCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`bool_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.bool, unsaved.boolCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`bit_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.bit, unsaved.bitCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`bit1_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.bit, unsaved.bit1Col()), Fragment.lit("")));
    columns.add(Fragment.lit("`char_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.char_, unsaved.charCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`varchar_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.varchar, unsaved.varcharCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`tinytext_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.tinytext, unsaved.tinytextCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`text_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.text, unsaved.textCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`mediumtext_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.mediumtext, unsaved.mediumtextCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`longtext_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.longtext, unsaved.longtextCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`binary_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.binary, unsaved.binaryCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`varbinary_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.varbinary, unsaved.varbinaryCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`tinyblob_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.tinyblob, unsaved.tinyblobCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`blob_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.blob, unsaved.blobCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`mediumblob_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.mediumblob, unsaved.mediumblobCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`longblob_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.longblob, unsaved.longblobCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`date_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.date, unsaved.dateCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`time_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.time, unsaved.timeCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`time_fsp_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.time, unsaved.timeFspCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`datetime_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.datetime, unsaved.datetimeCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`datetime_fsp_col`"));
    values.add(
        interpolate(
            Fragment.encode(MariaTypes.datetime, unsaved.datetimeFspCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`year_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.year, unsaved.yearCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`enum_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.text, unsaved.enumCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`set_col`"));
    values.add(interpolate(Fragment.encode(MariaTypes.set, unsaved.setCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`json_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.longtext, unsaved.jsonCol()), Fragment.lit("")));
    columns.add(Fragment.lit("`inet4_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.inet4, unsaved.inet4Col()), Fragment.lit("")));
    columns.add(Fragment.lit("`inet6_col`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.inet6, unsaved.inet6Col()), Fragment.lit("")));
    unsaved
        .timestampCol()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`timestamp_col`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.timestamp, value), Fragment.lit("")));
            });
    ;
    unsaved
        .timestampFspCol()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`timestamp_fsp_col`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.timestamp, value), Fragment.lit("")));
            });
    ;
    Fragment q =
        interpolate(
            Fragment.lit("insert into `mariatest`("),
            Fragment.comma(columns),
            Fragment.lit(")\nvalues ("),
            Fragment.comma(values),
            Fragment.lit(
                ")\n"
                    + "RETURNING `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`,"
                    + " `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`,"
                    + " `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`,"
                    + " `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`\n"));
    ;
    return q.updateReturning(MariatestRow._rowParser.exactlyOne()).runUnchecked(c);
  }
  ;

  @Override
  public SelectBuilder<MariatestFields, MariatestRow> select() {
    return SelectBuilder.of(
        "`mariatest`", MariatestFields.structure(), MariatestRow._rowParser, Dialect.MARIADB);
  }
  ;

  @Override
  public List<MariatestRow> selectAll(Connection c) {
    return interpolate(
            Fragment.lit(
                "select `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`,"
                    + " `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`,"
                    + " `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`,"
                    + " `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`\n"
                    + "from `mariatest`\n"))
        .query(MariatestRow._rowParser.all())
        .runUnchecked(c);
  }
  ;

  @Override
  public Optional<MariatestRow> selectById(MariatestId intCol, Connection c) {
    return interpolate(
            Fragment.lit(
                "select `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`,"
                    + " `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`,"
                    + " `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`,"
                    + " `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`\n"
                    + "from `mariatest`\n"
                    + "where `int_col` = "),
            Fragment.encode(MariatestId.pgType, intCol),
            Fragment.lit(""))
        .query(MariatestRow._rowParser.first())
        .runUnchecked(c);
  }
  ;

  @Override
  public List<MariatestRow> selectByIds(MariatestId[] intCols, Connection c) {
    ArrayList<Fragment> fragments = new ArrayList<>();
    for (var id : intCols) {
      fragments.add(Fragment.encode(MariatestId.pgType, id));
    }
    ;
    return Fragment.interpolate(
            Fragment.lit(
                "select `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`,"
                    + " `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`,"
                    + " `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`,"
                    + " `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col` from"
                    + " `mariatest` where `int_col` in ("),
            Fragment.comma(fragments),
            Fragment.lit(")"))
        .query(MariatestRow._rowParser.all())
        .runUnchecked(c);
  }
  ;

  @Override
  public Map<MariatestId, MariatestRow> selectByIdsTracked(MariatestId[] intCols, Connection c) {
    HashMap<MariatestId, MariatestRow> ret = new HashMap<MariatestId, MariatestRow>();
    selectByIds(intCols, c).forEach(row -> ret.put(row.intCol(), row));
    return ret;
  }
  ;

  @Override
  public UpdateBuilder<MariatestFields, MariatestRow> update() {
    return UpdateBuilder.of(
        "`mariatest`", MariatestFields.structure(), MariatestRow._rowParser, Dialect.MARIADB);
  }
  ;

  @Override
  public Boolean update(MariatestRow row, Connection c) {
    MariatestId intCol = row.intCol();
    ;
    return interpolate(
                Fragment.lit("update `mariatest`\nset `tinyint_col` = "),
                Fragment.encode(MariaTypes.tinyint, row.tinyintCol()),
                Fragment.lit(",\n`smallint_col` = "),
                Fragment.encode(MariaTypes.smallint, row.smallintCol()),
                Fragment.lit(",\n`mediumint_col` = "),
                Fragment.encode(MariaTypes.mediumint, row.mediumintCol()),
                Fragment.lit(",\n`bigint_col` = "),
                Fragment.encode(MariaTypes.bigint, row.bigintCol()),
                Fragment.lit(",\n`tinyint_u_col` = "),
                Fragment.encode(MariaTypes.tinyintUnsigned, row.tinyintUCol()),
                Fragment.lit(",\n`smallint_u_col` = "),
                Fragment.encode(MariaTypes.smallintUnsigned, row.smallintUCol()),
                Fragment.lit(",\n`mediumint_u_col` = "),
                Fragment.encode(MariaTypes.mediumintUnsigned, row.mediumintUCol()),
                Fragment.lit(",\n`int_u_col` = "),
                Fragment.encode(MariaTypes.intUnsigned, row.intUCol()),
                Fragment.lit(",\n`bigint_u_col` = "),
                Fragment.encode(MariaTypes.bigintUnsigned, row.bigintUCol()),
                Fragment.lit(",\n`decimal_col` = "),
                Fragment.encode(MariaTypes.numeric, row.decimalCol()),
                Fragment.lit(",\n`numeric_col` = "),
                Fragment.encode(MariaTypes.numeric, row.numericCol()),
                Fragment.lit(",\n`float_col` = "),
                Fragment.encode(MariaTypes.float_, row.floatCol()),
                Fragment.lit(",\n`double_col` = "),
                Fragment.encode(MariaTypes.double_, row.doubleCol()),
                Fragment.lit(",\n`bool_col` = "),
                Fragment.encode(MariaTypes.bool, row.boolCol()),
                Fragment.lit(",\n`bit_col` = "),
                Fragment.encode(MariaTypes.bit, row.bitCol()),
                Fragment.lit(",\n`bit1_col` = "),
                Fragment.encode(MariaTypes.bit, row.bit1Col()),
                Fragment.lit(",\n`char_col` = "),
                Fragment.encode(MariaTypes.char_, row.charCol()),
                Fragment.lit(",\n`varchar_col` = "),
                Fragment.encode(MariaTypes.varchar, row.varcharCol()),
                Fragment.lit(",\n`tinytext_col` = "),
                Fragment.encode(MariaTypes.tinytext, row.tinytextCol()),
                Fragment.lit(",\n`text_col` = "),
                Fragment.encode(MariaTypes.text, row.textCol()),
                Fragment.lit(",\n`mediumtext_col` = "),
                Fragment.encode(MariaTypes.mediumtext, row.mediumtextCol()),
                Fragment.lit(",\n`longtext_col` = "),
                Fragment.encode(MariaTypes.longtext, row.longtextCol()),
                Fragment.lit(",\n`binary_col` = "),
                Fragment.encode(MariaTypes.binary, row.binaryCol()),
                Fragment.lit(",\n`varbinary_col` = "),
                Fragment.encode(MariaTypes.varbinary, row.varbinaryCol()),
                Fragment.lit(",\n`tinyblob_col` = "),
                Fragment.encode(MariaTypes.tinyblob, row.tinyblobCol()),
                Fragment.lit(",\n`blob_col` = "),
                Fragment.encode(MariaTypes.blob, row.blobCol()),
                Fragment.lit(",\n`mediumblob_col` = "),
                Fragment.encode(MariaTypes.mediumblob, row.mediumblobCol()),
                Fragment.lit(",\n`longblob_col` = "),
                Fragment.encode(MariaTypes.longblob, row.longblobCol()),
                Fragment.lit(",\n`date_col` = "),
                Fragment.encode(MariaTypes.date, row.dateCol()),
                Fragment.lit(",\n`time_col` = "),
                Fragment.encode(MariaTypes.time, row.timeCol()),
                Fragment.lit(",\n`time_fsp_col` = "),
                Fragment.encode(MariaTypes.time, row.timeFspCol()),
                Fragment.lit(",\n`datetime_col` = "),
                Fragment.encode(MariaTypes.datetime, row.datetimeCol()),
                Fragment.lit(",\n`datetime_fsp_col` = "),
                Fragment.encode(MariaTypes.datetime, row.datetimeFspCol()),
                Fragment.lit(",\n`timestamp_col` = "),
                Fragment.encode(MariaTypes.timestamp, row.timestampCol()),
                Fragment.lit(",\n`timestamp_fsp_col` = "),
                Fragment.encode(MariaTypes.timestamp, row.timestampFspCol()),
                Fragment.lit(",\n`year_col` = "),
                Fragment.encode(MariaTypes.year, row.yearCol()),
                Fragment.lit(",\n`enum_col` = "),
                Fragment.encode(MariaTypes.text, row.enumCol()),
                Fragment.lit(",\n`set_col` = "),
                Fragment.encode(MariaTypes.set, row.setCol()),
                Fragment.lit(",\n`json_col` = "),
                Fragment.encode(MariaTypes.longtext, row.jsonCol()),
                Fragment.lit(",\n`inet4_col` = "),
                Fragment.encode(MariaTypes.inet4, row.inet4Col()),
                Fragment.lit(",\n`inet6_col` = "),
                Fragment.encode(MariaTypes.inet6, row.inet6Col()),
                Fragment.lit("\nwhere `int_col` = "),
                Fragment.encode(MariatestId.pgType, intCol),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }
  ;

  @Override
  public MariatestRow upsert(MariatestRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "INSERT INTO `mariatest`(`tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`,"
                    + " `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`,"
                    + " `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`,"
                    + " `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`)\n"
                    + "VALUES ("),
            Fragment.encode(MariaTypes.tinyint, unsaved.tinyintCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.smallint, unsaved.smallintCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumint, unsaved.mediumintCol()),
            Fragment.lit(", "),
            Fragment.encode(MariatestId.pgType, unsaved.intCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bigint, unsaved.bigintCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.tinyintUnsigned, unsaved.tinyintUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.smallintUnsigned, unsaved.smallintUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumintUnsigned, unsaved.mediumintUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.intUnsigned, unsaved.intUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bigintUnsigned, unsaved.bigintUCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.decimalCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.numericCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.float_, unsaved.floatCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.double_, unsaved.doubleCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bool, unsaved.boolCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bit, unsaved.bitCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.bit, unsaved.bit1Col()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.char_, unsaved.charCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.varchar, unsaved.varcharCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.tinytext, unsaved.tinytextCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text, unsaved.textCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumtext, unsaved.mediumtextCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.longtext, unsaved.longtextCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.binary, unsaved.binaryCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.varbinary, unsaved.varbinaryCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.tinyblob, unsaved.tinyblobCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.blob, unsaved.blobCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumblob, unsaved.mediumblobCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.longblob, unsaved.longblobCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.date, unsaved.dateCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.time, unsaved.timeCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.time, unsaved.timeFspCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime, unsaved.datetimeCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime, unsaved.datetimeFspCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.timestamp, unsaved.timestampCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.timestamp, unsaved.timestampFspCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.year, unsaved.yearCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text, unsaved.enumCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.set, unsaved.setCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.longtext, unsaved.jsonCol()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.inet4, unsaved.inet4Col()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.inet6, unsaved.inet6Col()),
            Fragment.lit(
                ")\n"
                    + "ON DUPLICATE KEY UPDATE `tinyint_col` = VALUES(`tinyint_col`),\n"
                    + "`smallint_col` = VALUES(`smallint_col`),\n"
                    + "`mediumint_col` = VALUES(`mediumint_col`),\n"
                    + "`bigint_col` = VALUES(`bigint_col`),\n"
                    + "`tinyint_u_col` = VALUES(`tinyint_u_col`),\n"
                    + "`smallint_u_col` = VALUES(`smallint_u_col`),\n"
                    + "`mediumint_u_col` = VALUES(`mediumint_u_col`),\n"
                    + "`int_u_col` = VALUES(`int_u_col`),\n"
                    + "`bigint_u_col` = VALUES(`bigint_u_col`),\n"
                    + "`decimal_col` = VALUES(`decimal_col`),\n"
                    + "`numeric_col` = VALUES(`numeric_col`),\n"
                    + "`float_col` = VALUES(`float_col`),\n"
                    + "`double_col` = VALUES(`double_col`),\n"
                    + "`bool_col` = VALUES(`bool_col`),\n"
                    + "`bit_col` = VALUES(`bit_col`),\n"
                    + "`bit1_col` = VALUES(`bit1_col`),\n"
                    + "`char_col` = VALUES(`char_col`),\n"
                    + "`varchar_col` = VALUES(`varchar_col`),\n"
                    + "`tinytext_col` = VALUES(`tinytext_col`),\n"
                    + "`text_col` = VALUES(`text_col`),\n"
                    + "`mediumtext_col` = VALUES(`mediumtext_col`),\n"
                    + "`longtext_col` = VALUES(`longtext_col`),\n"
                    + "`binary_col` = VALUES(`binary_col`),\n"
                    + "`varbinary_col` = VALUES(`varbinary_col`),\n"
                    + "`tinyblob_col` = VALUES(`tinyblob_col`),\n"
                    + "`blob_col` = VALUES(`blob_col`),\n"
                    + "`mediumblob_col` = VALUES(`mediumblob_col`),\n"
                    + "`longblob_col` = VALUES(`longblob_col`),\n"
                    + "`date_col` = VALUES(`date_col`),\n"
                    + "`time_col` = VALUES(`time_col`),\n"
                    + "`time_fsp_col` = VALUES(`time_fsp_col`),\n"
                    + "`datetime_col` = VALUES(`datetime_col`),\n"
                    + "`datetime_fsp_col` = VALUES(`datetime_fsp_col`),\n"
                    + "`timestamp_col` = VALUES(`timestamp_col`),\n"
                    + "`timestamp_fsp_col` = VALUES(`timestamp_fsp_col`),\n"
                    + "`year_col` = VALUES(`year_col`),\n"
                    + "`enum_col` = VALUES(`enum_col`),\n"
                    + "`set_col` = VALUES(`set_col`),\n"
                    + "`json_col` = VALUES(`json_col`),\n"
                    + "`inet4_col` = VALUES(`inet4_col`),\n"
                    + "`inet6_col` = VALUES(`inet6_col`)\n"
                    + "RETURNING `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`,"
                    + " `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`,"
                    + " `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`,"
                    + " `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`"))
        .updateReturning(MariatestRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }
  ;

  @Override
  public List<MariatestRow> upsertBatch(Iterator<MariatestRow> unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "INSERT INTO `mariatest`(`tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`,"
                    + " `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`,"
                    + " `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`,"
                    + " `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`)\n"
                    + "VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,"
                    + " ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n"
                    + "ON DUPLICATE KEY UPDATE `tinyint_col` = VALUES(`tinyint_col`),\n"
                    + "`smallint_col` = VALUES(`smallint_col`),\n"
                    + "`mediumint_col` = VALUES(`mediumint_col`),\n"
                    + "`bigint_col` = VALUES(`bigint_col`),\n"
                    + "`tinyint_u_col` = VALUES(`tinyint_u_col`),\n"
                    + "`smallint_u_col` = VALUES(`smallint_u_col`),\n"
                    + "`mediumint_u_col` = VALUES(`mediumint_u_col`),\n"
                    + "`int_u_col` = VALUES(`int_u_col`),\n"
                    + "`bigint_u_col` = VALUES(`bigint_u_col`),\n"
                    + "`decimal_col` = VALUES(`decimal_col`),\n"
                    + "`numeric_col` = VALUES(`numeric_col`),\n"
                    + "`float_col` = VALUES(`float_col`),\n"
                    + "`double_col` = VALUES(`double_col`),\n"
                    + "`bool_col` = VALUES(`bool_col`),\n"
                    + "`bit_col` = VALUES(`bit_col`),\n"
                    + "`bit1_col` = VALUES(`bit1_col`),\n"
                    + "`char_col` = VALUES(`char_col`),\n"
                    + "`varchar_col` = VALUES(`varchar_col`),\n"
                    + "`tinytext_col` = VALUES(`tinytext_col`),\n"
                    + "`text_col` = VALUES(`text_col`),\n"
                    + "`mediumtext_col` = VALUES(`mediumtext_col`),\n"
                    + "`longtext_col` = VALUES(`longtext_col`),\n"
                    + "`binary_col` = VALUES(`binary_col`),\n"
                    + "`varbinary_col` = VALUES(`varbinary_col`),\n"
                    + "`tinyblob_col` = VALUES(`tinyblob_col`),\n"
                    + "`blob_col` = VALUES(`blob_col`),\n"
                    + "`mediumblob_col` = VALUES(`mediumblob_col`),\n"
                    + "`longblob_col` = VALUES(`longblob_col`),\n"
                    + "`date_col` = VALUES(`date_col`),\n"
                    + "`time_col` = VALUES(`time_col`),\n"
                    + "`time_fsp_col` = VALUES(`time_fsp_col`),\n"
                    + "`datetime_col` = VALUES(`datetime_col`),\n"
                    + "`datetime_fsp_col` = VALUES(`datetime_fsp_col`),\n"
                    + "`timestamp_col` = VALUES(`timestamp_col`),\n"
                    + "`timestamp_fsp_col` = VALUES(`timestamp_fsp_col`),\n"
                    + "`year_col` = VALUES(`year_col`),\n"
                    + "`enum_col` = VALUES(`enum_col`),\n"
                    + "`set_col` = VALUES(`set_col`),\n"
                    + "`json_col` = VALUES(`json_col`),\n"
                    + "`inet4_col` = VALUES(`inet4_col`),\n"
                    + "`inet6_col` = VALUES(`inet6_col`)\n"
                    + "RETURNING `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`,"
                    + " `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`,"
                    + " `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`,"
                    + " `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`,"
                    + " `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`,"
                    + " `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`,"
                    + " `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`,"
                    + " `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`,"
                    + " `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`"))
        .updateReturningEach(MariatestRow._rowParser, unsaved)
        .runUnchecked(c);
  }
  ;
}

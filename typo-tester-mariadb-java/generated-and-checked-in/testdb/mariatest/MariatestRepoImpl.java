/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.mariatest;

import java.sql.Connection;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import typo.dsl.DeleteBuilder;
import typo.dsl.Dialect;
import typo.dsl.SelectBuilder;
import typo.dsl.UpdateBuilder;
import typo.runtime.Fragment;
import typo.runtime.Fragment.Literal;
import typo.runtime.MariaTypes;
import static typo.runtime.Fragment.interpolate;

public class MariatestRepoImpl implements MariatestRepo {
  @Override
  public DeleteBuilder<MariatestFields, MariatestRow> delete() {
    return DeleteBuilder.of("`mariatest`", MariatestFields.structure(), Dialect.MARIADB);
  };

  @Override
  public Boolean deleteById(
    MariatestId intCol,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("delete from `mariatest` where `int_col` = "),
      MariatestId.pgType.encode(intCol),
      typo.runtime.Fragment.lit("")
    ).update().runUnchecked(c) > 0;
  };

  @Override
  public Integer deleteByIds(
    MariatestId[] intCols,
    Connection c
  ) {
    ArrayList<Fragment> fragments = new ArrayList<Fragment>();
    for (var id : intCols) { fragments.add(MariatestId.pgType.encode(id)); };
    return Fragment.interpolate(Fragment.lit("delete from `mariatest` where `int_col` in ("), Fragment.comma(fragments), Fragment.lit(")")).update().runUnchecked(c);
  };

  @Override
  public MariatestRow insert(
    MariatestRow unsaved,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         insert into `mariatest`(`tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`)
         values ("""),
      MariaTypes.tinyint.encode(unsaved.tinyintCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.smallint.encode(unsaved.smallintCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.int_.encode(unsaved.mediumintCol()),
      typo.runtime.Fragment.lit(", "),
      MariatestId.pgType.encode(unsaved.intCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.bigint.encode(unsaved.bigintCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.smallint.encode(unsaved.tinyintUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.int_.encode(unsaved.smallintUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.int_.encode(unsaved.mediumintUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.bigint.encode(unsaved.intUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.bigintUnsigned.encode(unsaved.bigintUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.decimalCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.numericCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.float_.encode(unsaved.floatCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.double_.encode(unsaved.doubleCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.bool.encode(unsaved.boolCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.bitCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.bit1Col()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.charCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.varcharCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.tinytextCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.textCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.mediumtextCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.longtextCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.binaryCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.varbinaryCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.tinyblobCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.blobCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.mediumblobCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.longblobCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.date.encode(unsaved.dateCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.time.encode(unsaved.timeCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.time.encode(unsaved.timeFspCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.datetimeCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.datetimeFspCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.timestampCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.timestampFspCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.year.encode(unsaved.yearCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.enumCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.set.encode(unsaved.setCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.jsonCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.inet4.encode(unsaved.inet4Col()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.inet6.encode(unsaved.inet6Col()),
      typo.runtime.Fragment.lit("""
         )
         returning `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`
      """)
    )
      .updateReturning(MariatestRow._rowParser.exactlyOne()).runUnchecked(c);
  };

  @Override
  public MariatestRow insert(
    MariatestRowUnsaved unsaved,
    Connection c
  ) {
    ArrayList<Literal> columns = new ArrayList<Literal>();;
    ArrayList<Fragment> values = new ArrayList<Fragment>();;
    columns.add(Fragment.lit("`tinyint_col`"));
    values.add(interpolate(
      MariaTypes.tinyint.encode(unsaved.tinyintCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`smallint_col`"));
    values.add(interpolate(
      MariaTypes.smallint.encode(unsaved.smallintCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`mediumint_col`"));
    values.add(interpolate(
      MariaTypes.int_.encode(unsaved.mediumintCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`int_col`"));
    values.add(interpolate(
      MariatestId.pgType.encode(unsaved.intCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`bigint_col`"));
    values.add(interpolate(
      MariaTypes.bigint.encode(unsaved.bigintCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`tinyint_u_col`"));
    values.add(interpolate(
      MariaTypes.smallint.encode(unsaved.tinyintUCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`smallint_u_col`"));
    values.add(interpolate(
      MariaTypes.int_.encode(unsaved.smallintUCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`mediumint_u_col`"));
    values.add(interpolate(
      MariaTypes.int_.encode(unsaved.mediumintUCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`int_u_col`"));
    values.add(interpolate(
      MariaTypes.bigint.encode(unsaved.intUCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`bigint_u_col`"));
    values.add(interpolate(
      MariaTypes.bigintUnsigned.encode(unsaved.bigintUCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`decimal_col`"));
    values.add(interpolate(
      MariaTypes.numeric.encode(unsaved.decimalCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`numeric_col`"));
    values.add(interpolate(
      MariaTypes.numeric.encode(unsaved.numericCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`float_col`"));
    values.add(interpolate(
      MariaTypes.float_.encode(unsaved.floatCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`double_col`"));
    values.add(interpolate(
      MariaTypes.double_.encode(unsaved.doubleCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`bool_col`"));
    values.add(interpolate(
      MariaTypes.bool.encode(unsaved.boolCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`bit_col`"));
    values.add(interpolate(
      MariaTypes.blob.encode(unsaved.bitCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`bit1_col`"));
    values.add(interpolate(
      MariaTypes.blob.encode(unsaved.bit1Col()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`char_col`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.charCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`varchar_col`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.varcharCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`tinytext_col`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.tinytextCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`text_col`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.textCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`mediumtext_col`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.mediumtextCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`longtext_col`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.longtextCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`binary_col`"));
    values.add(interpolate(
      MariaTypes.blob.encode(unsaved.binaryCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`varbinary_col`"));
    values.add(interpolate(
      MariaTypes.blob.encode(unsaved.varbinaryCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`tinyblob_col`"));
    values.add(interpolate(
      MariaTypes.blob.encode(unsaved.tinyblobCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`blob_col`"));
    values.add(interpolate(
      MariaTypes.blob.encode(unsaved.blobCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`mediumblob_col`"));
    values.add(interpolate(
      MariaTypes.blob.encode(unsaved.mediumblobCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`longblob_col`"));
    values.add(interpolate(
      MariaTypes.blob.encode(unsaved.longblobCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`date_col`"));
    values.add(interpolate(
      MariaTypes.date.encode(unsaved.dateCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`time_col`"));
    values.add(interpolate(
      MariaTypes.time.encode(unsaved.timeCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`time_fsp_col`"));
    values.add(interpolate(
      MariaTypes.time.encode(unsaved.timeFspCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`datetime_col`"));
    values.add(interpolate(
      MariaTypes.datetime.encode(unsaved.datetimeCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`datetime_fsp_col`"));
    values.add(interpolate(
      MariaTypes.datetime.encode(unsaved.datetimeFspCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`year_col`"));
    values.add(interpolate(
      MariaTypes.year.encode(unsaved.yearCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`enum_col`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.enumCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`set_col`"));
    values.add(interpolate(
      MariaTypes.set.encode(unsaved.setCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`json_col`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.jsonCol()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`inet4_col`"));
    values.add(interpolate(
      MariaTypes.inet4.encode(unsaved.inet4Col()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`inet6_col`"));
    values.add(interpolate(
      MariaTypes.inet6.encode(unsaved.inet6Col()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    unsaved.timestampCol().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`timestamp_col`"));
        values.add(interpolate(
        MariaTypes.datetime.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.timestampFspCol().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`timestamp_fsp_col`"));
        values.add(interpolate(
        MariaTypes.datetime.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    Fragment q = interpolate(
      typo.runtime.Fragment.lit("insert into `mariatest`("),
      Fragment.comma(columns),
      typo.runtime.Fragment.lit("""
         )
         values ("""),
      Fragment.comma(values),
      typo.runtime.Fragment.lit("""
         )
         returning `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`
      """)
    );;
    return q.updateReturning(MariatestRow._rowParser.exactlyOne()).runUnchecked(c);
  };

  @Override
  public SelectBuilder<MariatestFields, MariatestRow> select() {
    return SelectBuilder.of("`mariatest`", MariatestFields.structure(), MariatestRow._rowParser, Dialect.MARIADB);
  };

  @Override
  public List<MariatestRow> selectAll(Connection c) {
    return interpolate(typo.runtime.Fragment.lit("""
       select `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`
       from `mariatest`
    """)).query(MariatestRow._rowParser.all()).runUnchecked(c);
  };

  @Override
  public Optional<MariatestRow> selectById(
    MariatestId intCol,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         select `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`
         from `mariatest`
         where `int_col` = """),
      MariatestId.pgType.encode(intCol),
      typo.runtime.Fragment.lit("")
    ).query(MariatestRow._rowParser.first()).runUnchecked(c);
  };

  @Override
  public List<MariatestRow> selectByIds(
    MariatestId[] intCols,
    Connection c
  ) {
    ArrayList<Fragment> fragments = new ArrayList<Fragment>();
    for (var id : intCols) { fragments.add(MariatestId.pgType.encode(id)); };
    return Fragment.interpolate(Fragment.lit("select `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col` from `mariatest` where `int_col` in ("), Fragment.comma(fragments), Fragment.lit(")")).query(MariatestRow._rowParser.all()).runUnchecked(c);
  };

  @Override
  public Map<MariatestId, MariatestRow> selectByIdsTracked(
    MariatestId[] intCols,
    Connection c
  ) {
    HashMap<MariatestId, MariatestRow> ret = new HashMap<MariatestId, MariatestRow>();
    selectByIds(intCols, c).forEach(row -> ret.put(row.intCol(), row));
    return ret;
  };

  @Override
  public UpdateBuilder<MariatestFields, MariatestRow> update() {
    return UpdateBuilder.of("`mariatest`", MariatestFields.structure(), MariatestRow._rowParser.all(), Dialect.MARIADB);
  };

  @Override
  public Boolean update(
    MariatestRow row,
    Connection c
  ) {
    MariatestId intCol = row.intCol();;
    return interpolate(
      typo.runtime.Fragment.lit("""
         update `mariatest`
         set `tinyint_col` = """),
      MariaTypes.tinyint.encode(row.tinyintCol()),
      typo.runtime.Fragment.lit("""
         ,
         `smallint_col` = """),
      MariaTypes.smallint.encode(row.smallintCol()),
      typo.runtime.Fragment.lit("""
         ,
         `mediumint_col` = """),
      MariaTypes.int_.encode(row.mediumintCol()),
      typo.runtime.Fragment.lit("""
         ,
         `bigint_col` = """),
      MariaTypes.bigint.encode(row.bigintCol()),
      typo.runtime.Fragment.lit("""
         ,
         `tinyint_u_col` = """),
      MariaTypes.smallint.encode(row.tinyintUCol()),
      typo.runtime.Fragment.lit("""
         ,
         `smallint_u_col` = """),
      MariaTypes.int_.encode(row.smallintUCol()),
      typo.runtime.Fragment.lit("""
         ,
         `mediumint_u_col` = """),
      MariaTypes.int_.encode(row.mediumintUCol()),
      typo.runtime.Fragment.lit("""
         ,
         `int_u_col` = """),
      MariaTypes.bigint.encode(row.intUCol()),
      typo.runtime.Fragment.lit("""
         ,
         `bigint_u_col` = """),
      MariaTypes.bigintUnsigned.encode(row.bigintUCol()),
      typo.runtime.Fragment.lit("""
         ,
         `decimal_col` = """),
      MariaTypes.numeric.encode(row.decimalCol()),
      typo.runtime.Fragment.lit("""
         ,
         `numeric_col` = """),
      MariaTypes.numeric.encode(row.numericCol()),
      typo.runtime.Fragment.lit("""
         ,
         `float_col` = """),
      MariaTypes.float_.encode(row.floatCol()),
      typo.runtime.Fragment.lit("""
         ,
         `double_col` = """),
      MariaTypes.double_.encode(row.doubleCol()),
      typo.runtime.Fragment.lit("""
         ,
         `bool_col` = """),
      MariaTypes.bool.encode(row.boolCol()),
      typo.runtime.Fragment.lit("""
         ,
         `bit_col` = """),
      MariaTypes.blob.encode(row.bitCol()),
      typo.runtime.Fragment.lit("""
         ,
         `bit1_col` = """),
      MariaTypes.blob.encode(row.bit1Col()),
      typo.runtime.Fragment.lit("""
         ,
         `char_col` = """),
      MariaTypes.text.encode(row.charCol()),
      typo.runtime.Fragment.lit("""
         ,
         `varchar_col` = """),
      MariaTypes.text.encode(row.varcharCol()),
      typo.runtime.Fragment.lit("""
         ,
         `tinytext_col` = """),
      MariaTypes.text.encode(row.tinytextCol()),
      typo.runtime.Fragment.lit("""
         ,
         `text_col` = """),
      MariaTypes.text.encode(row.textCol()),
      typo.runtime.Fragment.lit("""
         ,
         `mediumtext_col` = """),
      MariaTypes.text.encode(row.mediumtextCol()),
      typo.runtime.Fragment.lit("""
         ,
         `longtext_col` = """),
      MariaTypes.text.encode(row.longtextCol()),
      typo.runtime.Fragment.lit("""
         ,
         `binary_col` = """),
      MariaTypes.blob.encode(row.binaryCol()),
      typo.runtime.Fragment.lit("""
         ,
         `varbinary_col` = """),
      MariaTypes.blob.encode(row.varbinaryCol()),
      typo.runtime.Fragment.lit("""
         ,
         `tinyblob_col` = """),
      MariaTypes.blob.encode(row.tinyblobCol()),
      typo.runtime.Fragment.lit("""
         ,
         `blob_col` = """),
      MariaTypes.blob.encode(row.blobCol()),
      typo.runtime.Fragment.lit("""
         ,
         `mediumblob_col` = """),
      MariaTypes.blob.encode(row.mediumblobCol()),
      typo.runtime.Fragment.lit("""
         ,
         `longblob_col` = """),
      MariaTypes.blob.encode(row.longblobCol()),
      typo.runtime.Fragment.lit("""
         ,
         `date_col` = """),
      MariaTypes.date.encode(row.dateCol()),
      typo.runtime.Fragment.lit("""
         ,
         `time_col` = """),
      MariaTypes.time.encode(row.timeCol()),
      typo.runtime.Fragment.lit("""
         ,
         `time_fsp_col` = """),
      MariaTypes.time.encode(row.timeFspCol()),
      typo.runtime.Fragment.lit("""
         ,
         `datetime_col` = """),
      MariaTypes.datetime.encode(row.datetimeCol()),
      typo.runtime.Fragment.lit("""
         ,
         `datetime_fsp_col` = """),
      MariaTypes.datetime.encode(row.datetimeFspCol()),
      typo.runtime.Fragment.lit("""
         ,
         `timestamp_col` = """),
      MariaTypes.datetime.encode(row.timestampCol()),
      typo.runtime.Fragment.lit("""
         ,
         `timestamp_fsp_col` = """),
      MariaTypes.datetime.encode(row.timestampFspCol()),
      typo.runtime.Fragment.lit("""
         ,
         `year_col` = """),
      MariaTypes.year.encode(row.yearCol()),
      typo.runtime.Fragment.lit("""
         ,
         `enum_col` = """),
      MariaTypes.text.encode(row.enumCol()),
      typo.runtime.Fragment.lit("""
         ,
         `set_col` = """),
      MariaTypes.set.encode(row.setCol()),
      typo.runtime.Fragment.lit("""
         ,
         `json_col` = """),
      MariaTypes.text.encode(row.jsonCol()),
      typo.runtime.Fragment.lit("""
         ,
         `inet4_col` = """),
      MariaTypes.inet4.encode(row.inet4Col()),
      typo.runtime.Fragment.lit("""
         ,
         `inet6_col` = """),
      MariaTypes.inet6.encode(row.inet6Col()),
      typo.runtime.Fragment.lit("""
   
         where `int_col` = """),
      MariatestId.pgType.encode(intCol),
      typo.runtime.Fragment.lit("")
    ).update().runUnchecked(c) > 0;
  };

  @Override
  public MariatestRow upsert(
    MariatestRow unsaved,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         INSERT INTO `mariatest`(`tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`)
         VALUES ("""),
      MariaTypes.tinyint.encode(unsaved.tinyintCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.smallint.encode(unsaved.smallintCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.int_.encode(unsaved.mediumintCol()),
      typo.runtime.Fragment.lit(", "),
      MariatestId.pgType.encode(unsaved.intCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.bigint.encode(unsaved.bigintCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.smallint.encode(unsaved.tinyintUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.int_.encode(unsaved.smallintUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.int_.encode(unsaved.mediumintUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.bigint.encode(unsaved.intUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.bigintUnsigned.encode(unsaved.bigintUCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.decimalCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.numericCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.float_.encode(unsaved.floatCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.double_.encode(unsaved.doubleCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.bool.encode(unsaved.boolCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.bitCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.bit1Col()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.charCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.varcharCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.tinytextCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.textCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.mediumtextCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.longtextCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.binaryCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.varbinaryCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.tinyblobCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.blobCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.mediumblobCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.blob.encode(unsaved.longblobCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.date.encode(unsaved.dateCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.time.encode(unsaved.timeCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.time.encode(unsaved.timeFspCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.datetimeCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.datetimeFspCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.timestampCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.timestampFspCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.year.encode(unsaved.yearCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.enumCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.set.encode(unsaved.setCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.jsonCol()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.inet4.encode(unsaved.inet4Col()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.inet6.encode(unsaved.inet6Col()),
      typo.runtime.Fragment.lit("""
         )
         ON DUPLICATE KEY UPDATE `tinyint_col` = VALUES(`tinyint_col`),
         `smallint_col` = VALUES(`smallint_col`),
         `mediumint_col` = VALUES(`mediumint_col`),
         `bigint_col` = VALUES(`bigint_col`),
         `tinyint_u_col` = VALUES(`tinyint_u_col`),
         `smallint_u_col` = VALUES(`smallint_u_col`),
         `mediumint_u_col` = VALUES(`mediumint_u_col`),
         `int_u_col` = VALUES(`int_u_col`),
         `bigint_u_col` = VALUES(`bigint_u_col`),
         `decimal_col` = VALUES(`decimal_col`),
         `numeric_col` = VALUES(`numeric_col`),
         `float_col` = VALUES(`float_col`),
         `double_col` = VALUES(`double_col`),
         `bool_col` = VALUES(`bool_col`),
         `bit_col` = VALUES(`bit_col`),
         `bit1_col` = VALUES(`bit1_col`),
         `char_col` = VALUES(`char_col`),
         `varchar_col` = VALUES(`varchar_col`),
         `tinytext_col` = VALUES(`tinytext_col`),
         `text_col` = VALUES(`text_col`),
         `mediumtext_col` = VALUES(`mediumtext_col`),
         `longtext_col` = VALUES(`longtext_col`),
         `binary_col` = VALUES(`binary_col`),
         `varbinary_col` = VALUES(`varbinary_col`),
         `tinyblob_col` = VALUES(`tinyblob_col`),
         `blob_col` = VALUES(`blob_col`),
         `mediumblob_col` = VALUES(`mediumblob_col`),
         `longblob_col` = VALUES(`longblob_col`),
         `date_col` = VALUES(`date_col`),
         `time_col` = VALUES(`time_col`),
         `time_fsp_col` = VALUES(`time_fsp_col`),
         `datetime_col` = VALUES(`datetime_col`),
         `datetime_fsp_col` = VALUES(`datetime_fsp_col`),
         `timestamp_col` = VALUES(`timestamp_col`),
         `timestamp_fsp_col` = VALUES(`timestamp_fsp_col`),
         `year_col` = VALUES(`year_col`),
         `enum_col` = VALUES(`enum_col`),
         `set_col` = VALUES(`set_col`),
         `json_col` = VALUES(`json_col`),
         `inet4_col` = VALUES(`inet4_col`),
         `inet6_col` = VALUES(`inet6_col`)
         RETURNING `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`""")
    )
      .updateReturning(MariatestRow._rowParser.exactlyOne())
      .runUnchecked(c);
  };

  @Override
  public List<MariatestRow> upsertBatch(
    Iterator<MariatestRow> unsaved,
    Connection c
  ) {
    return interpolate(typo.runtime.Fragment.lit("""
                INSERT INTO `mariatest`(`tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                ON DUPLICATE KEY UPDATE `tinyint_col` = VALUES(`tinyint_col`),
                `smallint_col` = VALUES(`smallint_col`),
                `mediumint_col` = VALUES(`mediumint_col`),
                `bigint_col` = VALUES(`bigint_col`),
                `tinyint_u_col` = VALUES(`tinyint_u_col`),
                `smallint_u_col` = VALUES(`smallint_u_col`),
                `mediumint_u_col` = VALUES(`mediumint_u_col`),
                `int_u_col` = VALUES(`int_u_col`),
                `bigint_u_col` = VALUES(`bigint_u_col`),
                `decimal_col` = VALUES(`decimal_col`),
                `numeric_col` = VALUES(`numeric_col`),
                `float_col` = VALUES(`float_col`),
                `double_col` = VALUES(`double_col`),
                `bool_col` = VALUES(`bool_col`),
                `bit_col` = VALUES(`bit_col`),
                `bit1_col` = VALUES(`bit1_col`),
                `char_col` = VALUES(`char_col`),
                `varchar_col` = VALUES(`varchar_col`),
                `tinytext_col` = VALUES(`tinytext_col`),
                `text_col` = VALUES(`text_col`),
                `mediumtext_col` = VALUES(`mediumtext_col`),
                `longtext_col` = VALUES(`longtext_col`),
                `binary_col` = VALUES(`binary_col`),
                `varbinary_col` = VALUES(`varbinary_col`),
                `tinyblob_col` = VALUES(`tinyblob_col`),
                `blob_col` = VALUES(`blob_col`),
                `mediumblob_col` = VALUES(`mediumblob_col`),
                `longblob_col` = VALUES(`longblob_col`),
                `date_col` = VALUES(`date_col`),
                `time_col` = VALUES(`time_col`),
                `time_fsp_col` = VALUES(`time_fsp_col`),
                `datetime_col` = VALUES(`datetime_col`),
                `datetime_fsp_col` = VALUES(`datetime_fsp_col`),
                `timestamp_col` = VALUES(`timestamp_col`),
                `timestamp_fsp_col` = VALUES(`timestamp_fsp_col`),
                `year_col` = VALUES(`year_col`),
                `enum_col` = VALUES(`enum_col`),
                `set_col` = VALUES(`set_col`),
                `json_col` = VALUES(`json_col`),
                `inet4_col` = VALUES(`inet4_col`),
                `inet6_col` = VALUES(`inet6_col`)
                RETURNING `tinyint_col`, `smallint_col`, `mediumint_col`, `int_col`, `bigint_col`, `tinyint_u_col`, `smallint_u_col`, `mediumint_u_col`, `int_u_col`, `bigint_u_col`, `decimal_col`, `numeric_col`, `float_col`, `double_col`, `bool_col`, `bit_col`, `bit1_col`, `char_col`, `varchar_col`, `tinytext_col`, `text_col`, `mediumtext_col`, `longtext_col`, `binary_col`, `varbinary_col`, `tinyblob_col`, `blob_col`, `mediumblob_col`, `longblob_col`, `date_col`, `time_col`, `time_fsp_col`, `datetime_col`, `datetime_fsp_col`, `timestamp_col`, `timestamp_fsp_col`, `year_col`, `enum_col`, `set_col`, `json_col`, `inet4_col`, `inet6_col`"""))
      .updateReturningEach(MariatestRow._rowParser, unsaved)
      .runUnchecked(c);
  };
}
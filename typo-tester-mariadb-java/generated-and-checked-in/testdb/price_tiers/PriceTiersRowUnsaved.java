/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.price_tiers;

import com.fasterxml.jackson.annotation.JsonProperty;
import java.math.BigDecimal;
import testdb.customtypes.Defaulted;
import testdb.customtypes.Defaulted.UseDefault;
import typo.runtime.MariaText;
import typo.runtime.MariaTypes;

/** This class corresponds to a row in table `price_tiers` which has not been persisted yet */
public record PriceTiersRowUnsaved(
  /**  */
  String name,
  /**  */
  @JsonProperty("discount_type") String discountType,
  /**  */
  @JsonProperty("discount_value") BigDecimal discountValue,
  /** Default: 1

    */
  @JsonProperty("min_quantity") Defaulted<Long> minQuantity
) {
  public PriceTiersRowUnsaved(
    /**  */
    String name,
    /**  */
    @JsonProperty("discount_type") String discountType,
    /**  */
    @JsonProperty("discount_value") BigDecimal discountValue
  ) {
    this(name, discountType, discountValue, new UseDefault<>());
  };

  /**  */
  public PriceTiersRowUnsaved withName(String name) {
    return new PriceTiersRowUnsaved(name, discountType, discountValue, minQuantity);
  };

  /**  */
  public PriceTiersRowUnsaved withDiscountType(String discountType) {
    return new PriceTiersRowUnsaved(name, discountType, discountValue, minQuantity);
  };

  /**  */
  public PriceTiersRowUnsaved withDiscountValue(BigDecimal discountValue) {
    return new PriceTiersRowUnsaved(name, discountType, discountValue, minQuantity);
  };

  /** Default: 1

    */
  public PriceTiersRowUnsaved withMinQuantity(Defaulted<Long> minQuantity) {
    return new PriceTiersRowUnsaved(name, discountType, discountValue, minQuantity);
  };

  static public MariaText<PriceTiersRowUnsaved> mariaText =
    MariaText.instance((row, sb) -> {
      MariaTypes.varchar.mariaText().unsafeEncode(row.name, sb);
      sb.append(MariaText.DELIMETER);
      MariaTypes.text.mariaText().unsafeEncode(row.discountType, sb);
      sb.append(MariaText.DELIMETER);
      MariaTypes.decimal.mariaText().unsafeEncode(row.discountValue, sb);
      sb.append(MariaText.DELIMETER);
      Defaulted.mariaText(MariaTypes.intUnsigned.mariaText()).unsafeEncode(row.minQuantity, sb);
    });

  public PriceTiersRow toRow(
    java.util.function.Supplier<Long> minQuantityDefault,
    java.util.function.Supplier<PriceTiersId> tierIdDefault
  ) {
    return new PriceTiersRow(tierIdDefault.get(), name, minQuantity.getOrElse(minQuantityDefault), discountType, discountValue);
  };
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.orders;

import java.sql.Connection;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import testdb.customer_addresses.CustomerAddressesId;
import testdb.customers.CustomersId;
import testdb.promotions.PromotionsId;
import typo.dsl.DeleteBuilder;
import typo.dsl.Dialect;
import typo.dsl.SelectBuilder;
import typo.dsl.UpdateBuilder;
import typo.runtime.Fragment;
import typo.runtime.Fragment.Literal;
import typo.runtime.MariaTypes;
import static typo.runtime.Fragment.interpolate;

public class OrdersRepoImpl implements OrdersRepo {
  @Override
  public DeleteBuilder<OrdersFields, OrdersRow> delete() {
    return DeleteBuilder.of("`orders`", OrdersFields.structure(), Dialect.MARIADB);
  };

  @Override
  public Boolean deleteById(
    OrdersId orderId,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("delete from `orders` where `order_id` = "),
      OrdersId.pgType.encode(orderId),
      typo.runtime.Fragment.lit("")
    ).update().runUnchecked(c) > 0;
  };

  @Override
  public Integer deleteByIds(
    OrdersId[] orderIds,
    Connection c
  ) {
    ArrayList<Fragment> fragments = new ArrayList<Fragment>();
    for (var id : orderIds) { fragments.add(OrdersId.pgType.encode(id)); };
    return Fragment.interpolate(Fragment.lit("delete from `orders` where `order_id` in ("), Fragment.comma(fragments), Fragment.lit(")")).update().runUnchecked(c);
  };

  @Override
  public OrdersRow insert(
    OrdersRow unsaved,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         insert into `orders`(`order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`)
         values ("""),
      MariaTypes.text.encode(unsaved.orderNumber()),
      typo.runtime.Fragment.lit(", "),
      CustomersId.pgType.encode(unsaved.customerId()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.orderStatus()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.paymentStatus()),
      typo.runtime.Fragment.lit(", "),
      CustomerAddressesId.pgType.opt().encode(unsaved.shippingAddressId()),
      typo.runtime.Fragment.lit(", "),
      CustomerAddressesId.pgType.opt().encode(unsaved.billingAddressId()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.subtotal()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.shippingCost()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.taxAmount()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.discountAmount()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.totalAmount()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.currencyCode()),
      typo.runtime.Fragment.lit(", "),
      PromotionsId.pgType.opt().encode(unsaved.promotionId()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.opt().encode(unsaved.notes()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.opt().encode(unsaved.internalNotes()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.inet6.opt().encode(unsaved.ipAddress()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.opt().encode(unsaved.userAgent()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.orderedAt()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.opt().encode(unsaved.confirmedAt()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.opt().encode(unsaved.shippedAt()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.opt().encode(unsaved.deliveredAt()),
      typo.runtime.Fragment.lit("""
         )
         returning `order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`
      """)
    )
      .updateReturning(OrdersRow._rowParser.exactlyOne()).runUnchecked(c);
  };

  @Override
  public OrdersRow insert(
    OrdersRowUnsaved unsaved,
    Connection c
  ) {
    ArrayList<Literal> columns = new ArrayList<Literal>();;
    ArrayList<Fragment> values = new ArrayList<Fragment>();;
    columns.add(Fragment.lit("`order_number`"));
    values.add(interpolate(
      MariaTypes.text.encode(unsaved.orderNumber()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`customer_id`"));
    values.add(interpolate(
      CustomersId.pgType.encode(unsaved.customerId()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`subtotal`"));
    values.add(interpolate(
      MariaTypes.numeric.encode(unsaved.subtotal()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    columns.add(Fragment.lit("`total_amount`"));
    values.add(interpolate(
      MariaTypes.numeric.encode(unsaved.totalAmount()),
      typo.runtime.Fragment.lit("""
      """)
    ));
    unsaved.orderStatus().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`order_status`"));
        values.add(interpolate(
        MariaTypes.text.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.paymentStatus().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`payment_status`"));
        values.add(interpolate(
        MariaTypes.text.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.shippingAddressId().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`shipping_address_id`"));
        values.add(interpolate(
        CustomerAddressesId.pgType.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.billingAddressId().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`billing_address_id`"));
        values.add(interpolate(
        CustomerAddressesId.pgType.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.shippingCost().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`shipping_cost`"));
        values.add(interpolate(
        MariaTypes.numeric.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.taxAmount().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`tax_amount`"));
        values.add(interpolate(
        MariaTypes.numeric.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.discountAmount().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`discount_amount`"));
        values.add(interpolate(
        MariaTypes.numeric.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.currencyCode().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`currency_code`"));
        values.add(interpolate(
        MariaTypes.text.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.promotionId().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`promotion_id`"));
        values.add(interpolate(
        PromotionsId.pgType.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.notes().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`notes`"));
        values.add(interpolate(
        MariaTypes.text.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.internalNotes().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`internal_notes`"));
        values.add(interpolate(
        MariaTypes.text.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.ipAddress().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`ip_address`"));
        values.add(interpolate(
        MariaTypes.inet6.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.userAgent().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`user_agent`"));
        values.add(interpolate(
        MariaTypes.text.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.orderedAt().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`ordered_at`"));
        values.add(interpolate(
        MariaTypes.datetime.encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.confirmedAt().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`confirmed_at`"));
        values.add(interpolate(
        MariaTypes.datetime.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.shippedAt().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`shipped_at`"));
        values.add(interpolate(
        MariaTypes.datetime.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    unsaved.deliveredAt().visit(
      () -> {
  
      },
      value -> {
        columns.add(Fragment.lit("`delivered_at`"));
        values.add(interpolate(
        MariaTypes.datetime.opt().encode(value),
        typo.runtime.Fragment.lit("""
        """)
      ));
      }
    );;
    Fragment q = interpolate(
      typo.runtime.Fragment.lit("insert into `orders`("),
      Fragment.comma(columns),
      typo.runtime.Fragment.lit("""
         )
         values ("""),
      Fragment.comma(values),
      typo.runtime.Fragment.lit("""
         )
         returning `order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`
      """)
    );;
    return q.updateReturning(OrdersRow._rowParser.exactlyOne()).runUnchecked(c);
  };

  @Override
  public SelectBuilder<OrdersFields, OrdersRow> select() {
    return SelectBuilder.of("`orders`", OrdersFields.structure(), OrdersRow._rowParser, Dialect.MARIADB);
  };

  @Override
  public List<OrdersRow> selectAll(Connection c) {
    return interpolate(typo.runtime.Fragment.lit("""
       select `order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`
       from `orders`
    """)).query(OrdersRow._rowParser.all()).runUnchecked(c);
  };

  @Override
  public Optional<OrdersRow> selectById(
    OrdersId orderId,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         select `order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`
         from `orders`
         where `order_id` = """),
      OrdersId.pgType.encode(orderId),
      typo.runtime.Fragment.lit("")
    ).query(OrdersRow._rowParser.first()).runUnchecked(c);
  };

  @Override
  public List<OrdersRow> selectByIds(
    OrdersId[] orderIds,
    Connection c
  ) {
    ArrayList<Fragment> fragments = new ArrayList<Fragment>();
    for (var id : orderIds) { fragments.add(OrdersId.pgType.encode(id)); };
    return Fragment.interpolate(Fragment.lit("select `order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at` from `orders` where `order_id` in ("), Fragment.comma(fragments), Fragment.lit(")")).query(OrdersRow._rowParser.all()).runUnchecked(c);
  };

  @Override
  public Map<OrdersId, OrdersRow> selectByIdsTracked(
    OrdersId[] orderIds,
    Connection c
  ) {
    HashMap<OrdersId, OrdersRow> ret = new HashMap<OrdersId, OrdersRow>();
    selectByIds(orderIds, c).forEach(row -> ret.put(row.orderId(), row));
    return ret;
  };

  @Override
  public Optional<OrdersRow> selectByUniqueOrderNumber(
    String orderNumber,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         select `order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`
         from `orders`
         where `order_number` = """),
      MariaTypes.text.encode(orderNumber),
      typo.runtime.Fragment.lit("""


      """)
    ).query(OrdersRow._rowParser.first()).runUnchecked(c);
  };

  @Override
  public UpdateBuilder<OrdersFields, OrdersRow> update() {
    return UpdateBuilder.of("`orders`", OrdersFields.structure(), OrdersRow._rowParser.all(), Dialect.MARIADB);
  };

  @Override
  public Boolean update(
    OrdersRow row,
    Connection c
  ) {
    OrdersId orderId = row.orderId();;
    return interpolate(
      typo.runtime.Fragment.lit("""
         update `orders`
         set `order_number` = """),
      MariaTypes.text.encode(row.orderNumber()),
      typo.runtime.Fragment.lit("""
         ,
         `customer_id` = """),
      CustomersId.pgType.encode(row.customerId()),
      typo.runtime.Fragment.lit("""
         ,
         `order_status` = """),
      MariaTypes.text.encode(row.orderStatus()),
      typo.runtime.Fragment.lit("""
         ,
         `payment_status` = """),
      MariaTypes.text.encode(row.paymentStatus()),
      typo.runtime.Fragment.lit("""
         ,
         `shipping_address_id` = """),
      CustomerAddressesId.pgType.opt().encode(row.shippingAddressId()),
      typo.runtime.Fragment.lit("""
         ,
         `billing_address_id` = """),
      CustomerAddressesId.pgType.opt().encode(row.billingAddressId()),
      typo.runtime.Fragment.lit("""
         ,
         `subtotal` = """),
      MariaTypes.numeric.encode(row.subtotal()),
      typo.runtime.Fragment.lit("""
         ,
         `shipping_cost` = """),
      MariaTypes.numeric.encode(row.shippingCost()),
      typo.runtime.Fragment.lit("""
         ,
         `tax_amount` = """),
      MariaTypes.numeric.encode(row.taxAmount()),
      typo.runtime.Fragment.lit("""
         ,
         `discount_amount` = """),
      MariaTypes.numeric.encode(row.discountAmount()),
      typo.runtime.Fragment.lit("""
         ,
         `total_amount` = """),
      MariaTypes.numeric.encode(row.totalAmount()),
      typo.runtime.Fragment.lit("""
         ,
         `currency_code` = """),
      MariaTypes.text.encode(row.currencyCode()),
      typo.runtime.Fragment.lit("""
         ,
         `promotion_id` = """),
      PromotionsId.pgType.opt().encode(row.promotionId()),
      typo.runtime.Fragment.lit("""
         ,
         `notes` = """),
      MariaTypes.text.opt().encode(row.notes()),
      typo.runtime.Fragment.lit("""
         ,
         `internal_notes` = """),
      MariaTypes.text.opt().encode(row.internalNotes()),
      typo.runtime.Fragment.lit("""
         ,
         `ip_address` = """),
      MariaTypes.inet6.opt().encode(row.ipAddress()),
      typo.runtime.Fragment.lit("""
         ,
         `user_agent` = """),
      MariaTypes.text.opt().encode(row.userAgent()),
      typo.runtime.Fragment.lit("""
         ,
         `ordered_at` = """),
      MariaTypes.datetime.encode(row.orderedAt()),
      typo.runtime.Fragment.lit("""
         ,
         `confirmed_at` = """),
      MariaTypes.datetime.opt().encode(row.confirmedAt()),
      typo.runtime.Fragment.lit("""
         ,
         `shipped_at` = """),
      MariaTypes.datetime.opt().encode(row.shippedAt()),
      typo.runtime.Fragment.lit("""
         ,
         `delivered_at` = """),
      MariaTypes.datetime.opt().encode(row.deliveredAt()),
      typo.runtime.Fragment.lit("""
   
         where `order_id` = """),
      OrdersId.pgType.encode(orderId),
      typo.runtime.Fragment.lit("")
    ).update().runUnchecked(c) > 0;
  };

  @Override
  public OrdersRow upsert(
    OrdersRow unsaved,
    Connection c
  ) {
    return interpolate(
      typo.runtime.Fragment.lit("""
         INSERT INTO `orders`(`order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`)
         VALUES ("""),
      MariaTypes.text.encode(unsaved.orderNumber()),
      typo.runtime.Fragment.lit(", "),
      CustomersId.pgType.encode(unsaved.customerId()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.orderStatus()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.paymentStatus()),
      typo.runtime.Fragment.lit(", "),
      CustomerAddressesId.pgType.opt().encode(unsaved.shippingAddressId()),
      typo.runtime.Fragment.lit(", "),
      CustomerAddressesId.pgType.opt().encode(unsaved.billingAddressId()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.subtotal()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.shippingCost()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.taxAmount()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.discountAmount()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.numeric.encode(unsaved.totalAmount()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.encode(unsaved.currencyCode()),
      typo.runtime.Fragment.lit(", "),
      PromotionsId.pgType.opt().encode(unsaved.promotionId()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.opt().encode(unsaved.notes()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.opt().encode(unsaved.internalNotes()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.inet6.opt().encode(unsaved.ipAddress()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.text.opt().encode(unsaved.userAgent()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.encode(unsaved.orderedAt()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.opt().encode(unsaved.confirmedAt()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.opt().encode(unsaved.shippedAt()),
      typo.runtime.Fragment.lit(", "),
      MariaTypes.datetime.opt().encode(unsaved.deliveredAt()),
      typo.runtime.Fragment.lit("""
         )
         ON DUPLICATE KEY UPDATE `order_number` = VALUES(`order_number`),
         `customer_id` = VALUES(`customer_id`),
         `order_status` = VALUES(`order_status`),
         `payment_status` = VALUES(`payment_status`),
         `shipping_address_id` = VALUES(`shipping_address_id`),
         `billing_address_id` = VALUES(`billing_address_id`),
         `subtotal` = VALUES(`subtotal`),
         `shipping_cost` = VALUES(`shipping_cost`),
         `tax_amount` = VALUES(`tax_amount`),
         `discount_amount` = VALUES(`discount_amount`),
         `total_amount` = VALUES(`total_amount`),
         `currency_code` = VALUES(`currency_code`),
         `promotion_id` = VALUES(`promotion_id`),
         `notes` = VALUES(`notes`),
         `internal_notes` = VALUES(`internal_notes`),
         `ip_address` = VALUES(`ip_address`),
         `user_agent` = VALUES(`user_agent`),
         `ordered_at` = VALUES(`ordered_at`),
         `confirmed_at` = VALUES(`confirmed_at`),
         `shipped_at` = VALUES(`shipped_at`),
         `delivered_at` = VALUES(`delivered_at`)
         RETURNING `order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`""")
    )
      .updateReturning(OrdersRow._rowParser.exactlyOne())
      .runUnchecked(c);
  };

  @Override
  public List<OrdersRow> upsertBatch(
    Iterator<OrdersRow> unsaved,
    Connection c
  ) {
    return interpolate(typo.runtime.Fragment.lit("""
                INSERT INTO `orders`(`order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                ON DUPLICATE KEY UPDATE `order_number` = VALUES(`order_number`),
                `customer_id` = VALUES(`customer_id`),
                `order_status` = VALUES(`order_status`),
                `payment_status` = VALUES(`payment_status`),
                `shipping_address_id` = VALUES(`shipping_address_id`),
                `billing_address_id` = VALUES(`billing_address_id`),
                `subtotal` = VALUES(`subtotal`),
                `shipping_cost` = VALUES(`shipping_cost`),
                `tax_amount` = VALUES(`tax_amount`),
                `discount_amount` = VALUES(`discount_amount`),
                `total_amount` = VALUES(`total_amount`),
                `currency_code` = VALUES(`currency_code`),
                `promotion_id` = VALUES(`promotion_id`),
                `notes` = VALUES(`notes`),
                `internal_notes` = VALUES(`internal_notes`),
                `ip_address` = VALUES(`ip_address`),
                `user_agent` = VALUES(`user_agent`),
                `ordered_at` = VALUES(`ordered_at`),
                `confirmed_at` = VALUES(`confirmed_at`),
                `shipped_at` = VALUES(`shipped_at`),
                `delivered_at` = VALUES(`delivered_at`)
                RETURNING `order_id`, `order_number`, `customer_id`, `order_status`, `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`, `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`, `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`, `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`"""))
      .updateReturningEach(OrdersRow._rowParser, unsaved)
      .runUnchecked(c);
  };
}
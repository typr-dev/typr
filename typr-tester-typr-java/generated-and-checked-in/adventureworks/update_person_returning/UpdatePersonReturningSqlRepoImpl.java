/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.update_person_returning;

import static typr.runtime.Fragment.interpolate;

import java.sql.Connection;
import java.time.LocalDateTime;
import java.util.List;
import java.util.Optional;
import typr.runtime.Fragment;
import typr.runtime.PgTypes;

public class UpdatePersonReturningSqlRepoImpl implements UpdatePersonReturningSqlRepo {
  @Override
  public List<UpdatePersonReturningSqlRow> apply(
      /* nullability unknown */ Optional<String> suffix,
      /* nullability unknown */ Optional<LocalDateTime> cutoff,
      Connection c) {
    return interpolate(
            Fragment.lit("update person.person\nset firstname = firstname || '-' || "),
            Fragment.encode(PgTypes.text.opt(), suffix),
            Fragment.lit("\nwhere modifieddate < "),
            Fragment.encode(PgTypes.timestamp.opt(), cutoff),
            Fragment.lit("::timestamp\nreturning firstname, modifieddate"))
        .query(UpdatePersonReturningSqlRow._rowParser.all())
        .runUnchecked(c);
  }
  ;
}

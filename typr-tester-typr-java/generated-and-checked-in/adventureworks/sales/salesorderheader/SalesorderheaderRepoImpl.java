/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.sales.salesorderheader;

import static typr.runtime.Fragment.interpolate;

import adventureworks.person.address.AddressId;
import adventureworks.person.businessentity.BusinessentityId;
import adventureworks.public_.AccountNumber;
import adventureworks.public_.Flag;
import adventureworks.public_.OrderNumber;
import adventureworks.purchasing.shipmethod.ShipmethodId;
import adventureworks.sales.currencyrate.CurrencyrateId;
import adventureworks.sales.customer.CustomerId;
import adventureworks.sales.salesterritory.SalesterritoryId;
import adventureworks.userdefined.CustomCreditcardId;
import java.sql.Connection;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import typr.dsl.DeleteBuilder;
import typr.dsl.Dialect;
import typr.dsl.SelectBuilder;
import typr.dsl.UpdateBuilder;
import typr.runtime.Fragment;
import typr.runtime.PgTypes;
import typr.runtime.streamingInsert;

public class SalesorderheaderRepoImpl implements SalesorderheaderRepo {
  @Override
  public DeleteBuilder<SalesorderheaderFields, SalesorderheaderRow> delete() {
    return DeleteBuilder.of(
        "\"sales\".\"salesorderheader\"", SalesorderheaderFields.structure(), Dialect.POSTGRESQL);
  }
  ;

  @Override
  public Boolean deleteById(SalesorderheaderId salesorderid, Connection c) {
    return interpolate(
                Fragment.lit(
                    "delete from \"sales\".\"salesorderheader\" where \"salesorderid\" = "),
                Fragment.encode(SalesorderheaderId.pgType, salesorderid),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }
  ;

  @Override
  public Integer deleteByIds(SalesorderheaderId[] salesorderids, Connection c) {
    return interpolate(
            Fragment.lit(
                "delete\nfrom \"sales\".\"salesorderheader\"\nwhere \"salesorderid\" = ANY("),
            Fragment.encode(SalesorderheaderId.pgTypeArray, salesorderids),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }
  ;

  @Override
  public SalesorderheaderRow insert(SalesorderheaderRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\","
                    + " \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\","
                    + " \"purchaseordernumber\", \"accountnumber\", \"customerid\","
                    + " \"salespersonid\", \"territoryid\", \"billtoaddressid\","
                    + " \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\","
                    + " \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\","
                    + " \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")\n"
                    + "values ("),
            Fragment.encode(SalesorderheaderId.pgType, unsaved.salesorderid()),
            Fragment.lit("::int4, "),
            Fragment.encode(PgTypes.int2, unsaved.revisionnumber()),
            Fragment.lit("::int2, "),
            Fragment.encode(PgTypes.timestamp, unsaved.orderdate()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamp, unsaved.duedate()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamp.opt(), unsaved.shipdate()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.int2, unsaved.status()),
            Fragment.lit("::int2, "),
            Fragment.encode(Flag.pgType, unsaved.onlineorderflag()),
            Fragment.lit("::bool, "),
            Fragment.encode(OrderNumber.pgType.opt(), unsaved.purchaseordernumber()),
            Fragment.lit("::varchar, "),
            Fragment.encode(AccountNumber.pgType.opt(), unsaved.accountnumber()),
            Fragment.lit("::varchar, "),
            Fragment.encode(CustomerId.pgType, unsaved.customerid()),
            Fragment.lit("::int4, "),
            Fragment.encode(BusinessentityId.pgType.opt(), unsaved.salespersonid()),
            Fragment.lit("::int4, "),
            Fragment.encode(SalesterritoryId.pgType.opt(), unsaved.territoryid()),
            Fragment.lit("::int4, "),
            Fragment.encode(AddressId.pgType, unsaved.billtoaddressid()),
            Fragment.lit("::int4, "),
            Fragment.encode(AddressId.pgType, unsaved.shiptoaddressid()),
            Fragment.lit("::int4, "),
            Fragment.encode(ShipmethodId.pgType, unsaved.shipmethodid()),
            Fragment.lit("::int4, "),
            Fragment.encode(CustomCreditcardId.pgType.opt(), unsaved.creditcardid()),
            Fragment.lit("::int4, "),
            Fragment.encode(PgTypes.text.opt(), unsaved.creditcardapprovalcode()),
            Fragment.lit(", "),
            Fragment.encode(CurrencyrateId.pgType.opt(), unsaved.currencyrateid()),
            Fragment.lit("::int4, "),
            Fragment.encode(PgTypes.numeric, unsaved.subtotal()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.taxamt()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.freight()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric.opt(), unsaved.totaldue()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.text.opt(), unsaved.comment()),
            Fragment.lit(", "),
            Fragment.encode(PgTypes.uuid, unsaved.rowguid()),
            Fragment.lit("::uuid, "),
            Fragment.encode(PgTypes.timestamp, unsaved.modifieddate()),
            Fragment.lit(
                "::timestamp)\n"
                    + "RETURNING \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\","
                    + " \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\","
                    + " \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\","
                    + " \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
                    + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\","
                    + " \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\","
                    + " \"rowguid\", \"modifieddate\"\n"))
        .updateReturning(SalesorderheaderRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }
  ;

  @Override
  public SalesorderheaderRow insert(SalesorderheaderRowUnsaved unsaved, Connection c) {
    ArrayList<Fragment> columns = new ArrayList<>();
    ;
    ArrayList<Fragment> values = new ArrayList<>();
    ;
    columns.add(Fragment.lit("\"duedate\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.timestamp, unsaved.duedate()), Fragment.lit("::timestamp")));
    columns.add(Fragment.lit("\"shipdate\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.timestamp.opt(), unsaved.shipdate()),
            Fragment.lit("::timestamp")));
    columns.add(Fragment.lit("\"purchaseordernumber\""));
    values.add(
        interpolate(
            Fragment.encode(OrderNumber.pgType.opt(), unsaved.purchaseordernumber()),
            Fragment.lit("::varchar")));
    columns.add(Fragment.lit("\"accountnumber\""));
    values.add(
        interpolate(
            Fragment.encode(AccountNumber.pgType.opt(), unsaved.accountnumber()),
            Fragment.lit("::varchar")));
    columns.add(Fragment.lit("\"customerid\""));
    values.add(
        interpolate(
            Fragment.encode(CustomerId.pgType, unsaved.customerid()), Fragment.lit("::int4")));
    columns.add(Fragment.lit("\"salespersonid\""));
    values.add(
        interpolate(
            Fragment.encode(BusinessentityId.pgType.opt(), unsaved.salespersonid()),
            Fragment.lit("::int4")));
    columns.add(Fragment.lit("\"territoryid\""));
    values.add(
        interpolate(
            Fragment.encode(SalesterritoryId.pgType.opt(), unsaved.territoryid()),
            Fragment.lit("::int4")));
    columns.add(Fragment.lit("\"billtoaddressid\""));
    values.add(
        interpolate(
            Fragment.encode(AddressId.pgType, unsaved.billtoaddressid()), Fragment.lit("::int4")));
    columns.add(Fragment.lit("\"shiptoaddressid\""));
    values.add(
        interpolate(
            Fragment.encode(AddressId.pgType, unsaved.shiptoaddressid()), Fragment.lit("::int4")));
    columns.add(Fragment.lit("\"shipmethodid\""));
    values.add(
        interpolate(
            Fragment.encode(ShipmethodId.pgType, unsaved.shipmethodid()), Fragment.lit("::int4")));
    columns.add(Fragment.lit("\"creditcardid\""));
    values.add(
        interpolate(
            Fragment.encode(CustomCreditcardId.pgType.opt(), unsaved.creditcardid()),
            Fragment.lit("::int4")));
    columns.add(Fragment.lit("\"creditcardapprovalcode\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.text.opt(), unsaved.creditcardapprovalcode()),
            Fragment.lit("")));
    columns.add(Fragment.lit("\"currencyrateid\""));
    values.add(
        interpolate(
            Fragment.encode(CurrencyrateId.pgType.opt(), unsaved.currencyrateid()),
            Fragment.lit("::int4")));
    columns.add(Fragment.lit("\"totaldue\""));
    values.add(
        interpolate(
            Fragment.encode(PgTypes.numeric.opt(), unsaved.totaldue()), Fragment.lit("::numeric")));
    columns.add(Fragment.lit("\"comment\""));
    values.add(
        interpolate(Fragment.encode(PgTypes.text.opt(), unsaved.comment()), Fragment.lit("")));
    unsaved
        .salesorderid()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"salesorderid\""));
              values.add(
                  interpolate(
                      Fragment.encode(SalesorderheaderId.pgType, value), Fragment.lit("::int4")));
            });
    ;
    unsaved
        .revisionnumber()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"revisionnumber\""));
              values.add(interpolate(Fragment.encode(PgTypes.int2, value), Fragment.lit("::int2")));
            });
    ;
    unsaved
        .orderdate()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"orderdate\""));
              values.add(
                  interpolate(
                      Fragment.encode(PgTypes.timestamp, value), Fragment.lit("::timestamp")));
            });
    ;
    unsaved
        .status()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"status\""));
              values.add(interpolate(Fragment.encode(PgTypes.int2, value), Fragment.lit("::int2")));
            });
    ;
    unsaved
        .onlineorderflag()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"onlineorderflag\""));
              values.add(interpolate(Fragment.encode(Flag.pgType, value), Fragment.lit("::bool")));
            });
    ;
    unsaved
        .subtotal()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"subtotal\""));
              values.add(
                  interpolate(Fragment.encode(PgTypes.numeric, value), Fragment.lit("::numeric")));
            });
    ;
    unsaved
        .taxamt()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"taxamt\""));
              values.add(
                  interpolate(Fragment.encode(PgTypes.numeric, value), Fragment.lit("::numeric")));
            });
    ;
    unsaved
        .freight()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"freight\""));
              values.add(
                  interpolate(Fragment.encode(PgTypes.numeric, value), Fragment.lit("::numeric")));
            });
    ;
    unsaved
        .rowguid()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"rowguid\""));
              values.add(interpolate(Fragment.encode(PgTypes.uuid, value), Fragment.lit("::uuid")));
            });
    ;
    unsaved
        .modifieddate()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("\"modifieddate\""));
              values.add(
                  interpolate(
                      Fragment.encode(PgTypes.timestamp, value), Fragment.lit("::timestamp")));
            });
    ;
    Fragment q =
        interpolate(
            Fragment.lit("insert into \"sales\".\"salesorderheader\"("),
            Fragment.comma(columns),
            Fragment.lit(")\nvalues ("),
            Fragment.comma(values),
            Fragment.lit(
                ")\n"
                    + "RETURNING \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\","
                    + " \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\","
                    + " \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\","
                    + " \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
                    + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\","
                    + " \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\","
                    + " \"rowguid\", \"modifieddate\"\n"));
    ;
    return q.updateReturning(SalesorderheaderRow._rowParser.exactlyOne()).runUnchecked(c);
  }
  ;

  @Override
  public Long insertStreaming(
      Iterator<SalesorderheaderRow> unsaved, Integer batchSize, Connection c) {
    return streamingInsert.insertUnchecked(
        "COPY \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\", \"orderdate\","
            + " \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\","
            + " \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\","
            + " \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
            + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\","
            + " \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")"
            + " FROM STDIN",
        batchSize,
        unsaved,
        c,
        SalesorderheaderRow.pgText);
  }
  ;

  /** NOTE: this functionality requires PostgreSQL 16 or later! */
  @Override
  public Long insertUnsavedStreaming(
      Iterator<SalesorderheaderRowUnsaved> unsaved, Integer batchSize, Connection c) {
    return streamingInsert.insertUnchecked(
        "COPY \"sales\".\"salesorderheader\"(\"duedate\", \"shipdate\", \"purchaseordernumber\","
            + " \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\","
            + " \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\","
            + " \"creditcardapprovalcode\", \"currencyrateid\", \"totaldue\", \"comment\","
            + " \"salesorderid\", \"revisionnumber\", \"orderdate\", \"status\","
            + " \"onlineorderflag\", \"subtotal\", \"taxamt\", \"freight\", \"rowguid\","
            + " \"modifieddate\") FROM STDIN (DEFAULT '__DEFAULT_VALUE__')",
        batchSize,
        unsaved,
        c,
        SalesorderheaderRowUnsaved.pgText);
  }
  ;

  @Override
  public SelectBuilder<SalesorderheaderFields, SalesorderheaderRow> select() {
    return SelectBuilder.of(
        "\"sales\".\"salesorderheader\"",
        SalesorderheaderFields.structure(),
        SalesorderheaderRow._rowParser,
        Dialect.POSTGRESQL);
  }
  ;

  @Override
  public List<SalesorderheaderRow> selectAll(Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\","
                    + " \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\","
                    + " \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\","
                    + " \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
                    + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\","
                    + " \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\","
                    + " \"rowguid\", \"modifieddate\"\n"
                    + "from \"sales\".\"salesorderheader\"\n"))
        .query(SalesorderheaderRow._rowParser.all())
        .runUnchecked(c);
  }
  ;

  @Override
  public Optional<SalesorderheaderRow> selectById(SalesorderheaderId salesorderid, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\","
                    + " \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\","
                    + " \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\","
                    + " \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
                    + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\","
                    + " \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\","
                    + " \"rowguid\", \"modifieddate\"\n"
                    + "from \"sales\".\"salesorderheader\"\n"
                    + "where \"salesorderid\" = "),
            Fragment.encode(SalesorderheaderId.pgType, salesorderid),
            Fragment.lit(""))
        .query(SalesorderheaderRow._rowParser.first())
        .runUnchecked(c);
  }
  ;

  @Override
  public List<SalesorderheaderRow> selectByIds(SalesorderheaderId[] salesorderids, Connection c) {
    return interpolate(
            Fragment.lit(
                "select \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\","
                    + " \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\","
                    + " \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\","
                    + " \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
                    + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\","
                    + " \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\","
                    + " \"rowguid\", \"modifieddate\"\n"
                    + "from \"sales\".\"salesorderheader\"\n"
                    + "where \"salesorderid\" = ANY("),
            Fragment.encode(SalesorderheaderId.pgTypeArray, salesorderids),
            Fragment.lit(")"))
        .query(SalesorderheaderRow._rowParser.all())
        .runUnchecked(c);
  }
  ;

  @Override
  public Map<SalesorderheaderId, SalesorderheaderRow> selectByIdsTracked(
      SalesorderheaderId[] salesorderids, Connection c) {
    HashMap<SalesorderheaderId, SalesorderheaderRow> ret =
        new HashMap<SalesorderheaderId, SalesorderheaderRow>();
    selectByIds(salesorderids, c).forEach(row -> ret.put(row.salesorderid(), row));
    return ret;
  }
  ;

  @Override
  public UpdateBuilder<SalesorderheaderFields, SalesorderheaderRow> update() {
    return UpdateBuilder.of(
        "\"sales\".\"salesorderheader\"",
        SalesorderheaderFields.structure(),
        SalesorderheaderRow._rowParser,
        Dialect.POSTGRESQL);
  }
  ;

  @Override
  public Boolean update(SalesorderheaderRow row, Connection c) {
    SalesorderheaderId salesorderid = row.salesorderid();
    ;
    return interpolate(
                Fragment.lit("update \"sales\".\"salesorderheader\"\nset \"revisionnumber\" = "),
                Fragment.encode(PgTypes.int2, row.revisionnumber()),
                Fragment.lit("::int2,\n\"orderdate\" = "),
                Fragment.encode(PgTypes.timestamp, row.orderdate()),
                Fragment.lit("::timestamp,\n\"duedate\" = "),
                Fragment.encode(PgTypes.timestamp, row.duedate()),
                Fragment.lit("::timestamp,\n\"shipdate\" = "),
                Fragment.encode(PgTypes.timestamp.opt(), row.shipdate()),
                Fragment.lit("::timestamp,\n\"status\" = "),
                Fragment.encode(PgTypes.int2, row.status()),
                Fragment.lit("::int2,\n\"onlineorderflag\" = "),
                Fragment.encode(Flag.pgType, row.onlineorderflag()),
                Fragment.lit("::bool,\n\"purchaseordernumber\" = "),
                Fragment.encode(OrderNumber.pgType.opt(), row.purchaseordernumber()),
                Fragment.lit("::varchar,\n\"accountnumber\" = "),
                Fragment.encode(AccountNumber.pgType.opt(), row.accountnumber()),
                Fragment.lit("::varchar,\n\"customerid\" = "),
                Fragment.encode(CustomerId.pgType, row.customerid()),
                Fragment.lit("::int4,\n\"salespersonid\" = "),
                Fragment.encode(BusinessentityId.pgType.opt(), row.salespersonid()),
                Fragment.lit("::int4,\n\"territoryid\" = "),
                Fragment.encode(SalesterritoryId.pgType.opt(), row.territoryid()),
                Fragment.lit("::int4,\n\"billtoaddressid\" = "),
                Fragment.encode(AddressId.pgType, row.billtoaddressid()),
                Fragment.lit("::int4,\n\"shiptoaddressid\" = "),
                Fragment.encode(AddressId.pgType, row.shiptoaddressid()),
                Fragment.lit("::int4,\n\"shipmethodid\" = "),
                Fragment.encode(ShipmethodId.pgType, row.shipmethodid()),
                Fragment.lit("::int4,\n\"creditcardid\" = "),
                Fragment.encode(CustomCreditcardId.pgType.opt(), row.creditcardid()),
                Fragment.lit("::int4,\n\"creditcardapprovalcode\" = "),
                Fragment.encode(PgTypes.text.opt(), row.creditcardapprovalcode()),
                Fragment.lit(",\n\"currencyrateid\" = "),
                Fragment.encode(CurrencyrateId.pgType.opt(), row.currencyrateid()),
                Fragment.lit("::int4,\n\"subtotal\" = "),
                Fragment.encode(PgTypes.numeric, row.subtotal()),
                Fragment.lit("::numeric,\n\"taxamt\" = "),
                Fragment.encode(PgTypes.numeric, row.taxamt()),
                Fragment.lit("::numeric,\n\"freight\" = "),
                Fragment.encode(PgTypes.numeric, row.freight()),
                Fragment.lit("::numeric,\n\"totaldue\" = "),
                Fragment.encode(PgTypes.numeric.opt(), row.totaldue()),
                Fragment.lit("::numeric,\n\"comment\" = "),
                Fragment.encode(PgTypes.text.opt(), row.comment()),
                Fragment.lit(",\n\"rowguid\" = "),
                Fragment.encode(PgTypes.uuid, row.rowguid()),
                Fragment.lit("::uuid,\n\"modifieddate\" = "),
                Fragment.encode(PgTypes.timestamp, row.modifieddate()),
                Fragment.lit("::timestamp\nwhere \"salesorderid\" = "),
                Fragment.encode(SalesorderheaderId.pgType, salesorderid),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }
  ;

  @Override
  public SalesorderheaderRow upsert(SalesorderheaderRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\","
                    + " \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\","
                    + " \"purchaseordernumber\", \"accountnumber\", \"customerid\","
                    + " \"salespersonid\", \"territoryid\", \"billtoaddressid\","
                    + " \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\","
                    + " \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\","
                    + " \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")\n"
                    + "values ("),
            Fragment.encode(SalesorderheaderId.pgType, unsaved.salesorderid()),
            Fragment.lit("::int4, "),
            Fragment.encode(PgTypes.int2, unsaved.revisionnumber()),
            Fragment.lit("::int2, "),
            Fragment.encode(PgTypes.timestamp, unsaved.orderdate()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamp, unsaved.duedate()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.timestamp.opt(), unsaved.shipdate()),
            Fragment.lit("::timestamp, "),
            Fragment.encode(PgTypes.int2, unsaved.status()),
            Fragment.lit("::int2, "),
            Fragment.encode(Flag.pgType, unsaved.onlineorderflag()),
            Fragment.lit("::bool, "),
            Fragment.encode(OrderNumber.pgType.opt(), unsaved.purchaseordernumber()),
            Fragment.lit("::varchar, "),
            Fragment.encode(AccountNumber.pgType.opt(), unsaved.accountnumber()),
            Fragment.lit("::varchar, "),
            Fragment.encode(CustomerId.pgType, unsaved.customerid()),
            Fragment.lit("::int4, "),
            Fragment.encode(BusinessentityId.pgType.opt(), unsaved.salespersonid()),
            Fragment.lit("::int4, "),
            Fragment.encode(SalesterritoryId.pgType.opt(), unsaved.territoryid()),
            Fragment.lit("::int4, "),
            Fragment.encode(AddressId.pgType, unsaved.billtoaddressid()),
            Fragment.lit("::int4, "),
            Fragment.encode(AddressId.pgType, unsaved.shiptoaddressid()),
            Fragment.lit("::int4, "),
            Fragment.encode(ShipmethodId.pgType, unsaved.shipmethodid()),
            Fragment.lit("::int4, "),
            Fragment.encode(CustomCreditcardId.pgType.opt(), unsaved.creditcardid()),
            Fragment.lit("::int4, "),
            Fragment.encode(PgTypes.text.opt(), unsaved.creditcardapprovalcode()),
            Fragment.lit(", "),
            Fragment.encode(CurrencyrateId.pgType.opt(), unsaved.currencyrateid()),
            Fragment.lit("::int4, "),
            Fragment.encode(PgTypes.numeric, unsaved.subtotal()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.taxamt()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric, unsaved.freight()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.numeric.opt(), unsaved.totaldue()),
            Fragment.lit("::numeric, "),
            Fragment.encode(PgTypes.text.opt(), unsaved.comment()),
            Fragment.lit(", "),
            Fragment.encode(PgTypes.uuid, unsaved.rowguid()),
            Fragment.lit("::uuid, "),
            Fragment.encode(PgTypes.timestamp, unsaved.modifieddate()),
            Fragment.lit(
                "::timestamp)\n"
                    + "on conflict (\"salesorderid\")\n"
                    + "do update set\n"
                    + "  \"revisionnumber\" = EXCLUDED.\"revisionnumber\",\n"
                    + "\"orderdate\" = EXCLUDED.\"orderdate\",\n"
                    + "\"duedate\" = EXCLUDED.\"duedate\",\n"
                    + "\"shipdate\" = EXCLUDED.\"shipdate\",\n"
                    + "\"status\" = EXCLUDED.\"status\",\n"
                    + "\"onlineorderflag\" = EXCLUDED.\"onlineorderflag\",\n"
                    + "\"purchaseordernumber\" = EXCLUDED.\"purchaseordernumber\",\n"
                    + "\"accountnumber\" = EXCLUDED.\"accountnumber\",\n"
                    + "\"customerid\" = EXCLUDED.\"customerid\",\n"
                    + "\"salespersonid\" = EXCLUDED.\"salespersonid\",\n"
                    + "\"territoryid\" = EXCLUDED.\"territoryid\",\n"
                    + "\"billtoaddressid\" = EXCLUDED.\"billtoaddressid\",\n"
                    + "\"shiptoaddressid\" = EXCLUDED.\"shiptoaddressid\",\n"
                    + "\"shipmethodid\" = EXCLUDED.\"shipmethodid\",\n"
                    + "\"creditcardid\" = EXCLUDED.\"creditcardid\",\n"
                    + "\"creditcardapprovalcode\" = EXCLUDED.\"creditcardapprovalcode\",\n"
                    + "\"currencyrateid\" = EXCLUDED.\"currencyrateid\",\n"
                    + "\"subtotal\" = EXCLUDED.\"subtotal\",\n"
                    + "\"taxamt\" = EXCLUDED.\"taxamt\",\n"
                    + "\"freight\" = EXCLUDED.\"freight\",\n"
                    + "\"totaldue\" = EXCLUDED.\"totaldue\",\n"
                    + "\"comment\" = EXCLUDED.\"comment\",\n"
                    + "\"rowguid\" = EXCLUDED.\"rowguid\",\n"
                    + "\"modifieddate\" = EXCLUDED.\"modifieddate\"\n"
                    + "returning \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\","
                    + " \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\","
                    + " \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\","
                    + " \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
                    + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\","
                    + " \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\","
                    + " \"rowguid\", \"modifieddate\""))
        .updateReturning(SalesorderheaderRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }
  ;

  @Override
  public List<SalesorderheaderRow> upsertBatch(
      Iterator<SalesorderheaderRow> unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\","
                    + " \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\","
                    + " \"purchaseordernumber\", \"accountnumber\", \"customerid\","
                    + " \"salespersonid\", \"territoryid\", \"billtoaddressid\","
                    + " \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\","
                    + " \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\","
                    + " \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")\n"
                    + "values (?::int4, ?::int2, ?::timestamp, ?::timestamp, ?::timestamp, ?::int2,"
                    + " ?::bool, ?::varchar, ?::varchar, ?::int4, ?::int4, ?::int4, ?::int4,"
                    + " ?::int4, ?::int4, ?::int4, ?, ?::int4, ?::numeric, ?::numeric, ?::numeric,"
                    + " ?::numeric, ?, ?::uuid, ?::timestamp)\n"
                    + "on conflict (\"salesorderid\")\n"
                    + "do update set\n"
                    + "  \"revisionnumber\" = EXCLUDED.\"revisionnumber\",\n"
                    + "\"orderdate\" = EXCLUDED.\"orderdate\",\n"
                    + "\"duedate\" = EXCLUDED.\"duedate\",\n"
                    + "\"shipdate\" = EXCLUDED.\"shipdate\",\n"
                    + "\"status\" = EXCLUDED.\"status\",\n"
                    + "\"onlineorderflag\" = EXCLUDED.\"onlineorderflag\",\n"
                    + "\"purchaseordernumber\" = EXCLUDED.\"purchaseordernumber\",\n"
                    + "\"accountnumber\" = EXCLUDED.\"accountnumber\",\n"
                    + "\"customerid\" = EXCLUDED.\"customerid\",\n"
                    + "\"salespersonid\" = EXCLUDED.\"salespersonid\",\n"
                    + "\"territoryid\" = EXCLUDED.\"territoryid\",\n"
                    + "\"billtoaddressid\" = EXCLUDED.\"billtoaddressid\",\n"
                    + "\"shiptoaddressid\" = EXCLUDED.\"shiptoaddressid\",\n"
                    + "\"shipmethodid\" = EXCLUDED.\"shipmethodid\",\n"
                    + "\"creditcardid\" = EXCLUDED.\"creditcardid\",\n"
                    + "\"creditcardapprovalcode\" = EXCLUDED.\"creditcardapprovalcode\",\n"
                    + "\"currencyrateid\" = EXCLUDED.\"currencyrateid\",\n"
                    + "\"subtotal\" = EXCLUDED.\"subtotal\",\n"
                    + "\"taxamt\" = EXCLUDED.\"taxamt\",\n"
                    + "\"freight\" = EXCLUDED.\"freight\",\n"
                    + "\"totaldue\" = EXCLUDED.\"totaldue\",\n"
                    + "\"comment\" = EXCLUDED.\"comment\",\n"
                    + "\"rowguid\" = EXCLUDED.\"rowguid\",\n"
                    + "\"modifieddate\" = EXCLUDED.\"modifieddate\"\n"
                    + "returning \"salesorderid\", \"revisionnumber\", \"orderdate\", \"duedate\","
                    + " \"shipdate\", \"status\", \"onlineorderflag\", \"purchaseordernumber\","
                    + " \"accountnumber\", \"customerid\", \"salespersonid\", \"territoryid\","
                    + " \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
                    + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\","
                    + " \"subtotal\", \"taxamt\", \"freight\", \"totaldue\", \"comment\","
                    + " \"rowguid\", \"modifieddate\""))
        .updateManyReturning(SalesorderheaderRow._rowParser, unsaved)
        .runUnchecked(c);
  }
  ;

  /** NOTE: this functionality is not safe if you use auto-commit mode! it runs 3 SQL statements */
  @Override
  public Integer upsertStreaming(
      Iterator<SalesorderheaderRow> unsaved, Integer batchSize, Connection c) {
    interpolate(
            Fragment.lit(
                "create temporary table salesorderheader_TEMP (like \"sales\".\"salesorderheader\")"
                    + " on commit drop"))
        .update()
        .runUnchecked(c);
    streamingInsert.insertUnchecked(
        "copy salesorderheader_TEMP(\"salesorderid\", \"revisionnumber\", \"orderdate\","
            + " \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\","
            + " \"purchaseordernumber\", \"accountnumber\", \"customerid\", \"salespersonid\","
            + " \"territoryid\", \"billtoaddressid\", \"shiptoaddressid\", \"shipmethodid\","
            + " \"creditcardid\", \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\","
            + " \"taxamt\", \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")"
            + " from stdin",
        batchSize,
        unsaved,
        c,
        SalesorderheaderRow.pgText);
    return interpolate(
            Fragment.lit(
                "insert into \"sales\".\"salesorderheader\"(\"salesorderid\", \"revisionnumber\","
                    + " \"orderdate\", \"duedate\", \"shipdate\", \"status\", \"onlineorderflag\","
                    + " \"purchaseordernumber\", \"accountnumber\", \"customerid\","
                    + " \"salespersonid\", \"territoryid\", \"billtoaddressid\","
                    + " \"shiptoaddressid\", \"shipmethodid\", \"creditcardid\","
                    + " \"creditcardapprovalcode\", \"currencyrateid\", \"subtotal\", \"taxamt\","
                    + " \"freight\", \"totaldue\", \"comment\", \"rowguid\", \"modifieddate\")\n"
                    + "select * from salesorderheader_TEMP\n"
                    + "on conflict (\"salesorderid\")\n"
                    + "do update set\n"
                    + "  \"revisionnumber\" = EXCLUDED.\"revisionnumber\",\n"
                    + "\"orderdate\" = EXCLUDED.\"orderdate\",\n"
                    + "\"duedate\" = EXCLUDED.\"duedate\",\n"
                    + "\"shipdate\" = EXCLUDED.\"shipdate\",\n"
                    + "\"status\" = EXCLUDED.\"status\",\n"
                    + "\"onlineorderflag\" = EXCLUDED.\"onlineorderflag\",\n"
                    + "\"purchaseordernumber\" = EXCLUDED.\"purchaseordernumber\",\n"
                    + "\"accountnumber\" = EXCLUDED.\"accountnumber\",\n"
                    + "\"customerid\" = EXCLUDED.\"customerid\",\n"
                    + "\"salespersonid\" = EXCLUDED.\"salespersonid\",\n"
                    + "\"territoryid\" = EXCLUDED.\"territoryid\",\n"
                    + "\"billtoaddressid\" = EXCLUDED.\"billtoaddressid\",\n"
                    + "\"shiptoaddressid\" = EXCLUDED.\"shiptoaddressid\",\n"
                    + "\"shipmethodid\" = EXCLUDED.\"shipmethodid\",\n"
                    + "\"creditcardid\" = EXCLUDED.\"creditcardid\",\n"
                    + "\"creditcardapprovalcode\" = EXCLUDED.\"creditcardapprovalcode\",\n"
                    + "\"currencyrateid\" = EXCLUDED.\"currencyrateid\",\n"
                    + "\"subtotal\" = EXCLUDED.\"subtotal\",\n"
                    + "\"taxamt\" = EXCLUDED.\"taxamt\",\n"
                    + "\"freight\" = EXCLUDED.\"freight\",\n"
                    + "\"totaldue\" = EXCLUDED.\"totaldue\",\n"
                    + "\"comment\" = EXCLUDED.\"comment\",\n"
                    + "\"rowguid\" = EXCLUDED.\"rowguid\",\n"
                    + "\"modifieddate\" = EXCLUDED.\"modifieddate\"\n"
                    + ";\n"
                    + "drop table salesorderheader_TEMP;"))
        .update()
        .runUnchecked(c);
  }
  ;
}

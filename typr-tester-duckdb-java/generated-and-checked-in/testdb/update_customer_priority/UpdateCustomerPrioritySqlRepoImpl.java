/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.update_customer_priority;

import static typr.runtime.Fragment.interpolate;

import java.sql.Connection;
import testdb.Priority;
import testdb.customers.CustomersId;
import typr.runtime.Fragment;

public class UpdateCustomerPrioritySqlRepoImpl implements UpdateCustomerPrioritySqlRepo {
  @Override
  public Integer apply(
      /* user-picked */ Priority newPriority,
      /* user-picked */ CustomersId customerId,
      Connection c) {
    return interpolate(
            Fragment.lit(
                "-- Update customer priority based on spending and return updated rows\n"
                    + "-- Tests: UPDATE with RETURNING, enum parameters\n\n"
                    + "UPDATE customers\n"
                    + "SET priority = "),
            Fragment.encode(Priority.duckDbType, newPriority),
            Fragment.lit("\nWHERE customer_id = "),
            Fragment.encode(CustomersId.duckDbType, customerId),
            Fragment.lit(
                "\n"
                    + "RETURNING\n"
                    + "    customer_id,\n"
                    + "    name,\n"
                    + "    email,\n"
                    + "    created_at,\n"
                    + "    priority"))
        .update()
        .runUnchecked(c);
  }
  ;
}

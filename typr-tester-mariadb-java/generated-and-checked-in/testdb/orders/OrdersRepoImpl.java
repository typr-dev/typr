/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.orders;

import static typr.runtime.Fragment.interpolate;

import java.sql.Connection;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import testdb.customer_addresses.CustomerAddressesId;
import testdb.customers.CustomersId;
import testdb.promotions.PromotionsId;
import typr.dsl.DeleteBuilder;
import typr.dsl.Dialect;
import typr.dsl.SelectBuilder;
import typr.dsl.UpdateBuilder;
import typr.runtime.Fragment;
import typr.runtime.MariaTypes;

public class OrdersRepoImpl implements OrdersRepo {
  @Override
  public DeleteBuilder<OrdersFields, OrdersRow> delete() {
    return DeleteBuilder.of("`orders`", OrdersFields.structure(), Dialect.MARIADB);
  }
  ;

  @Override
  public Boolean deleteById(OrdersId orderId, Connection c) {
    return interpolate(
                Fragment.lit("delete from `orders` where `order_id` = "),
                Fragment.encode(OrdersId.pgType, orderId),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }
  ;

  @Override
  public Integer deleteByIds(OrdersId[] orderIds, Connection c) {
    ArrayList<Fragment> fragments = new ArrayList<>();
    for (var id : orderIds) {
      fragments.add(Fragment.encode(OrdersId.pgType, id));
    }
    ;
    return Fragment.interpolate(
            Fragment.lit("delete from `orders` where `order_id` in ("),
            Fragment.comma(fragments),
            Fragment.lit(")"))
        .update()
        .runUnchecked(c);
  }
  ;

  @Override
  public OrdersRow insert(OrdersRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "insert into `orders`(`order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`)\n"
                    + "values ("),
            Fragment.encode(MariaTypes.varchar, unsaved.orderNumber()),
            Fragment.lit(", "),
            Fragment.encode(CustomersId.pgType, unsaved.customerId()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text, unsaved.orderStatus()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text, unsaved.paymentStatus()),
            Fragment.lit(", "),
            Fragment.encode(CustomerAddressesId.pgType.opt(), unsaved.shippingAddressId()),
            Fragment.lit(", "),
            Fragment.encode(CustomerAddressesId.pgType.opt(), unsaved.billingAddressId()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.subtotal()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.shippingCost()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.taxAmount()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.discountAmount()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.totalAmount()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.char_, unsaved.currencyCode()),
            Fragment.lit(", "),
            Fragment.encode(PromotionsId.pgType.opt(), unsaved.promotionId()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text.opt(), unsaved.notes()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumtext.opt(), unsaved.internalNotes()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.inet6.opt(), unsaved.ipAddress()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.varchar.opt(), unsaved.userAgent()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime, unsaved.orderedAt()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime.opt(), unsaved.confirmedAt()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime.opt(), unsaved.shippedAt()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime.opt(), unsaved.deliveredAt()),
            Fragment.lit(
                ")\n"
                    + "RETURNING `order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`,"
                    + " `delivered_at`\n"))
        .updateReturning(OrdersRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }
  ;

  @Override
  public OrdersRow insert(OrdersRowUnsaved unsaved, Connection c) {
    ArrayList<Fragment> columns = new ArrayList<>();
    ;
    ArrayList<Fragment> values = new ArrayList<>();
    ;
    columns.add(Fragment.lit("`order_number`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.varchar, unsaved.orderNumber()), Fragment.lit("")));
    columns.add(Fragment.lit("`customer_id`"));
    values.add(
        interpolate(Fragment.encode(CustomersId.pgType, unsaved.customerId()), Fragment.lit("")));
    columns.add(Fragment.lit("`subtotal`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.numeric, unsaved.subtotal()), Fragment.lit("")));
    columns.add(Fragment.lit("`total_amount`"));
    values.add(
        interpolate(Fragment.encode(MariaTypes.numeric, unsaved.totalAmount()), Fragment.lit("")));
    unsaved
        .orderStatus()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`order_status`"));
              values.add(interpolate(Fragment.encode(MariaTypes.text, value), Fragment.lit("")));
            });
    ;
    unsaved
        .paymentStatus()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`payment_status`"));
              values.add(interpolate(Fragment.encode(MariaTypes.text, value), Fragment.lit("")));
            });
    ;
    unsaved
        .shippingAddressId()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`shipping_address_id`"));
              values.add(
                  interpolate(
                      Fragment.encode(CustomerAddressesId.pgType.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .billingAddressId()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`billing_address_id`"));
              values.add(
                  interpolate(
                      Fragment.encode(CustomerAddressesId.pgType.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .shippingCost()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`shipping_cost`"));
              values.add(interpolate(Fragment.encode(MariaTypes.numeric, value), Fragment.lit("")));
            });
    ;
    unsaved
        .taxAmount()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`tax_amount`"));
              values.add(interpolate(Fragment.encode(MariaTypes.numeric, value), Fragment.lit("")));
            });
    ;
    unsaved
        .discountAmount()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`discount_amount`"));
              values.add(interpolate(Fragment.encode(MariaTypes.numeric, value), Fragment.lit("")));
            });
    ;
    unsaved
        .currencyCode()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`currency_code`"));
              values.add(interpolate(Fragment.encode(MariaTypes.char_, value), Fragment.lit("")));
            });
    ;
    unsaved
        .promotionId()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`promotion_id`"));
              values.add(
                  interpolate(Fragment.encode(PromotionsId.pgType.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .notes()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`notes`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.text.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .internalNotes()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`internal_notes`"));
              values.add(
                  interpolate(
                      Fragment.encode(MariaTypes.mediumtext.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .ipAddress()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`ip_address`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.inet6.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .userAgent()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`user_agent`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.varchar.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .orderedAt()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`ordered_at`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.datetime, value), Fragment.lit("")));
            });
    ;
    unsaved
        .confirmedAt()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`confirmed_at`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.datetime.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .shippedAt()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`shipped_at`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.datetime.opt(), value), Fragment.lit("")));
            });
    ;
    unsaved
        .deliveredAt()
        .visit(
            () -> {},
            value -> {
              columns.add(Fragment.lit("`delivered_at`"));
              values.add(
                  interpolate(Fragment.encode(MariaTypes.datetime.opt(), value), Fragment.lit("")));
            });
    ;
    Fragment q =
        interpolate(
            Fragment.lit("insert into `orders`("),
            Fragment.comma(columns),
            Fragment.lit(")\nvalues ("),
            Fragment.comma(values),
            Fragment.lit(
                ")\n"
                    + "RETURNING `order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`,"
                    + " `delivered_at`\n"));
    ;
    return q.updateReturning(OrdersRow._rowParser.exactlyOne()).runUnchecked(c);
  }
  ;

  @Override
  public SelectBuilder<OrdersFields, OrdersRow> select() {
    return SelectBuilder.of(
        "`orders`", OrdersFields.structure(), OrdersRow._rowParser, Dialect.MARIADB);
  }
  ;

  @Override
  public List<OrdersRow> selectAll(Connection c) {
    return interpolate(
            Fragment.lit(
                "select `order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`\n"
                    + "from `orders`\n"))
        .query(OrdersRow._rowParser.all())
        .runUnchecked(c);
  }
  ;

  @Override
  public Optional<OrdersRow> selectById(OrdersId orderId, Connection c) {
    return interpolate(
            Fragment.lit(
                "select `order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`\n"
                    + "from `orders`\n"
                    + "where `order_id` = "),
            Fragment.encode(OrdersId.pgType, orderId),
            Fragment.lit(""))
        .query(OrdersRow._rowParser.first())
        .runUnchecked(c);
  }
  ;

  @Override
  public List<OrdersRow> selectByIds(OrdersId[] orderIds, Connection c) {
    ArrayList<Fragment> fragments = new ArrayList<>();
    for (var id : orderIds) {
      fragments.add(Fragment.encode(OrdersId.pgType, id));
    }
    ;
    return Fragment.interpolate(
            Fragment.lit(
                "select `order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`"
                    + " from `orders` where `order_id` in ("),
            Fragment.comma(fragments),
            Fragment.lit(")"))
        .query(OrdersRow._rowParser.all())
        .runUnchecked(c);
  }
  ;

  @Override
  public Map<OrdersId, OrdersRow> selectByIdsTracked(OrdersId[] orderIds, Connection c) {
    HashMap<OrdersId, OrdersRow> ret = new HashMap<OrdersId, OrdersRow>();
    selectByIds(orderIds, c).forEach(row -> ret.put(row.orderId(), row));
    return ret;
  }
  ;

  @Override
  public Optional<OrdersRow> selectByUniqueOrderNumber(String orderNumber, Connection c) {
    return interpolate(
            Fragment.lit(
                "select `order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`\n"
                    + "from `orders`\n"
                    + "where `order_number` = "),
            Fragment.encode(MariaTypes.varchar, orderNumber),
            Fragment.lit("\n"))
        .query(OrdersRow._rowParser.first())
        .runUnchecked(c);
  }
  ;

  @Override
  public UpdateBuilder<OrdersFields, OrdersRow> update() {
    return UpdateBuilder.of(
        "`orders`", OrdersFields.structure(), OrdersRow._rowParser, Dialect.MARIADB);
  }
  ;

  @Override
  public Boolean update(OrdersRow row, Connection c) {
    OrdersId orderId = row.orderId();
    ;
    return interpolate(
                Fragment.lit("update `orders`\nset `order_number` = "),
                Fragment.encode(MariaTypes.varchar, row.orderNumber()),
                Fragment.lit(",\n`customer_id` = "),
                Fragment.encode(CustomersId.pgType, row.customerId()),
                Fragment.lit(",\n`order_status` = "),
                Fragment.encode(MariaTypes.text, row.orderStatus()),
                Fragment.lit(",\n`payment_status` = "),
                Fragment.encode(MariaTypes.text, row.paymentStatus()),
                Fragment.lit(",\n`shipping_address_id` = "),
                Fragment.encode(CustomerAddressesId.pgType.opt(), row.shippingAddressId()),
                Fragment.lit(",\n`billing_address_id` = "),
                Fragment.encode(CustomerAddressesId.pgType.opt(), row.billingAddressId()),
                Fragment.lit(",\n`subtotal` = "),
                Fragment.encode(MariaTypes.numeric, row.subtotal()),
                Fragment.lit(",\n`shipping_cost` = "),
                Fragment.encode(MariaTypes.numeric, row.shippingCost()),
                Fragment.lit(",\n`tax_amount` = "),
                Fragment.encode(MariaTypes.numeric, row.taxAmount()),
                Fragment.lit(",\n`discount_amount` = "),
                Fragment.encode(MariaTypes.numeric, row.discountAmount()),
                Fragment.lit(",\n`total_amount` = "),
                Fragment.encode(MariaTypes.numeric, row.totalAmount()),
                Fragment.lit(",\n`currency_code` = "),
                Fragment.encode(MariaTypes.char_, row.currencyCode()),
                Fragment.lit(",\n`promotion_id` = "),
                Fragment.encode(PromotionsId.pgType.opt(), row.promotionId()),
                Fragment.lit(",\n`notes` = "),
                Fragment.encode(MariaTypes.text.opt(), row.notes()),
                Fragment.lit(",\n`internal_notes` = "),
                Fragment.encode(MariaTypes.mediumtext.opt(), row.internalNotes()),
                Fragment.lit(",\n`ip_address` = "),
                Fragment.encode(MariaTypes.inet6.opt(), row.ipAddress()),
                Fragment.lit(",\n`user_agent` = "),
                Fragment.encode(MariaTypes.varchar.opt(), row.userAgent()),
                Fragment.lit(",\n`ordered_at` = "),
                Fragment.encode(MariaTypes.datetime, row.orderedAt()),
                Fragment.lit(",\n`confirmed_at` = "),
                Fragment.encode(MariaTypes.datetime.opt(), row.confirmedAt()),
                Fragment.lit(",\n`shipped_at` = "),
                Fragment.encode(MariaTypes.datetime.opt(), row.shippedAt()),
                Fragment.lit(",\n`delivered_at` = "),
                Fragment.encode(MariaTypes.datetime.opt(), row.deliveredAt()),
                Fragment.lit("\nwhere `order_id` = "),
                Fragment.encode(OrdersId.pgType, orderId),
                Fragment.lit(""))
            .update()
            .runUnchecked(c)
        > 0;
  }
  ;

  @Override
  public OrdersRow upsert(OrdersRow unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "INSERT INTO `orders`(`order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`)\n"
                    + "VALUES ("),
            Fragment.encode(MariaTypes.varchar, unsaved.orderNumber()),
            Fragment.lit(", "),
            Fragment.encode(CustomersId.pgType, unsaved.customerId()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text, unsaved.orderStatus()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text, unsaved.paymentStatus()),
            Fragment.lit(", "),
            Fragment.encode(CustomerAddressesId.pgType.opt(), unsaved.shippingAddressId()),
            Fragment.lit(", "),
            Fragment.encode(CustomerAddressesId.pgType.opt(), unsaved.billingAddressId()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.subtotal()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.shippingCost()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.taxAmount()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.discountAmount()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.numeric, unsaved.totalAmount()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.char_, unsaved.currencyCode()),
            Fragment.lit(", "),
            Fragment.encode(PromotionsId.pgType.opt(), unsaved.promotionId()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.text.opt(), unsaved.notes()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.mediumtext.opt(), unsaved.internalNotes()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.inet6.opt(), unsaved.ipAddress()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.varchar.opt(), unsaved.userAgent()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime, unsaved.orderedAt()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime.opt(), unsaved.confirmedAt()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime.opt(), unsaved.shippedAt()),
            Fragment.lit(", "),
            Fragment.encode(MariaTypes.datetime.opt(), unsaved.deliveredAt()),
            Fragment.lit(
                ")\n"
                    + "ON DUPLICATE KEY UPDATE `order_number` = VALUES(`order_number`),\n"
                    + "`customer_id` = VALUES(`customer_id`),\n"
                    + "`order_status` = VALUES(`order_status`),\n"
                    + "`payment_status` = VALUES(`payment_status`),\n"
                    + "`shipping_address_id` = VALUES(`shipping_address_id`),\n"
                    + "`billing_address_id` = VALUES(`billing_address_id`),\n"
                    + "`subtotal` = VALUES(`subtotal`),\n"
                    + "`shipping_cost` = VALUES(`shipping_cost`),\n"
                    + "`tax_amount` = VALUES(`tax_amount`),\n"
                    + "`discount_amount` = VALUES(`discount_amount`),\n"
                    + "`total_amount` = VALUES(`total_amount`),\n"
                    + "`currency_code` = VALUES(`currency_code`),\n"
                    + "`promotion_id` = VALUES(`promotion_id`),\n"
                    + "`notes` = VALUES(`notes`),\n"
                    + "`internal_notes` = VALUES(`internal_notes`),\n"
                    + "`ip_address` = VALUES(`ip_address`),\n"
                    + "`user_agent` = VALUES(`user_agent`),\n"
                    + "`ordered_at` = VALUES(`ordered_at`),\n"
                    + "`confirmed_at` = VALUES(`confirmed_at`),\n"
                    + "`shipped_at` = VALUES(`shipped_at`),\n"
                    + "`delivered_at` = VALUES(`delivered_at`)\n"
                    + "RETURNING `order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`"))
        .updateReturning(OrdersRow._rowParser.exactlyOne())
        .runUnchecked(c);
  }
  ;

  @Override
  public List<OrdersRow> upsertBatch(Iterator<OrdersRow> unsaved, Connection c) {
    return interpolate(
            Fragment.lit(
                "INSERT INTO `orders`(`order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`)\n"
                    + "VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n"
                    + "ON DUPLICATE KEY UPDATE `order_number` = VALUES(`order_number`),\n"
                    + "`customer_id` = VALUES(`customer_id`),\n"
                    + "`order_status` = VALUES(`order_status`),\n"
                    + "`payment_status` = VALUES(`payment_status`),\n"
                    + "`shipping_address_id` = VALUES(`shipping_address_id`),\n"
                    + "`billing_address_id` = VALUES(`billing_address_id`),\n"
                    + "`subtotal` = VALUES(`subtotal`),\n"
                    + "`shipping_cost` = VALUES(`shipping_cost`),\n"
                    + "`tax_amount` = VALUES(`tax_amount`),\n"
                    + "`discount_amount` = VALUES(`discount_amount`),\n"
                    + "`total_amount` = VALUES(`total_amount`),\n"
                    + "`currency_code` = VALUES(`currency_code`),\n"
                    + "`promotion_id` = VALUES(`promotion_id`),\n"
                    + "`notes` = VALUES(`notes`),\n"
                    + "`internal_notes` = VALUES(`internal_notes`),\n"
                    + "`ip_address` = VALUES(`ip_address`),\n"
                    + "`user_agent` = VALUES(`user_agent`),\n"
                    + "`ordered_at` = VALUES(`ordered_at`),\n"
                    + "`confirmed_at` = VALUES(`confirmed_at`),\n"
                    + "`shipped_at` = VALUES(`shipped_at`),\n"
                    + "`delivered_at` = VALUES(`delivered_at`)\n"
                    + "RETURNING `order_id`, `order_number`, `customer_id`, `order_status`,"
                    + " `payment_status`, `shipping_address_id`, `billing_address_id`, `subtotal`,"
                    + " `shipping_cost`, `tax_amount`, `discount_amount`, `total_amount`,"
                    + " `currency_code`, `promotion_id`, `notes`, `internal_notes`, `ip_address`,"
                    + " `user_agent`, `ordered_at`, `confirmed_at`, `shipped_at`, `delivered_at`"))
        .updateReturningEach(OrdersRow._rowParser, unsaved)
        .runUnchecked(c);
  }
  ;
}

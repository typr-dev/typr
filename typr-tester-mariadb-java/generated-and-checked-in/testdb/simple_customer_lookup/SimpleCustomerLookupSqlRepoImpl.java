/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.simple_customer_lookup;

import static typr.runtime.Fragment.interpolate;

import java.sql.Connection;
import java.util.List;
import typr.runtime.Fragment;
import typr.runtime.MariaTypes;

public class SimpleCustomerLookupSqlRepoImpl implements SimpleCustomerLookupSqlRepo {
  @Override
  public List<SimpleCustomerLookupSqlRow> apply(String email, Connection c) {
    return interpolate(
            Fragment.lit(
                "-- Simple customer lookup by email\n"
                    + "SELECT customer_id,\n"
                    + "       email,\n"
                    + "       first_name,\n"
                    + "       last_name,\n"
                    + "       tier,\n"
                    + "       status,\n"
                    + "       created_at\n"
                    + "FROM customers\n"
                    + "WHERE email = "),
            Fragment.encode(MariaTypes.varchar, email),
            Fragment.lit("\n"))
        .query(SimpleCustomerLookupSqlRow._rowParser.all())
        .runUnchecked(c);
  }
  ;
}

/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.employee_salary_update

import java.math.BigDecimal
import java.sql.Connection
import typr.kotlindsl.Fragment
import typr.kotlindsl.KotlinDbTypes
import typr.kotlindsl.nullable
import typr.runtime.DuckDbTypes

class EmployeeSalaryUpdateSqlRepoImpl() : EmployeeSalaryUpdateSqlRepo {
  override fun apply(
    raisePercentage: BigDecimal?,
    newSalary: BigDecimal,
    empNumber: Int,
    empSuffix: String,
    c: Connection
  ): Int = Fragment.interpolate(Fragment.lit("-- Update employee salary using composite primary key\n-- Tests: UPDATE with composite primary key, RETURNING, decimal arithmetic\n\nUPDATE employees\nSET salary = CASE\n    WHEN "), Fragment.encode(DuckDbTypes.numeric.nullable(), raisePercentage), Fragment.lit(" IS NOT NULL THEN salary * (1 + CAST("), Fragment.encode(DuckDbTypes.numeric.nullable(), raisePercentage), Fragment.lit(" AS DECIMAL) / 100.0)\n    ELSE CAST("), Fragment.encode(DuckDbTypes.numeric, newSalary), Fragment.lit(" AS DECIMAL)\nEND\nWHERE emp_number = CAST("), Fragment.encode(KotlinDbTypes.DuckDbTypes.integer, empNumber), Fragment.lit(" AS INTEGER)\n  AND emp_suffix = CAST("), Fragment.encode(DuckDbTypes.text, empSuffix), Fragment.lit(" AS VARCHAR)\nRETURNING\n    emp_number,\n    emp_suffix,\n    dept_code,\n    dept_region,\n    emp_name,\n    salary,\n    hire_date")).update().runUnchecked(c)
}
/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.department_employee_details

import java.math.BigDecimal
import java.sql.Connection
import java.time.LocalDate
import kotlin.collections.List
import typr.kotlindsl.Fragment
import typr.kotlindsl.nullable
import typr.runtime.DuckDbTypes

class DepartmentEmployeeDetailsSqlRepoImpl() : DepartmentEmployeeDetailsSqlRepo {
  override fun apply(
    deptCode: String?,
    deptRegion: String?,
    minSalary: BigDecimal?,
    hiredAfter: LocalDate?,
    c: Connection
  ): List<DepartmentEmployeeDetailsSqlRow> = Fragment.interpolate(Fragment.lit("-- Department and employee details with composite key handling\n-- Tests: composite primary keys, composite foreign keys, multiple table joins\n\nSELECT\n    d.dept_code,\n    d.dept_region,\n    d.dept_name,\n    d.budget,\n    e.emp_number,\n    e.emp_suffix,\n    e.emp_name,\n    e.salary,\n    e.hire_date,\n    -- Calculate years of service\n    DATE_DIFF('year', e.hire_date, CURRENT_DATE) AS years_of_service\nFROM departments d\nLEFT JOIN employees e ON d.dept_code = e.dept_code AND d.dept_region = e.dept_region\nWHERE\n    ("), Fragment.encode(DuckDbTypes.varchar.nullable(), deptCode), Fragment.lit(" IS NULL OR d.dept_code = "), Fragment.encode(DuckDbTypes.varchar.nullable(), deptCode), Fragment.lit(")\n    AND ("), Fragment.encode(DuckDbTypes.varchar.nullable(), deptRegion), Fragment.lit(" IS NULL OR d.dept_region = "), Fragment.encode(DuckDbTypes.varchar.nullable(), deptRegion), Fragment.lit(")\n    AND ("), Fragment.encode(DuckDbTypes.numeric.nullable(), minSalary), Fragment.lit(" IS NULL OR e.salary >= "), Fragment.encode(DuckDbTypes.numeric.nullable(), minSalary), Fragment.lit(")\n    AND ("), Fragment.encode(DuckDbTypes.date.nullable(), hiredAfter), Fragment.lit(" IS NULL OR e.hire_date >= "), Fragment.encode(DuckDbTypes.date.nullable(), hiredAfter), Fragment.lit(")\nORDER BY d.dept_code, d.dept_region, e.emp_number")).query(DepartmentEmployeeDetailsSqlRow._rowParser.all()).runUnchecked(c)
}
/**
 * File automatically generated by `typo` for its own test suite.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN
 */
package testdb.hardcoded.compositepk.person

import java.util.Optional
import testdb.hardcoded.customtypes.Defaulted
import typo.runtime.PgText
import typo.runtime.PgTypes
import typo.runtime.RowParser
import typo.runtime.RowParsers

/** Table: compositepk.person
 * Composite primary key: one, two
 */
case class PersonRow(
  /** Default: auto-increment */
  one: java.lang.Long,
  /** Default: auto-increment */
  two: Optional[String],
  name: Optional[String]
) {
  def compositeId: PersonId = new PersonId(one, two)

  def id: PersonId = this.compositeId

  def toUnsavedRow(
    one: Defaulted[java.lang.Long],
    two: Defaulted[Optional[String]]
  ): PersonRowUnsaved = new PersonRowUnsaved(name, one, two)
}

object PersonRow {
  val `_rowParser`: RowParser[PersonRow] = RowParsers.of(PgTypes.int8, PgTypes.text.opt(), PgTypes.text.opt(), PersonRow.apply, row => Array[Object](row.one.asInstanceOf[Object], row.two.asInstanceOf[Object], row.name.asInstanceOf[Object]))

  def apply(
    compositeId: PersonId,
    name: Optional[String]
  ): PersonRow = new PersonRow(compositeId.one, compositeId.two, name)

  given pgText: PgText[PersonRow] = PgText.from(`_rowParser`)
}
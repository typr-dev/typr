/**
 * File automatically generated by `typo` for its own test suite.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN
 */
package testdb.hardcoded.compositepk.person;

import java.util.Optional;
import testdb.hardcoded.customtypes.Defaulted;
import typr.runtime.PgText;
import typr.runtime.PgTypes;
import typr.runtime.RowParser;
import typr.runtime.RowParsers;

/** Table: compositepk.person
  * Composite primary key: one, two
  */
public record PersonRow(
  /** Default: auto-increment */
  Long one,
  /** Default: auto-increment */
  Optional<String> two,
  Optional<String> name
) {
  /** Default: auto-increment */
  public PersonRow withOne(Long one) {
    return new PersonRow(one, two, name);
  };

  /** Default: auto-increment */
  public PersonRow withTwo(Optional<String> two) {
    return new PersonRow(one, two, name);
  };

  public PersonRow withName(Optional<String> name) {
    return new PersonRow(one, two, name);
  };

  public static RowParser<PersonRow> _rowParser = RowParsers.of(PgTypes.int8, PgTypes.text.opt(), PgTypes.text.opt(), PersonRow::new, row -> new Object[]{row.one(), row.two(), row.name()});;

  static public PersonRow apply(
    PersonId compositeId,
    Optional<String> name
  ) {
    return new PersonRow(compositeId.one(), compositeId.two(), name);
  };

  static public PgText<PersonRow> pgText =
    PgText.from(_rowParser);

  public PersonId compositeId() {
    return new PersonId(one, two);
  };

  public PersonId id() {
    return this.compositeId();
  };

  public PersonRowUnsaved toUnsavedRow(
    Defaulted<Long> one,
    Defaulted<Optional<String>> two
  ) {
    return new PersonRowUnsaved(name, one, two);
  };
}